(function(t){function e(e){for(var s,r,o=e[0],l=e[1],c=e[2],u=0,h=[];u<o.length;u++)r=o[u],a[r]&&h.push(a[r][0]),a[r]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);d&&d(e);while(h.length)h.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],s=!0,o=1;o<i.length;o++){var l=i[o];0!==a[l]&&(s=!1)}s&&(n.splice(e--,1),t=r(r.s=i[0]))}return t}var s={},a={app:0},n=[];function r(e){if(s[e])return s[e].exports;var i=s[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=s,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(i,s,function(e){return t[e]}.bind(null,s));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var d=l;n.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0101":function(t,e,i){"use strict";var s=i("3fce"),a=i.n(s);a.a},"010d":function(t,e,i){"use strict";var s=i("33c5"),a=i.n(s);a.a},"0111":function(t,e,i){},"0374":function(t,e,i){},"06f4":function(t,e,i){"use strict";var s=i("a2bf"),a=i.n(s);a.a},"0a40":function(t,e,i){"use strict";var s=i("1222"),a=i.n(s);a.a},"0a60":function(t,e,i){"use strict";var s=i("2cdb"),a=i.n(s);a.a},"10f4":function(t,e,i){},1222:function(t,e,i){},"14e1":function(t,e,i){"use strict";var s=i("2407"),a=i.n(s);a.a},"1d7a":function(t,e,i){},2407:function(t,e,i){},2684:function(t,e,i){"use strict";var s=i("41f2"),a=i.n(s);a.a},"283d":function(t,e,i){"use strict";var s=i("0111"),a=i.n(s);a.a},"29be":function(t,e,i){},"2cdb":function(t,e,i){},"2dc1":function(t,e,i){},"328b":function(t,e,i){"use strict";var s=i("10f4"),a=i.n(s);a.a},"33c5":function(t,e,i){},"3a4e":function(t,e,i){},"3e9b":function(t,e,i){"use strict";var s=i("6d57"),a=i.n(s);a.a},"3fce":function(t,e,i){},"41f2":function(t,e,i){},4615:function(t,e,i){"use strict";var s=i("7041"),a=i.n(s);a.a},4678:function(t,e,i){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function a(t){var e=n(t);return i(e)}function n(t){var e=s[t];if(!(e+1)){var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}return e}a.keys=function(){return Object.keys(s)},a.resolve=n,t.exports=a,a.id="4678"},"4f73":function(t,e,i){"use strict";var s=i("0374"),a=i.n(s);a.a},5019:function(t,e,i){},5327:function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);var s=i("75fc"),a=(i("cadf"),i("551c"),i("f751"),i("097d"),i("2b0e")),n=i("8c4f"),r=i("bc3a"),o=i.n(r),l=i("a7fe"),c=i.n(l),d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"insites-core"}},[i("router-view")],1)},u=[],h=(i("96cf"),i("3b8d")),m=(i("a481"),i("28a5"),{data:function(){return{insRendererEl:void 0}},methods:{toastInvalidIDNotification:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";toastIt("error","Invalid ".concat(t,", no data found."),InsitesUtil.ops())},apiHeader:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.getElementsByName("csrf-token")[0].content,e={"X-CSRF-Token":"","X-Requested-With":"XMLHttpRequest",Accept:"application/json","Content-Type":"application/json"};return"localhost"!==window.location.hostname&&(e["X-CSRF-Token"]=t),e},checkURLParamsID:function(){return this.$route.params.id},setURLParameter:function(t,e){this.$router.push({path:"".concat(t,"/").concat(e)})},capitalize:function(t){return this.checkValue(t).split("_").map(function(t){return t.charAt(0).toUpperCase()+t.substring(1)}).join(" ")},convertToPhysicalPath:function(t){return t=t.split("/"),t.shift(),t=t.join("/"),t},removeArrLastIndex:function(t){return t=t.split("/"),t.pop(),t=t.join("/"),t},validateInput:function(t){return t=t.target?t.target:t,t.value?(InsitesUtil.validFieldNotif(t),0):(InsitesUtil.invalidFieldNotif(t),1)},convertToFolder:function(t){return t.replace(/\//g,"|")},returnFormattedDate:function(t){return InsitesUtil.formatLocalisation(t)},localhostAssetManagerGetFileData:function(t,e){for(var i=[],s=0;s<e.results.data.items.results.length;s++){var a=e.results.data.items.results[s];if(a.physical_path===t){i=e.results.data.items.results[s];break}}return i},constructPhoneNumber:function(t,e){var i="";return e&&(this.checkValue(e[t+"_phone_area_code"])||this.checkValue(e[t+"_phone_number"]))&&(i="".concat(this.checkValue(e[t+"_phone_country_code"],!0)),i+=" ".concat(this.checkValue(e[t+"_phone_area_code"])),i+=" ".concat(this.checkValue(e[t+"_phone_number"]))),i.trim()},checkValue:function(t,e){return t&&"undefined"!==t?"".concat(e?"+":"").concat(t):""}}}),p=i("bc3a"),f="/insites/api",_=m.methods.apiHeader();function g(){return b.apply(this,arguments)}function b(){return b=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e="insites_assets.json",t.next=3,x(e,"get").then(function(t){return{state:!0,results:t.data}}).catch(function(t){return console.log("Error: Failed to get Insites assets."),{state:!1,results:t}});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)})),b.apply(this,arguments)}function v(){return y.apply(this,arguments)}function y(){return y=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e="get-current-user-data.json",t.next=3,x(e,"get").then(function(t){return{state:!0,results:t.data}}).catch(function(t){return console.warn("No user data found. Session is invalid or expired."),{state:!1,results:t}});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)})),y.apply(this,arguments)}function C(){return D.apply(this,arguments)}function D(){return D=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e="site-settings-data.json",t.next=3,x(e,"get").then(function(t){return{state:!0,results:t.data.items.results}}).catch(function(t){return console.warn("Note: You are not subscribed to Insites Settings & Branding Module."),{state:!1,results:t}});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)})),D.apply(this,arguments)}function k(t){return T.apply(this,arguments)}function T(){return T=Object(h["a"])(regeneratorRuntime.mark(function t(e){var i,s,a,n=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=n.length>1&&void 0!==n[1]?n[1]:1,s=n.length>2&&void 0!==n[2]?n[2]:10,a="get-system-fields-data.json?key=".concat(e,"&page=").concat(i,"&size=").concat(s),t.next=5,w(a,"get");case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)})),T.apply(this,arguments)}function w(t,e){return E.apply(this,arguments)}function E(){return E=Object(h["a"])(regeneratorRuntime.mark(function t(e,i){var s,a,n=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return s=n.length>2&&void 0!==n[2]?n[2]:{},a=n.length>3&&void 0!==n[3]?n[3]:_,t.next=4,x(e,i,s,a).then(function(t){return{state:!0,results:t.data}}).catch(function(t){return{state:!1,results:t}});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)})),E.apply(this,arguments)}function x(t,e){return A.apply(this,arguments)}function A(){return A=Object(h["a"])(regeneratorRuntime.mark(function t(e,i){var s,a,n,r=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return s=r.length>2&&void 0!==r[2]?r[2]:{},a=r.length>3&&void 0!==r[3]?r[3]:_,n="".concat(f,"/").concat(e),t.next=5,p({method:i,url:n,data:s,headers:a});case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)})),A.apply(this,arguments)}function R(t,e){return S.apply(this,arguments)}function S(){return S=Object(h["a"])(regeneratorRuntime.mark(function t(e,i){var s,a,n,r=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return s=r.length>2&&void 0!==r[2]?r[2]:{},a=r.length>3&&void 0!==r[3]?r[3]:_,n="".concat(e),t.next=5,p({method:i,url:n,data:s,headers:a});case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)})),S.apply(this,arguments)}i("913c"),i("e14f"),i("d650"),i("9f94");var I={name:"app",methods:{getAdmins:function(){var t=this;this.$http.get("/insites/api/get-all-administrator-data.json?size=10000&page=1&sortBy=&orderBy=asc").then(function(e){t.$store.commit("setAdministratorList",e.data.items)}).catch(this.errorHandler)},errorHandler:function(t){console.error("error",t),toastIt("error","Failed to load system fields.",this.ops)},setSettingsAndBranding:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,C();case 2:e=t.sent,this.$store.dispatch("checkSettingsAndBrandingFields",e);case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),setSystemFields:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){var i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,k(e);case 2:i=t.sent,s={type:e,value:i},this.$store.dispatch("checkSystemFields",s);case 5:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()},mounted:function(){this.setSystemFields("company_type"),this.setSystemFields("contact_type"),this.setSystemFields("industry_type"),this.setSystemFields("google_maps_api_key"),this.setSettingsAndBranding(),this.getAdmins()}},N=I,P=(i("14e1"),i("dea6"),i("2877")),O=Object(P["a"])(N,d,u,!1,null,null,null),L=O.exports,F=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"grid-container-full"},[i("div",{staticClass:"grid-x"},[i("div",{staticClass:"large-12 medium-12 small-12 cell overview-wrap"},[i("ins-card",{attrs:{steady:""}},[i("div",{staticClass:"text-center height-full vertical-align-middle"},[i("div",{staticClass:"small-12 cell",attrs:{id:"overview-welcome"}},[""!=t.ins_logo?i("img",{attrs:{src:t.ins_logo,alt:"Insites"}}):t._e(),i("h5",{staticClass:"margin-bottom-30"},[t._v("Welcome "),i("i",[t._v(t._s(t.current_user.email))])]),i("p",[t._v("Create your own custom dashboard here using our wide range of UI elements.")]),i("p",[t._v("For more information, please visit "),i("a",{attrs:{href:"https://docs.insites.io",target:"_blank"}},[t._v("https://docs.insites.io")])])])])])],1)])])},j=[],B={name:"Overview",data:function(){return{current_user:{id:"",first_name:"Client",last_name:"Name",email:"user@email.com",administrator:{}},ins_logo:""}},methods:{setCurrentUserData:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,v();case 2:e=t.sent,this.current_user=e.state?e.results.current_user:this.current_user;case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),setWelcomeLogo:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,g();case 2:e=t.sent,this.ins_logo=e.state?e.results.ins_icon:"";case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){this.setWelcomeLogo(),this.setCurrentUserData()}},M=B,H=(i("dd4b"),Object(P["a"])(M,F,j,!1,null,null,null)),U=H.exports,V=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("ins-button",{attrs:{field:"addNewAdmin",id:"addNewAdmin",label:"Add New Admin User",color:"blue",solid:"true",size:"medium",disabled:"false"},on:{onClickInsButton:function(e){return t.addNewAdmin()}}}),i("ins-base-table",{attrs:{id:"insBaseTable","searchbar-placeholder":"Search by Name or Email..."},on:{onPaginationChange:t.tablePaginationHandler,onTableSearch:t.tableSearchHandler,onTableSort:t.tableSortHandler,onTableBulkAction:t.tableBulkActionHandler,onTableRowAction:t.tableRowActionHandler}}),i("div",{staticClass:"spacer large"})],1)},W=[],K=i("f499"),z=i.n(K),q=(i("ac6a"),i("c1df")),Y=i.n(q),G="/api/users";function J(){return X.apply(this,arguments)}function X(){return X=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,i,s,a,n,r=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:1,i=r.length>1&&void 0!==r[1]?r[1]:10,s=r.length>2?r[2]:void 0,a=r.length>3?r[3]:void 0,n="get-all-administrator-data.json?size=".concat(i,"&page=").concat(e,"&sortBy=").concat(s,"&orderBy=").concat(a),t.next=7,w(n,"get");case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t,this)})),X.apply(this,arguments)}function Q(t){return Z.apply(this,arguments)}function Z(){return Z=Object(h["a"])(regeneratorRuntime.mark(function t(e){var i,s,a,n=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=n.length>1&&void 0!==n[1]?n[1]:1,s=n.length>2&&void 0!==n[2]?n[2]:10,a="get-all-administrator-data.json?id=".concat(e,"&size=").concat(s,"&page=").concat(i),t.next=5,w(a,"get");case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)})),Z.apply(this,arguments)}function tt(){return et.apply(this,arguments)}function et(){return et=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,i,s,a,n,r,o=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=o.length>0&&void 0!==o[0]?o[0]:1,i=o.length>1&&void 0!==o[1]?o[1]:10,s=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,n=o.length>4?o[4]:void 0,r="search-administrators-data.json?size=".concat(i,"&page=").concat(e,"&sortBy=").concat(s,"&orderBy=").concat(a,"&keyword=").concat(n),t.next=8,w(r,"get");case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}},t,this)})),et.apply(this,arguments)}function it(t,e){var i="".concat(G,"/").concat(t);return R(i,"put",e)}function st(t,e){var i="".concat(G,"/").concat(t);return R(i,"put",e)}function at(t){var e="".concat(G);return R(e,"post",t)}function nt(t){return rt.apply(this,arguments)}function rt(){return rt=Object(h["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i="get-customer-profile-data.json?email=".concat(e),t.next=3,w(i,"get");case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)})),rt.apply(this,arguments)}function ot(t){return lt.apply(this,arguments)}function lt(){return lt=Object(h["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i="get-crm-data.json?id=".concat(e),t.next=3,w(i,"get");case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)})),lt.apply(this,arguments)}function ct(t){return dt.apply(this,arguments)}function dt(){return dt=Object(h["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i="get-company-details-data.json?id=".concat(e),t.next=3,w(i,"get");case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)})),dt.apply(this,arguments)}var ut={name:"ListUsers",mixins:[m],data:function(){return{insBaseTable:"",rawData:[],filteredData:[],displayedData:[],tableHeaders:[],totalCount:0,pageNumber:1,pageSize:10,searchKeyword:"",sortedKeyword:"",sortedBy:"asc",formModel:{form_configuration_name:"modules/insites_core/insites_delete_admin_user",form:{profiles_attributes:{"modules/insites_core/insites_administrator_attributes":{properties_attributes:{is_enabled:"false"}}}}},headers:"",continueDeletion:!1}},methods:{addNewAdmin:function(){this.$store.commit("pushFormType","add"),InsitesUtil.renderPage("Add New Admin User","#/manage-admin-user")},tablePaginationHandler:function(t){this.insBaseTable.loadingScreen=!0,this.pageSize=t.detail.pageSize,this.pageNumber=t.detail.pageNumber,this.fetchDataFromSrc()},tableSearchHandler:function(t){(13===t.detail.keyCode&&""!==t.detail.value||""===t.detail.value&&""!==this.searchKeyword)&&(this.searchKeyword=t.detail.value,this.pageNumber=1,this.insBaseTable.pageNumber=1,this.fetchDataFromSrc())},tableSortHandler:function(t){this.sortedKeyword="Admin User"===t.detail.keyword||"Name"===t.detail.keyword?"first_name":t.detail.keyword,this.sortedBy=t.detail.order,this.fetchDataFromSrc()},tableBulkActionHandler:function(t){"Delete"===t.detail.action&&this.archiveSelection(t.detail.selections)},tableRowActionHandler:function(t){""!==t.detail.data["Name"].trim()&&t.detail.data["Name"]?t.detail.data["Name"]:t.detail.data["Email"];"Delete"===t.detail.action?this.archiveItem(t.detail.data):"Edit"===t.detail.action?(this.$store.commit("pushUserData",t.detail.data),this.$store.commit("pushFormType","edit"),this.setURLParameter("/edit-admin-user",t.detail.data.id)):"View"===t.detail.action&&(this.$store.commit("pushUserData",t.detail.data),this.$store.commit("pushFormType","view"),this.viewItem(t.detail.data.id))},viewItem:function(t){this.setURLParameter("/edit-admin-user",t)},archiveItem:function(t){var e=this;swal({title:"",html:'\n          <ins-loader\n            state-icon="warning"\n            icon-color="warning"\n            state-message="Are you sure you want to delete this user?">\n          </ins-loader>',type:"",width:330,showCancelButton:!0,confirmButtonText:"Delete",confirmButtonClass:"negative"}).then(function(i){i.value&&e.deleteItem(t)})},archiveSelection:function(t){var e=this;swal({title:"",html:'\n          <ins-loader\n            state-icon="warning"\n            icon-color="warning"\n            state-message="Are you sure you want to delete these users?">\n          </ins-loader>',type:"",width:330,showCancelButton:!0,confirmButtonClass:"negative",confirmButtonText:"Delete"}).then(function(i){if(i.value){var s=0;e.continueDeletion=!0,t.forEach(function(i){e.continueDeletion&&(e.deleteItem(i),s++,t.length===s&&(e.continueDeletion=!1,e.insBaseTable.resetSelections()))})}})},deleteItem:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){var i,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=z()(this.formModel),t.next=3,it(e.id,i).then(function(t){s.continueDeletion||(toastIt("success","User has been deleted.",InsitesUtil.ops()),s.fetchDataFromSrc())}).catch(function(t){s.continueDeletion=!1,s.fetchDataFromSrc(),toastIt("error","Failed to delete user. Please try again.",InsitesUtil.ops())});case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),processTableData:function(){var t=this;this.insBaseTable.tableData=this.rawData,this.insBaseTable.loadingScreen=!1,setTimeout(function(){t.insBaseTable.totalCount=t.totalCount},300)},dynamicKeySort:function(t){var e=1;return"-"===t[0]&&(e=-1,t=t.substr(1)),function(i,s){var a=i[t]<s[t]?-1:i[t]>s[t]?1:0;return a*e}},fetchDataFromSrc:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.insBaseTable.loadingScreen=!0,this.insBaseTable.loaderTitle="Processing Your Data",this.insBaseTable.loaderMessage="Just a moment, we're fetching and processing your data.",this.insBaseTable.loaderIcon="processing",""===this.searchKeyword){t.next=10;break}return t.next=7,tt(this.pageNumber,this.pageSize,this.sortedKeyword,this.sortedBy,this.searchKeyword);case 7:t.t0=t.sent,t.next=13;break;case 10:return t.next=12,J(this.pageNumber,this.pageSize,this.sortedKeyword,this.sortedBy);case 12:t.t0=t.sent;case 13:e=t.t0,e.state?(i=e.results.items.results,i.length?(this.totalCount=e.results.items.total_entries,this.bindTableData(i)):(this.insBaseTable.loaderTitle="",this.searchKeyword?this.insBaseTable.loaderMessage='No results for "'.concat(this.searchKeyword,'"'):this.insBaseTable.loaderMessage="There are no Admin Users yet.",this.insBaseTable.loaderIcon="no-data")):(console.error("Error: ",e.results),this.errorHandler());case 15:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),errorHandler:function(){this.insBaseTable.loaderTitle=void 0,this.insBaseTable.loaderMessage="Failed to load Data. Please try again.",this.insBaseTable.loaderIcon="error"},bindTableData:function(t){var e=this,i=[];t.forEach(function(s){var a=e.constructPhoneNumber("mobile",s.contact_number),n={id:s.id,"First Name":null!==s.first_name||""!==s.first_name?s.first_name:"","Last Name":null!==s.last_name||""!==s.last_name?s.last_name:"",Name:"".concat(s.first_name?s.first_name:""," ").concat(s.last_name?s.last_name:""),Email:null!==s.email||""!==s.email?s.email:"",Role:"Administrator",Company:null===s.administrator_details.company_name?"":s.administrator_details.company_name,"Mobile Phone":a,"Mobile Phone Country Code":null===s.contact_number?"":s.contact_number.mobile_phone_country_code,"Mobile Phone Area Code":null===s.contact_number?"":s.contact_number.mobile_phone_area_code,"Mobile Phone Number":null===s.contact_number?"":s.contact_number.mobile_phone_number,"Last Activity":InsitesUtil.formatLocalisation(s.updated_at)};i.push(n),e.rawData=i,t.length===i.length&&e.processTableData()})},setInsRendererLabel:function(){var t=this,e=document.querySelector("ins-renderer");e?e.updateRouteLabel("Admin Users"):setTimeout(function(){t.setInsRendererLabel()},300)}},mounted:function(){this.setInsRendererLabel(),this.headers=this.apiHeader(),this.insBaseTable=document.getElementById("insBaseTable"),this.insBaseTable.bulkActions=["Delete"],this.insBaseTable.rowActions=["Edit","Delete"],this.insBaseTable.tableHeaders=[{label:"Name",type:"string",sortable:!0,hasLink:!0},{label:"Email",type:"string",sortable:!0},{label:"Role",type:"string",sortable:!1},{label:"Mobile Phone",type:"string",sortable:!1},{label:"Last Activity",type:"string",sortable:!1}],this.fetchDataFromSrc()}},ht=ut,mt=(i("4f73"),Object(P["a"])(ht,V,W,!1,null,null,null)),pt=mt.exports,ft=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("form",{attrs:{id:"userFormId",name:"userForm",action:"/api/users","data-abide":"","data-live-validate":"true",novalidate:"",onsubmit:"event.preventDefault()"},on:{submit:t.bindValues}},[i("div",{staticClass:"grid-container-full"},[i("div",{staticClass:"grid-x grid-padding-x"},[i("div",{staticClass:"large-10 medium-12 small-12"},[i("ins-card",{attrs:{steady:""}},[i("div",{staticClass:"grid-container-full"},[i("div",{staticClass:"grid-x grid-padding-x"},[i("div",{staticClass:"large-6 medium-6 small-12 cell"},[i("div",{staticClass:"grid-x grid-padding-x"},[i("div",{staticClass:"large-12 cell"},[i("h4",{staticClass:"ins-card-heading"},[t._v("User Details")]),i("InsInputWrap",{attrs:{id:"userFirstNameField",name:"userFirstNameField",placeholder:"First Name",label:"First Name*",field:"text",autocomplete:"off",required:"true",errorMessage:"First Name is required.",readonly:"view"===t.formType},model:{value:t.userData["First Name"],callback:function(e){t.$set(t.userData,"First Name",e)},expression:"userData['First Name']"}})],1),i("div",{staticClass:"large-12 cell"},[i("InsInputWrap",{attrs:{id:"userLastNameField",name:"userLastNameField",placeholder:"Last Name",label:"Last Name*",field:"text",autocomplete:"off",required:"true",errorMessage:"Last Name is required.",readonly:"view"===t.formType},model:{value:t.userData["Last Name"],callback:function(e){t.$set(t.userData,"Last Name",e)},expression:"userData['Last Name']"}})],1),i("div",{staticClass:"large-12 cell"},[i("ins-input-tel",{ref:"insInputTel",attrs:{label:"Mobile Phone","area-code":"userDataAreaCode","areacode-placeholder":"Area Code","phone-number":"userDataPhoneNumber","phonenum-placeholder":"Phone Number","phonenum-value":t.phoneNumValue,"areacode-value":t.areaCodeValue,readonly:"view"===t.formType}})],1),i("div",{staticClass:"large-12 cell"},[i("InsInputWrap",{attrs:{id:"userCompanyField",name:"userCompanyField",placeholder:"Company",label:"Company",field:"company",autocomplete:"off",readonly:"view"===t.formType},model:{value:t.userData["Company"],callback:function(e){t.$set(t.userData,"Company",e)},expression:"userData['Company']"}})],1)])]),i("div",{staticClass:"large-6 medium-6 small-12 cell"},[i("div",{staticClass:"grid-x grid-padding-x"},[i("div",{staticClass:"large-12 cell"},[i("h4",{staticClass:"ins-card-heading"},[t._v("Account Details")]),i("InsInputWrap",{ref:"userEmailField",attrs:{id:"userEmailField",name:"userEmailField",placeholder:"Email",label:"Email*",field:"email",autocomplete:"off",required:"true",errorMessage:t.emailErrorMessage,readonly:"view"===t.formType||"my-profile"===t.formType},nativeOn:{keyup:function(e){return t.validateEmail(e)}},model:{value:t.userData["Email"],callback:function(e){t.$set(t.userData,"Email",e)},expression:"userData['Email']"}})],1),"add"===t.formType?i("div",{staticClass:"large-12 cell"},[i("InsInputWrap",{ref:"userPasswordField",attrs:{id:"userPasswordField",name:"userPasswordField",placeholder:"Password",label:"Password*",field:"Password",autocomplete:"off",required:"true",errorMessage:"Password is required and should be more than 5 characters."},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1):t._e()])])])])])],1)])]),i("div",{staticClass:"grid-container-full"},[i("div",{staticClass:"grid-x grid-padding-y"},[i("div",{staticClass:"large-10 text-right cell submit-btn-wrap inline"},[i("ins-button",{attrs:{type:"button",id:"cancelButtonDetails",label:"Cancel",color:"blue",outlined:"true",size:"normal",disabled:t.bindingValues},on:{onClickInsButton:function(e){return t.backToList()}}}),"view"!==t.formType?i("ins-button",{attrs:{type:"submit",id:"submitButtonDetails",label:t.buttonLabel,color:"blue",solid:"true",size:"normal",disabled:t.bindingValues}}):t._e(),"add"==t.formType?i("ins-button",{attrs:{type:"button",id:"saveAddMoreButtonDetails",label:"Save and Create Another",color:"blue",solid:"true",size:"normal",disabled:t.bindingValues},on:{onClickInsButton:function(e){return t.saveAddMore()}}}):t._e()],1)])])])])},_t=[],gt=i("795b"),bt=i.n(gt),vt=(i("7514"),i("774e")),yt=i.n(vt),Ct=i("2f62"),Dt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ins-input",{ref:"insInputEl",attrs:{label:t.label,value:t.value,placeholder:t.placeholder,name:t.name,field:t.field,"field-id":t.fieldId,icon:t.icon,disabled:t.disabled,readonly:t.readonly,required:t.required,maxlength:t.maxlength,"error-message":t.errorMessage,"has-error":t.hasError},on:{valueChange:t.onValueChange}})},kt=[],Tt=i("6b58"),wt={methods:{validateEmail:function(t){var e={from:{email:!0}},i={from:t};return Object(Tt["validate"])(i,e)},validateURL:function(t){var e={website:{url:!0}},i={website:t};return Object(Tt["validate"])(i,e)}}},Et={name:"InsInputWrap",mixins:[wt,m],props:{label:String,value:String,placeholder:String,name:String,field:String,fieldId:String,secondary:String,icon:String,errorMessage:String,hasError:Boolean,disabled:Boolean,readonly:Boolean,required:String,maxlength:String,validate:Boolean},methods:{onValueChange:function(t){var e=t.detail;"url"===this.field&&(e=InsitesUtil.checkURLinput(e,this.secondary),this.$refs.insInputEl.value=e),this.validate&&this.checkInput(e),this.$emit("input",e)},checkInput:function(t){if(this.required&&!t)return this.toggleError(!0,"".concat(this.label," is required."));if(t){var e,i;switch(this.field){case"email":e=this.validateEmail(t),i=e?"Invalid email address.":"";break;case"url":"text"!==this.secondary&&(e=this.validateURL(t),i=e?"Invalid url.":"");break}this.toggleError(e,i)}else this.toggleError(!1,"")},toggleError:function(t,e){this.$refs.insInputEl.hasError=!!t,this.$refs.insInputEl.errorMessage=e,this.$emit("fieldError",{error:!!t,target:this})}}},$t=Et,xt=Object(P["a"])($t,Dt,kt,!1,null,null,null),At=xt.exports,Rt={link:"",app:!1,withSubmenu:!1,label:"Admin Users",formattedRoute:"#/admin-users"},St={link:"#/admin-users",app:!1,withSubmenu:!1,label:"Admin Users"},It={label:"Add New Admin User",link:"#/manage-admin-user"},Nt={link:"",app:!1,withSubmenu:!0,label:"CRM",formattedRoute:"#/customers"},Pt={link:"#/cases",app:!1,withSubmenu:!1,label:"Cases"},Ot={link:"#/customers",app:!1,withSubmenu:!1,label:"Customers"},Lt={label:"Add Company",link:"#/manage-company"},Ft={label:"Add Contact",link:"#/manage-contact"},jt={name:"ViewUserDetails",mixins:[m],components:{InsInputWrap:At},data:function(){return{userData:{},formMethod:"",formName:"",formURL:"/api/users",authToken:"",userCountryCode:"au",password:"",confirmPassword:"",buttonLabel:"Save",emailErrorMessage:"Email address is required.",addMore:!1,formModel:{form_configuration_name:"modules/insites_core/insites_delete_admin_user",form:{profiles_attributes:{"modules/insites_core/insites_administrator_attributes":{properties_attributes:{is_enabled:"true"}}}}},headers:"",toastMsg:"",areaCodeValue:"",phoneNumValue:"",bindingValues:!1}},computed:Object(Ct["b"])({formType:function(t){return t.AdminStore.formType}}),methods:{backToList:function(){this.$store.commit("resetAdminStore"),InsitesUtil.goBack()},saveAddMore:function(){this.addMore=!0,this.bindValues()},validateEmail:function(t){if(t=t.target?t.target:t,""===t.value.trim())return this.emailErrorMessage="Email address is required.",1;this.emailErrorMessage="Invalid email address.",InsitesUtil.validateEmail(t)},changePassword:function(){this.$store.commit("pushFormType","change-password"),this.bindValues()},bindValues:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,i,s,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.bindingValues=!0,e={},i=this.$refs.insInputTel.getCountryData().dialCode,s=document.getElementById("userFormId"),"add"===this.formType?(this.toastMsg="User",e={form_configuration_name:this.formName,form:{email:this.userData["Email"],first_name:this.userData["First Name"],last_name:this.userData["Last Name"],name:this.userData["First Name"]+" "+this.userData["Last Name"],password:this.password,profiles_attributes:{"modules/insites_core/insites_administrator_attributes":{properties_attributes:{is_enabled:"true",company:$("#userCompanyField").val()}},"modules/insites_core/insites_contact_number_attributes":{properties_attributes:{mobile_phone_country_code:i,mobile_phone_area_code:document.getElementsByName("userDataAreaCode")[0].value,mobile_phone_number:document.getElementsByName("userDataPhoneNumber")[0].value}}}}}):(this.addMore=!1,this.toastMsg="User details have",e=this.constructPayload(this.formName)),!InsitesUtil.formValidate(yt()($(s).find(".ins-form-field, .ins-select-value-input, .ins-textarea-field")))){t.next=10;break}return t.next=8,this.submitForm(e).then(function(t){a.successHandler()}).catch(function(t){a.errorHandler(t)});case 8:t.next=11;break;case 10:this.bindingValues=!1;case 11:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),constructPayload:function(t){var e=this.$refs.insInputTel.getCountryData().dialCode;return{form_configuration_name:t,form:{email:this.userData["Email"],first_name:this.userData["First Name"],last_name:this.userData["Last Name"],name:this.userData["First Name"]+" "+this.userData["Last Name"],password:this.password,profiles_attributes:{"modules/insites_core/insites_administrator_attributes":{properties_attributes:{is_enabled:"true",company:this.userData["Company"]}},"modules/insites_core/insites_contact_number_attributes":{properties_attributes:{mobile_phone_country_code:e,mobile_phone_area_code:document.getElementsByName("userDataAreaCode")[0].value,mobile_phone_number:document.getElementsByName("userDataPhoneNumber")[0].value}}}}}},submitForm:function(t){return this.userData.id?st(this.userData.id,z()(t)):at(z()(t))},checkIfAdministrator:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this,t.next=3,nt(this.userData["Email"]);case 3:if(e=t.sent,!e.results.items){t.next=14;break}if(!e.results.items.results.length){t.next=12;break}if(this.userData.id=e.results.items.results[0].id,i=e.results.items.results[0].administrator_details,!i){t.next=11;break}return s=i.is_enabled,t.abrupt("return",!!s&&"true"===s);case 11:return t.abrupt("return",!1);case 12:t.next=15;break;case 14:return t.abrupt("return",!1);case 15:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),setAdministrator:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this.constructPayload("modules/insites_core/insites_set_administrator"),t.next=3,this.submitForm(e).then(function(t){i.successHandler()}).catch(function(t){i.errorHandler(t)});case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),successHandler:function(){toastIt("success","".concat(this.toastMsg," been ").concat("add"===this.formType?"added":"updated","."),InsitesUtil.ops()),"add"===this.formType?(document.getElementById("userFormId").reset(),this.userData["First Name"]="",this.userData["Last Name"]="",this.userData["Company"]="",this.userData["Email"]="",this.password="",!this.addMore&&InsitesUtil.goBack(),this.addMore=!1):(this.$store.commit("pushFormType",""),setTimeout(function(){InsitesUtil.goBack()},1e3)),this.bindingValues=!1},errorHandler:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){var i,s,a,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(i="",s=this,!e.response.data.errors){t.next=13;break}if(!("email"in e.response.data.errors)){t.next=12;break}if("has already been taken"!==e.response.data.errors.email[0].toLowerCase()){t.next=11;break}return t.next=7,s.checkIfAdministrator();case 7:a=t.sent,a?(toastIt("error","User is already an administrator",InsitesUtil.ops()),this.bindingValues=!1):swal({title:"",html:'\n                      <ins-loader\n                        state-icon="warning"\n                        icon-color="warning"\n                        state-message="Email already exists, do you want to set them as an Administrator? This will overwrite their details except for the password.">\n                      </ins-loader>',type:"",width:330,showCancelButton:!0,confirmButtonText:"Yes"}).then(function(t){t.value?n.setAdministrator():t.dismiss&&(n.userData.id="",n.bindingValues=!1)}),t.next=12;break;case 11:i+=e.response.data.errors.email?"- Email "+e.response.data.errors.email[0]+"<br />":"";case 12:"password"in e.response.data.errors&&(i+=e.response.data.errors.password?"- Password "+e.response.data.errors.password[0]:"");case 13:toastIt("error",i,InsitesUtil.ops());case 14:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),setPhoneValue:function(){var t=this;setTimeout(function(){$(".phone").intlTelInput("setNumber","+"+t.userData["Mobile Phone Country Code"]),t.areaCodeValue=t.userData["Mobile Phone Area Code"],t.phoneNumValue=t.userData["Mobile Phone Number"]},300)},updateAdminData:function(t){var e=this.constructPhoneNumber("mobile",t.contact_number);this.userData={id:t.id,"First Name":null!==t.first_name||""!==t.first_name?t.first_name:"","Last Name":null!==t.last_name||""!==t.last_name?t.last_name:"",Name:"".concat(t.first_name?t.first_name:""," ").concat(t.last_name?t.last_name:""),Email:null!==t.email||""!==t.email?t.email:"",Role:"Administrator",Company:null===t.administrator_details.company_name?"":t.administrator_details.company_name,"Mobile Phone":e,"Mobile Phone Country Code":null===t.contact_number?"":t.contact_number.mobile_phone_country_code,"Mobile Phone Area Code":null===t.contact_number?"":t.contact_number.mobile_phone_area_code,"Mobile Phone Number":null===t.contact_number?"":t.contact_number.mobile_phone_number,"Last Activity":InsitesUtil.formatLocalisation(t.updated_at)}},setUserData:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new bt.a(function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(i){var s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$store.state.AdminStore.userData["Email"]){t.next=5;break}e.userData=e.$store.state.AdminStore.userData,i(!0),t.next=15;break;case 5:return t.next=7,Q(e.checkURLParamsID());case 7:if(s=t.sent,!s.results.items.results.length){t.next=12;break}e.updateAdminData(s.results.items.results[0]),t.next=14;break;case 12:return e.toastInvalidIDNotification("user"),t.abrupt("return",e.$router.push("/admin-users"));case 14:i(!0);case 15:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),setFormSettings:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this,e=[],this.checkURLParamsID()?(this.userData["id"]=this.checkURLParamsID(),this.$store.commit("pushFormType","edit"),e=[Rt,St,{label:"Update Admin User",link:"#".concat(this.$route.path)}]):(this.$store.commit("pushFormType","add"),e=[Rt,St,It]),"view"!==this.formType||!this.checkURLParamsID()){t.next=13;break}return this.buttonLabel="Update",t.next=7,this.setUserData();case 7:this.formMethod,this.formURL,this.formName="",i=document.getElementById("userFormId"),i.elements,this.setPhoneValue(),t.next=38;break;case 13:if("edit"!==this.formType||!this.checkURLParamsID()){t.next=23;break}return this.buttonLabel="Update",this.formMethod="PUT",t.next=18,this.setUserData();case 18:this.formURL="/api/users/".concat(this.userData.id),this.formName="modules/insites_core/insites_admin_update_profile",this.setPhoneValue(),t.next=38;break;case 23:if("remove"!==this.formType){t.next=27;break}this.userData=this.$store.state.AdminStore.userData,t.next=38;break;case 27:if(this.checkURLParamsID()){t.next=36;break}this.buttonLabel="Save",this.formMethod="POST",this.formURL="/api/users",this.formName="modules/insites_core/insites_admin_sign_up",this.userData={},this.$refs.userEmailField.disabled=!1,t.next=38;break;case 36:return this.toastInvalidIDNotification("user"),t.abrupt("return",this.$router.push("/admin-users"));case 38:InsitesUtil.setBreadCrumbs(e);case 39:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getProfileData:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this,t.next=3,getCurrentUser().then(function(t){if(t){var i,s=t.data.current_user,a={};if(null===s.contact_number)i="";else{var n=null!==s.contact_number.mobile_phone_country_code?"+"+s.contact_number.mobile_phone_country_code:"",r=null!==s.contact_number.mobile_phone_area_code?s.contact_number.mobile_phone_area_code:"",o=null!==s.contact_number.mobile_phone_number?s.contact_number.mobile_phone_number:"";i="".concat(n," ").concat(r," ").concat(o)}s&&(a={id:s.id,"First Name":s.first_name,"Last Name":s.last_name,Name:s.first_name+" "+s.last_name,Email:s.email,Role:"Administrator",Company:null===s.administrator.company_name?"":s.administrator.company_name,"Mobile Phone":i,"Mobile Phone Country Code":null===s.contact_number?"":s.contact_number.mobile_phone_country_code,"Mobile Phone Area Code":null===s.contact_number?"":s.contact_number.mobile_phone_area_code,"Mobile Phone Number":null===s.contact_number?"":s.contact_number.mobile_phone_number,"Last Activity":Y()(s.updated_at).calendar(null,{sameElse:"Do MMM YYYY"})},e.userData=a,e.formURL="/api/users/".concat(e.userData.id),e.setPhoneValue())}else toastIt("error","Canot get user data",InsitesUtil.ops())});case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),setInsRendererLabel:function(){var t=this,e=document.querySelector("ins-renderer");e?"view"===this.formType?e.updateRouteLabel("Admin Details"):"edit"===this.formType&&this.$route.params.id?e.updateRouteLabel("Update Admin User"):e.updateRouteLabel("Add New Admin User"):setTimeout(function(){t.setInsRendererLabel()},300)}},mounted:function(){var t=this;this.headers=this.apiHeader(),setTimeout(function(){t.setInsRendererLabel(),t.$store.state.AdminStore.userData["Mobile Phone Country Code"]=""===t.$store.state.AdminStore.userData["Mobile Phone Country Code"]?"61":t.$store.state.AdminStore.userData["Mobile Phone Country Code"],t.setFormSettings()},300)},destroyed:function(){this.$store.commit("resetAdminStore")}},Bt=jt,Mt=(i("328b"),Object(P["a"])(Bt,ft,_t,!1,null,null,null)),Ht=Mt.exports,Ut=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"large-12 cell"},[i("div",{staticClass:"grid-container-full"},[i("div",{staticClass:"grid-x grid-margin-x"},[i("form",{staticClass:"large-5 medium-6 small-12 cell no-pd-left",attrs:{id:"userFormId",name:"userForm",action:"/api/users","data-abide":"","data-live-validate":"true",novalidate:"",onsubmit:"event.preventDefault()"},on:{submit:t.updateProfile}},[i("ins-card",{attrs:{steady:""}},[i("div",{staticClass:"grid-x grid-padding-x"},[i("div",{staticClass:"large-12 cell"},[i("h4",{staticClass:"ins-card-heading"},[t._v("User Details")]),i("InsInputWrap",{attrs:{id:"userFirstNameField",name:"userFirstNameField",placeholder:"First Name",label:"First Name*",field:"text",autocomplete:"off",required:"true",errorMessage:"First Name is required."},model:{value:t.userData["First Name"],callback:function(e){t.$set(t.userData,"First Name",e)},expression:"userData['First Name']"}})],1),i("div",{staticClass:"large-12 cell"},[i("InsInputWrap",{attrs:{id:"userLastNameField",name:"userLastNameField",placeholder:"Last Name",label:"Last Name*",field:"text",autocomplete:"off",required:"true",errorMessage:"Last Name is required."},model:{value:t.userData["Last Name"],callback:function(e){t.$set(t.userData,"Last Name",e)},expression:"userData['Last Name']"}})],1),i("div",{staticClass:"large-12 cell"},[i("ins-input-tel",{ref:"insInputTel",attrs:{label:"Mobile Phone","area-code":"userDataAreaCode","areacode-placeholder":"Area Code","phone-number":"userDataPhoneNumber","phonenum-placeholder":"Phone Number","phonenum-value":t.phoneNumValue,"areacode-value":t.areaCodeValue}})],1),i("div",{staticClass:"large-12 cell"},[i("InsInputWrap",{attrs:{id:"userCompanyField",name:"userCompanyField",placeholder:"Company",label:"Company",field:"company",autocomplete:"off"},model:{value:t.userData["Company"],callback:function(e){t.$set(t.userData,"Company",e)},expression:"userData['Company']"}})],1)])]),i("div",{staticClass:"grid-x grid-padding-y"},[i("div",{staticClass:"large-12 cell text-right"},[i("ins-button",{attrs:{type:"button",id:"cancelButtonDetails",label:"Cancel",color:"blue",outlined:"true",size:"normal",disabled:t.bindingValues},on:{onClickInsButton:function(e){return t.backToList()}}}),i("ins-button",{attrs:{type:"submit",id:"submitButtonDetails",color:"blue",solid:"true",size:"normal",label:t.buttonLabel,disabled:t.bindingValues}})],1)])],1),i("form",{staticClass:"large-5 medium-6 small-12 cell",attrs:{id:"userFormPasswordId",name:"userFormPasswordId",action:"#","data-abide":"","data-live-validate":"true",novalidate:"",onsubmit:"event.preventDefault()"},on:{submit:t.changePassword}},[i("ins-card",{attrs:{steady:""}},[i("div",{staticClass:"grid-x grid-padding-x"},[i("div",{staticClass:"large-12 cell"},[i("h4",{staticClass:"ins-card-heading"},[t._v("Account Details")]),i("InsInputWrap",{ref:"userEmailField",attrs:{id:"userEmailField",name:"userEmailField",placeholder:"Email",label:"Email*",field:"email",autocomplete:"off",required:"true",errorMessage:t.emailErrorMessage},nativeOn:{keyup:function(e){return t.validateEmail(e)}},model:{value:t.userData["Email"],callback:function(e){t.$set(t.userData,"Email",e)},expression:"userData['Email']"}})],1),i("div",{staticClass:"large-12 cell"},[i("InsInputWrap",{ref:"userPasswordField",attrs:{id:"userPasswordField",name:"userPasswordField",placeholder:"Password",label:"Password*",field:"Password",autocomplete:"off",required:"true",errorMessage:"Password is required and should be more than 5 characters."},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)])]),i("div",{staticClass:"grid-x grid-padding-y"},[i("div",{staticClass:"large-12 cell text-right"},[i("ins-button",{attrs:{type:"submit",id:"submitButtonDetails",label:"Update Password",color:"blue",solid:"true",size:"normal",disabled:t.bindingValues}})],1)])],1)])])])},Vt=[],Wt={name:"EditUserProfile",mixins:[m],components:{InsInputWrap:At},data:function(){return{updateExistUrl:"",userData:{},formType:"my-profile",formName:"modules/insites_core/insites_admin_update_profile",fromURL:"/api/users",userCountryCode:"au",password:"",buttonLabel:"Save",emailErrorMessage:"Invalid email address.",headers:"",toastMsg:"",sourceProfile:"/insites/api/get-current-user-data.json",areaCodeValue:"",phoneNumValue:"",bindingValues:!1}},methods:{backToList:function(){this.$store.commit("pushFormType",""),InsitesUtil.goBack()},updateProfile:function(){this.formType="my-profile",this.bindValues()},changePassword:function(){this.formType="change-password",this.bindValues()},validateEmail:function(t){if(t=t.target?t.target:t,""===t.value.trim())return this.emailErrorMessage="Email address is required.",1;this.emailErrorMessage="Invalid email address.",InsitesUtil.validateEmail(t)},bindValues:function(){this.bindingValues=!0;var t={},e=(this.$refs.insInputTel.getCountryData().dialCode,"");"change-password"===this.formType?(e=document.getElementById("userFormPasswordId"),t={form_configuration_name:this.formName,form:{email:this.userData["Email"],password:this.password}},this.toastMsg="Your password has"):(e=document.getElementById("userFormId"),t=this.constructPayload(this.formName),this.toastMsg="User details have"),InsitesUtil.formValidate(yt()($(e).find(".ins-form-field, .ins-select-value-input, .ins-textarea-field")))?this.submitForm(t):this.bindingValues=!1},constructPayload:function(t){var e=this.$refs.insInputTel.getCountryData().dialCode;return{form_configuration_name:t,form:{email:this.userData["Email"],first_name:this.userData["First Name"],last_name:this.userData["Last Name"],name:this.userData["First Name"]+" "+this.userData["Last Name"],profiles_attributes:{"modules/insites_core/insites_administrator_attributes":{properties_attributes:{is_enabled:"true",company:$("#userCompanyField").val()}},"modules/insites_core/insites_contact_number_attributes":{properties_attributes:{mobile_phone_country_code:e,mobile_phone_area_code:document.getElementsByName("userDataAreaCode")[0].value,mobile_phone_number:document.getElementsByName("userDataPhoneNumber")[0].value}}}}}},submitForm:function(t,e){var i=this,s=e||this.formURL,a={headers:this.headers,method:"PUT",data:z()(t),success:function(t){i.successHandler()},error:function(t){i.errorHandler(t)}};$.ajax(s,a)},successHandler:function(){toastIt("success","".concat(this.toastMsg," been updated."),InsitesUtil.ops()),setTimeout(function(){window.location.reload()},1e3),this.bindingValues=!1},errorHandler:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){var i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:i="",s=this,s.bindingValues=!1,e.responseJSON.errors&&"undefined"!==e.responseJSON.errors.password&&null!==e.responseJSON.errors.password&&"password"in e.responseJSON.errors&&(i+=e.responseJSON.errors.password?"- Password "+e.responseJSON.errors.password[0]:""),toastIt("error",i,InsitesUtil.ops());case 5:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),setPhoneValue:function(){var t=this;setTimeout(function(){$(".phone").intlTelInput("setNumber","+"+t.userData["Mobile Phone Country Code"]),t.areaCodeValue=t.userData["Mobile Phone Area Code"],t.phoneNumValue=t.userData["Mobile Phone Number"]},300)},setFormSettings:function(){this.getProfileData(),this.buttonLabel="Update Details",this.setPhoneValue()},getProfileData:function(){var t=this;this.$http.get(this.sourceProfile).then(function(e){if(e){var i,s=e.data.current_user,a={};if(null===s.contact_number)i="";else{var n=null!==s.contact_number.mobile_phone_country_code?"+"+s.contact_number.mobile_phone_country_code:"",r=null!==s.contact_number.mobile_phone_area_code?s.contact_number.mobile_phone_area_code:"",o=null!==s.contact_number.mobile_phone_number?s.contact_number.mobile_phone_number:"";i="".concat(n," ").concat(r," ").concat(o)}s&&(a={id:s.id,"First Name":s.first_name,"Last Name":s.last_name,Name:s.first_name+" "+s.last_name,Email:s.email,Role:"Administrator",Company:null===s.administrator.company_name?"":s.administrator.company_name,"Mobile Phone":i,"Mobile Phone Country Code":null===s.contact_number?"":s.contact_number.mobile_phone_country_code,"Mobile Phone Area Code":null===s.contact_number?"":s.contact_number.mobile_phone_area_code,"Mobile Phone Number":null===s.contact_number?"":s.contact_number.mobile_phone_number,"Last Activity":Y()(s.updated_at).calendar(null,{sameElse:"Do MMM YYYY"})},t.userData=a,t.formURL="/api/users/".concat(t.userData.id),t.setPhoneValue())}else console.warn("Error: User is not logged in"),toastIt("error","Failed to get user data. Please try again.",InsitesUtil.ops()),InsitesUtil.goBack()})},setInsRendererLabel:function(){var t=this;setTimeout(function(){var e=document.querySelector("ins-renderer");e&&"function"===typeof e.updateRouteLabel?e.updateRouteLabel("My Profile"):t.setInsRendererLabel()},500)}},mounted:function(){var t=this;this.headers=this.apiHeader(),this.setInsRendererLabel(),setTimeout(function(){t.$store.state.AdminStore.userData["Mobile Phone Country Code"]=""===t.$store.state.AdminStore.userData["Mobile Phone Country Code"]?"61":t.$store.state.AdminStore.userData["Mobile Phone Country Code"],t.setFormSettings()},300)}},Kt=Wt,zt=(i("0a40"),Object(P["a"])(Kt,Ut,Vt,!1,null,null,null)),qt=zt.exports,Yt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"list-crm-wrap"},[i("div",{staticClass:"header-buttons"},[i("ins-button",{attrs:{field:"addNewCompany",id:"addNewCompany",label:"ADD NEW COMPANY",color:"blue",solid:"true",size:"medium",disabled:t.loadingPage},on:{onClickInsButton:t.addNewCompany}}),i("ins-button",{attrs:{field:"addNewContact",id:"addNewContact",label:"ADD NEW CONTACT",color:"blue",solid:"true",size:"medium",disabled:t.loadingPage},on:{onClickInsButton:function(e){return t.addNewContact()}}})],1),i("ins-base-table",{attrs:{id:"insBaseTable","searchbar-placeholder":"Search by Company, Contact or Email..."},on:{onPaginationChange:t.tablePaginationHandler,onTableSearch:t.tableSearchHandler,onTableSort:t.tableSortHandler,onTableBulkAction:t.tableBulkActionHandler,onTableRowAction:t.tableRowActionHandler}}),i("div",{staticClass:"spacer large"})],1)},Gt=[],Jt=(i("55dd"),i("6762"),i("2fdb"),i("a4bb")),Xt=i.n(Jt),Qt=i("e814"),Zt=i.n(Qt),te=i("2ef0"),ee={name:"ListCRM",mixins:[m],components:{},data:function(){return{allowSort:!1,loadingPage:!1,headers:void 0,crmListData:[],companyListData:[],crmBuilt:!1,companyBuilt:!1,sourceCompany:"/insites/api/get-all-company-list-data.json",sourceCRM:"/insites/api/get-all-customers-list-data.json",sourceCRMDetails:"/insites/api/get-all-company-contact-list-data.json?id=",searchSource:"/insites/api/search-company-data.json",date_from:"",date_to:"",userData:{},companyData:{},totalCount:0,pageNumber:1,pageSize:10,searchKeyword:"",sortedKeyword:"",sortedBy:"asc",rawData:[],filteredData:[],displayedData:[],formModel:{form_configuration_name:"modules/insites_core/insites_crm_delete_customer",form:{profiles_attributes:{"modules/insites_core/insites_customer_attributes":{properties_attributes:{is_enabled:"false"}}}}},continueDeletion:!1,errorMessage:"Failed to load Data. Please try again."}},methods:{onFilterApplyHandler:function(t){t.detail.from,t.detail.to;this.fetchDataFromSrc()},addNewCompany:function(){this.$store.commit("pushUserProfile","modules/insites_core/insites_company"),this.$store.commit("pushFormType","add"),this.$store.commit("pushFormName","modules/insites_core/insites_add_new_company"),InsitesUtil.renderPage("Add Company","#/manage-company"),this.$router.push("/manage-company")},addNewContact:function(){this.$store.commit("pushUserProfile","modules/insites_core/insites_customer"),this.$store.commit("pushFormType","add"),this.$store.commit("pushFormName","modules/insites_core/insites_add_new_customer"),InsitesUtil.renderPage("Add Contact","#/manage-contact"),this.$router.push("/manage-contact")},tablePaginationHandler:function(t){var e=Zt()(t.detail.pageSize);this.pageNumber=t.detail.pageNumber,this.pageSize!==e&&(this.pageNumber=1),this.pageSize=e,this.processTableData()},dynamicKeySort:function(t,e){var i="asc"===e?1:-1;return function(e,s){var a=e[t]<s[t]?-1:e[t]>s[t]?1:0;return a*i}},tableSearchHandler:function(t){var e=this;if(13===t.detail.keyCode&&""!==t.detail.value||""===t.detail.value&&""!==this.searchKeyword){if(this.insBaseTable.loadingScreen=!0,this.searchKeyword=t.detail.value,!this.searchKeyword)return void this.processTableData();this.filteredData=[];var i=this;this.rawData.forEach(function(t){Xt()(t).forEach(function(s){if("Company"===s||"Contact"===s||"Email"===s){var a=t[s];if(a.toLowerCase().includes(i.searchKeyword.toLowerCase())){var n=e.filteredData.find(function(e){return e.company_id===t.company_id||e.contact_id===t.contact_id});n||e.filteredData.push(t)}}})}),this.sortedKeyword&&this.filteredData.length>0&&this.filteredData.sort(this.dynamicKeySort(this.sortedKeyword)),this.insBaseTable.pageNumber=1,this.processTableData(),this.filteredData.length||(this.insBaseTable.loadingScreen=!0,this.insBaseTable.loaderTitle="",this.insBaseTable.loaderMessage='No result found for "'+this.searchKeyword+'"',this.insBaseTable.loaderIcon="")}},tableSortHandler:function(t){this.sortedKeyword=t.detail.keyword,this.sortedBy=t.detail.order,this.allowSort&&(this.searchKeyword?this.filteredData.sort(this.dynamicKeySort(this.sortedKeyword,this.sortedBy)):this.rawData.sort(this.dynamicKeySort(this.sortedKeyword,this.sortedBy)),this.processTableData())},tableBulkActionHandler:function(t){"Archive"===t.detail.action&&this.archiveSelection(t.detail.selections)},tableRowActionHandler:function(t){"Archive"===t.detail.action?this.archiveItem(t.detail):"Edit"===t.detail.action?("Company"===t.detail.header?this.$store.commit("pushUserData",t.detail.data):"Contact"===t.detail.header||"Email"===t.detail.header?t.detail.data.Company?this.$store.commit("pushUserData",t.detail.data.contact_data):this.$store.commit("pushUserData",t.detail.data):""===t.detail.header&&(t.detail.data.company_id?this.$store.commit("pushUserData",t.detail.data):t.detail.data.Company?this.$store.commit("pushUserData",t.detail.data.contact_data):this.$store.commit("pushUserData",t.detail.data)),this.$store.commit("pushFormType","edit"),this.viewItem(t.detail)):"View"===t.detail.action&&this.viewHandler(t.detail)},viewItem:function(t){"Company"===t.header?(InsitesUtil.renderPage("Edit Company","#/edit-company/".concat(t.data.company_id)),this.setURLParameter("/edit-company",t.data.company_id)):"Contact"===t.header||"Email"===t.header?(InsitesUtil.renderPage("Edit Contact","#/edit-contact/".concat(t.data.contact_id)),this.setURLParameter("/edit-contact",t.data.contact_id)):""===t.header?t.data.company_id?(InsitesUtil.renderPage("Edit Company","#/edit-company/".concat(t.data.company_id)),this.setURLParameter("/edit-company",t.data.company_id)):(InsitesUtil.renderPage("Edit Contact","#/edit-contact/".concat(t.data.contact_id)),this.setURLParameter("/edit-contact",t.data.contact_id)):this.$router.push("/customers")},viewHandler:function(t){switch(t.header){case"Company":this.$store.commit("setCompanyData",t.data),InsitesUtil.renderPage("View Company","#/view-company/".concat(t.data.company_id)),this.setURLParameter("/view-company",t.data.company_id);break;case"Contact":case"Email":t.data.Company?this.$store.commit("setContactData",event.detail.data.contact_data):this.$store.commit("setContactData",event.detail.data),InsitesUtil.renderPage("View Contact","#/view-contact/".concat(t.data.contact_id)),this.setURLParameter("/view-contact",t.data.contact_id);break;case"":if(t.data.company_id){this.$store.commit("setCompanyData",t.data),InsitesUtil.renderPage("View Company","#/view-company/".concat(t.data.company_id)),this.setURLParameter("/view-company",t.data.company_id);break}t.data.Company?this.$store.commit("setContactData",event.detail.data.contact_data):this.$store.commit("setContactData",event.detail.data),InsitesUtil.renderPage("View Contact","#/view-contact/".concat(t.data.contact_id)),this.setURLParameter("/view-contact",t.data.contact_id)}},archiveItem:function(t){var e=this,i="Are you sure you want to archive this contact?";"Company"==t.header&&(i="Are you sure you want to archive this company?  By doing so, it will also archive all contacts listed in it."),swal({title:"",html:'\n          <ins-loader\n            state-icon="warning"\n            icon-color="warning"\n            state-message="'.concat(i,'">\n          </ins-loader>'),type:"",width:330,showCancelButton:!0,confirmButtonClass:"negative",confirmButtonText:"Archive"}).then(function(i){i.value&&(e.continueDeletion=!0,"Company"==t.header?e.deleteCompanyAndContacts(t.data.company_id,!0):e.deleteContact(t.data.contact_id,!0))})},archiveSelection:function(t){var e=this;swal({title:"",html:'\n          <ins-loader\n            state-icon="warning"\n            icon-color="warning"\n            state-message="Are you sure you want to archive these items?">\n          </ins-loader>',type:"",width:330,showCancelButton:!0,confirmButtonClass:"negative",confirmButtonText:"Archive"}).then(function(i){if(i.value){var s=0;e.continueDeletion=!0,t.forEach(function(){var i=Object(h["a"])(regeneratorRuntime.mark(function i(a){return regeneratorRuntime.wrap(function(i){while(1)switch(i.prev=i.next){case 0:if(!e.continueDeletion){i.next=10;break}if(!a.company_id){i.next=6;break}return i.next=4,e.deleteCompanyAndContacts(a.company_id,!1);case 4:i.next=8;break;case 6:return i.next=8,e.deleteContact(a.contact_id,!1);case 8:s++,t.length===s&&(e.continueDeletion=!1,toastIt("success","Selected items have been archived.",e.ops),e.fetchDataFromSrc());case 10:case"end":return i.stop()}},i,this)}));return function(t){return i.apply(this,arguments)}}())}})},deleteContactList:function(t){var e=this;return t.forEach(function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(i){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.deleteContact(i.id,!1);case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()),!0},deleteCompanyAndContacts:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e,i){var s,a,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(s="".concat(this.sourceCRMDetails).concat(e,"&sortBy=updated_at&orderBy=desc"),a=!1,!this.continueDeletion){t.next=14;break}return t.next=5,this.getAdditionalData(s);case 5:if(n=t.sent,n&&n!==[]){t.next=10;break}a=!0,t.next=13;break;case 10:return t.next=12,this.deleteContactList(n);case 12:a=t.sent;case 13:a&&(this.continueDeletion=!1,this.deleteCompany(e,!1),i&&(toastIt("success","Company has been archived.",this.ops),this.fetchDataFromSrc()));case 14:case"end":return t.stop()}},t,this)}));function e(e,i){return t.apply(this,arguments)}return e}(),deleteCompany:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e,i){var s,a,n,r=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this,s="/api/customizations/".concat(e),a={form_configuration_name:"modules/insites_core/insites_crm_delete_company",parent_resource_id:"modules/insites_core/insites_company",form:{properties:{is_enabled:"false"}}},n=z()(a),t.next=6,this.$http.put(s,n,{headers:this.headers}).then(function(t){if(r.$store.commit("removeCompanyOption",e),!r.continueDeletion)return i&&(toastIt("success","Company and its contacts have been archived.",r.ops),r.fetchDataFromSrc()),!0}).catch(function(t){r.continueDeletion=!1,r.fetchDataFromSrc(),toastIt("error","Failed to archive company. Please try again.",r.ops)});case 6:case"end":return t.stop()}},t,this)}));function e(e,i){return t.apply(this,arguments)}return e}(),deleteContact:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e,i){var s,a,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return s="/api/users/".concat(e),a=z()(this.formModel),t.next=4,this.$http.put(s,a,{headers:this.headers}).then(function(t){i&&(toastIt("success","Contact has been archived.",n.ops),n.fetchDataFromSrc())}).catch(function(t){n.continueDeletion=!1,n.fetchDataFromSrc(),toastIt("error","Failed to archive user. Please try again.",n.ops)});case 4:!this.continueDeletion&&i&&this.fetchDataFromSrc();case 5:case"end":return t.stop()}},t,this)}));function e(e,i){return t.apply(this,arguments)}return e}(),processTableData:function(){var t=this,e=this.pageNumber*this.pageSize,i=e-this.pageSize;this.displayedData=[],this.searchKeyword?this.filteredData.forEach(function(s,a){a>=i&&a<=e?t.displayedData.push(s):t.filteredData.length<t.pageSize&&t.displayedData.push(s)}):this.rawData.forEach(function(s,a){a>=i&&a<e&&t.displayedData.push(s)}),this.insBaseTable.totalCount=this.rawData.length,this.insBaseTable.tableData=this.displayedData,this.insBaseTable.loadingScreen=!1},searchPrimaryContact:function(t){var e=t.find(function(t){return"Primary"===t.customer_details.contact_type});return e||(e=t.find(function(t){return"Secondary"===t.customer_details.contact_type})),e||t[0]},removeTableDataDuplicate:function(){for(var t={},e=0;e<this.rawData.length;e++)if("undefined"!==typeof this.rawData[e]["company_id"]&&""!==this.rawData[e]["company_id"]&&null!==this.rawData[e]["company_id"])t[this.rawData[e]["company_id"]]=this.rawData[e];else if(Object(te["isEmpty"])(t))t[[e]]=this.rawData[e];else for(var i in t)t[i].id!==this.rawData[e].id&&t[this.rawData[e]["company_id"]]!==this.rawData[e].id&&(t[[e]]=this.rawData[e]);var s=[];for(var a in t)s.push(t[a]);this.insBaseTable.totalCount=s.length,this.rawData=s,this.processTableData()},renderTable:function(){if(this.crmBuilt&&this.companyBuilt)if(this.crmListData.length||this.companyListData.length)this.allowSort=!0,this.processTableData();else{this.allowSort=!1,this.insBaseTable.totalCount=this.rawData.length;var t="No customers yet.";this.searchKeyword&&(t='No result for "'.concat(this.searchKeyword,'"')),this.loaderStateHandler("",t,"no data"),this.loadingPage=!1}},fetchCRMData:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this.constructURL("".concat(this.sourceCRM,"?size=10000&page=1&date")),t.next=3,this.$http.get(e).then(this.crmResponseHandler).catch(this.errorHandler);case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),crmResponseHandler:function(t){this.crmListData=[],t.data.items.results.length?(this.crmListData=t.data.items.results,this.fetchCompanyData()):(this.crmBuilt=!0,this.fetchCompanyData())},buildCRMTableData:function(){var t=this;this.crmListData.forEach(function(e){var i=t.constructDateTime(e.updated_at),s=t.constructCRMTableData(e,{},i);t.rawData.push(s)}),this.crmBuilt=!0,this.renderTable()},getAdditionalData:function(t){return this.$http.get(t).then(function(t){return!!t.data.items&&(!!t.data.items.results.length&&t.data.items.results)}).catch(this.errorHandler)},fetchCompanyData:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this.constructURL("".concat(this.sourceCompany,"?size=1000&page=1")),t.next=3,this.$http.get(e).then(this.companyResponseHandler).catch(this.errorHandler);case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),companyResponseHandler:function(t){t.data.items.results.length?(this.companyListData=t.data.items.results,this.$store.commit("setCompanyOptions",this.companyListData),this.loadingPage=!1,this.getContacts()):(this.companyBuilt=!0,this.companyListData=[],this.buildCRMTableData())},buildCompanyTableData:function(){var t=this;this.companyListData.forEach(function(e){var i,s=e.updated_at;e.contacts.length&&(i=t.searchPrimaryContact(e.contacts),i&&(s=i.updated_at)),s=t.constructDateTime(s);var a=t.constructCompanyTableData(e,i,s);t.rawData.push(a)}),this.companyBuilt=!0,this.buildCRMTableData()},constructCompanyTableData:function(t,e,i){var s={id:null===t.id?"":t.id,raw:t,contact_data:{},company_id:null===t.id?"":t.id,Company:null===t.company_name?"":t.company_name,"Profile Image":Object(te["isEmpty"])(t)||null===t.profile_image?"":t.profile_image.original,Company_Img:Object(te["isEmpty"])(t)||null===t.profile_image?"":t.profile_image.original,company_updated_at:null===t.updated_at?"":this.constructDateTime(t.updated_at),Phone:this.constructPhoneNumber("mobile",t),"Home Phone":this.constructPhoneNumber("home",t),"Work Phone":this.constructPhoneNumber("work",t),"Last Activity":i,contact_id:"","First Name":"","Last Name":"",Contact:"","Contact Type":"",Email:"",Contact_Img:"","Company Mobile Phone Country Code":this.checkValue(t.mobile_phone_country_code),"Company Mobile Phone Area Code":this.checkValue(t.mobile_phone_area_code),"Company Mobile Phone Number":this.checkValue(t.mobile_phone_number),"Company Home Phone Country Code":this.checkValue(t.home_phone_country_number),"Company Home Phone Area Code":this.checkValue(t.home_phone_area_number),"Company Home Phone Number":this.checkValue(t.home_phone_number),"Company Work Phone Country Code":this.checkValue(t.work_phone_country_number),"Company Work Phone Area Code":this.checkValue(t.work_phone_area_number),"Company Work Phone Number":this.checkValue(t.work_phone_number),Location1address:t.location_1.length>0&&"undefined"!==t.location_1[0].address?t.location_1[0].address:"",Location1street:t.location_1.length>0&&"undefined"!==t.location_1[0].street?t.location_1[0].street:"",Location1city:t.location_1.length>0&&"undefined"!==t.location_1[0].city?t.location_1[0].city:"",Location1state:t.location_1.length>0&&"undefined"!=t.location_1[0].state?t.location_1[0].state:"",Location1postode:t.location_1.length>0&&"undefined"!=t.location_1[0].postcode?t.location_1[0].postcode:"",Location1country:t.location_1.length>0&&"undefined"!==t.location_1[0].country?t.location_1[0].country:"",Facebook:this.checkValue(t.facebook_link),Instagram:this.checkValue(t.instagram_link),Twitter:this.checkValue(t.twitter_link),Google:this.checkValue(t.google_plus_link),Linkedin:this.checkValue(t.linkedin_link),Youtube:this.checkValue(t.youtube_link),Notes:this.checkValue(t.notes),Website:this.checkValue(t.website),"Industry Type":this.checkValue(t.industry_type),"Company Type":this.checkValue(t.company_type),"Assigned To":this.checkValue(t.assigned_to),contact_updated_at:""};return e&&(s["contact_id"]=Object(te["isEmpty"])(e)||e?e.id:"",s["First Name"]=Object(te["isEmpty"])(e)||e?e.first_name:"",s["Last Name"]=Object(te["isEmpty"])(e)||e?e.last_name:"",s["Contact Type"]=Object(te["isEmpty"])(e)||e?e.customer_details.contact_type:"",s["Contact"]=this.constructContactName(e),s["Email"]=Object(te["isEmpty"])(e)||e?e.email:"",s["Mobile Phone"]=this.constructPhoneNumber("mobile",e.contact_number),s["Mobile Phone Country Code"]=Object(te["isEmpty"])(e.contact_number)?"":this.checkValue(e.contact_number.mobile_phone_country_code),s["Mobile Phone Area Code"]=Object(te["isEmpty"])(e.contact_number)?"":this.checkValue(e.contact_number.mobile_phone_area_code),s["Mobile Phone Number"]=Object(te["isEmpty"])(e.contact_number)?"":this.checkValue(e.contact_number.mobile_phone_number),s["Home Phone"]=this.constructPhoneNumber("home",e.contact_number),s["Home Phone Country Code"]=Object(te["isEmpty"])(e.contact_number)?"":this.checkValue(e.contact_number.home_phone_country_code),s["Home Phone Area Code"]=Object(te["isEmpty"])(e.contact_number)?"":this.checkValue(e.contact_number.home_phone_area_code),s["Home Phone Number"]=Object(te["isEmpty"])(e.contact_number)?"":this.checkValue(e.contact_number.home_phone_number),s["Work Phone"]=this.constructPhoneNumber("work",e.contact_number),s["Work Phone Country Code"]=Object(te["isEmpty"])(e.contact_number)?"":this.checkValue(e.contact_number.work_phone_country_code),s["Work Phone Area Code"]=Object(te["isEmpty"])(e.contact_number)?"":this.checkValue(e.contact_number.work_phone_area_code),s["Work Phone Number"]=Object(te["isEmpty"])(e.contact_number)?"":this.checkValue(e.contact_number.work_phone_number),s["contact_updated_at"]=Object(te["isEmpty"])(e)||e?"":this.constructDateTime(e.updated_at),s.contact_data=this.constructCRMTableData(e,t,this.constructDateTime(e.updated_at)),s["Contact_Img"]=Object(te["isEmpty"])(e.customer_details)?"":null===e.customer_details.profile_image?"":e.customer_details.profile_image.original),s},constructContactName:function(t){return Object(te["isEmpty"])(t)||null===t?"":t.first_name&&t.last_name?"".concat(t.first_name," ").concat(t.last_name):t.email?t.email:""},getContacts:function(){var t=this;this.companyListData.forEach(function(e){e.contacts=t.findContacts(e.id)}),this.buildCompanyTableData()},findContacts:function(t){return Object(te["remove"])(this.crmListData,{customer_details:{company_id:t}})},fetchDataFromSrc:function(){this.rawData=[],this.displayedData=[],this.loaderStateHandler("Processing Your Data","Just a moment, we're fetching and processing your data.","processing"),this.fetchCRMData()},errorHandler:function(t){console.error("Error: "+t),this.continueDeletion=!1,this.loaderStateHandler("",this.errorMessage,"error")},loaderStateHandler:function(t,e,i){this.insBaseTable.loadingScreen=!0,this.insBaseTable.loaderTitle=t,this.insBaseTable.loaderMessage=e,this.insBaseTable.loaderIcon=i},setupInsTable:function(){this.insBaseTable=document.getElementById("insBaseTable"),this.insBaseTable.rowActions=["View","Edit","Archive"],this.insBaseTable.bulkActions=["Archive"],this.insBaseTable.tableHeaders=[this.constructTableHeader("Company","string",!0,!0,!0),this.constructTableHeader("Contact","string",!0,!0,!0),this.constructTableHeader("Email","string",!0),this.constructTableHeader("Phone"),this.constructTableHeader("Last Activity","string",!0)]},constructTableHeader:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"string",i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return{label:t,type:e,sortable:i,hasColumnAction:s,hasImage:a}},constructURL:function(t){var e=t;return e+="?sortBy=".concat(this.sortedKeyword),e+="&orderBy=".concat(this.sortedBy),e},constructDateTime:function(t){return t?InsitesUtil.formatLocalisation(t):""},constructCRMTableData:function(t,e,i){return{id:null===t.id?"":t.id,raw:t,"Contact Type":t.customer_details.contact_type,company_id:Object(te["isEmpty"])(e)||null===e.id?"":e.id,Company:Object(te["isEmpty"])(e)||null===e.company_name?"":e.company_name,Company_Img:Object(te["isEmpty"])(e)||Object(te["isEmpty"])(e.profile_image)?"":e.profile_image.original,company_updated_at:Object(te["isEmpty"])(e)||null===e.updated_at?"":this.constructDateTime(e.updated_at),contact_id:t.id,"First Name":t.first_name,"Last Name":t.last_name,Contact:this.constructContactName(t),Email:t.email,Notes:this.checkValue(t.customer_details.notes),Contact_Img:null===t.customer_details.profile_image?"":this.checkValue(t.customer_details.profile_image.original),"Profile Image":Object(te["isEmpty"])(t)||null===t.customer_details.profile_image?"":t.customer_details.profile_image.original,Phone:Object(te["isEmpty"])(t.contact_number)?"":this.constructPhoneNumber("mobile",t.contact_number),"Mobile Phone":Object(te["isEmpty"])(t.contact_number)?"":this.constructPhoneNumber("mobile",t.contact_number),"Mobile Phone Country Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.mobile_phone_country_code),"Mobile Phone Area Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.mobile_phone_area_code),"Mobile Phone Number":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.mobile_phone_number),"Home Phone":Object(te["isEmpty"])(t.contact_number)?"":this.constructPhoneNumber("home",t.contact_number),"Home Phone Country Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.home_phone_country_code),"Home Phone Area Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.home_phone_area_code),"Home Phone Number":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.home_phone_number),"Work Phone":Object(te["isEmpty"])(t.contact_number)?"":this.constructPhoneNumber("work",t.contact_number),"Work Phone Country Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.work_phone_country_code),"Work Phone Area Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.work_phone_area_code),"Work Phone Number":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.work_phone_number),"Home Address":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].address):"","Home Street":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].street):"","Home City":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].city):"","Home State":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].state):"","Home Area Code":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].postcode):"","Home Country":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].country):"",Facebook:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.facebook_link),Instagram:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.instagram_link),Twitter:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.twitter_link),Google:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.google_plus_link),Linkedin:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.linkedin_link),Youtube:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.youtube_link),contact_updated_at:this.constructDateTime(t.updated_at),"Last Activity":i}},setInsRendererLabel:function(){var t=this,e=document.querySelector("ins-renderer");e.updateRouteLabel?e.updateRouteLabel("Customers"):setTimeout(function(){t.setInsRendererLabel()},300)}},mounted:function(){this.setInsRendererLabel(),this.date_from=Y()(new Date).format("MM-DD-YYYY"),this.date_to=Y()(new Date).format("MM-DD-YYYY"),this.headers=this.apiHeader(),this.setupInsTable(),this.fetchDataFromSrc()}},ie=ee,se=(i("4615"),Object(P["a"])(ie,Yt,Gt,!1,null,null,null)),ae=se.exports,ne=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"grid-container-full"},[i("div",{staticClass:"grid-x"},[i("div",{staticClass:"large-12 medium-12 small-12 cell"},[t.showForm?i("form",{attrs:{id:"crmForm",action:"#","data-abide":"","data-live-validate":"true",novalidate:"",onsubmit:"event.preventDefault()",enctype:"multipart/form-data"}},[i("ins-card",{staticClass:"main-wrap",attrs:{steady:""}},[i("div",{staticClass:"grid-x grid-padding-x "},[i("div",{staticClass:"large-12 small-12 cell"},[i("h4",{staticClass:"ins-card-heading"},[t._v("Contact Details")])]),i("div",{staticClass:"large-4 medium-6 small-12 cell"},[i("InsImagePickerWrap",{attrs:{name:"userCustomerProfileImage",type:"picture","button-color":"blue",label:"ADD PHOTO"},on:{fileNameChanged:t.getFilename},model:{value:t.s3IconImage,callback:function(e){t.s3IconImage=e},expression:"s3IconImage"}})],1),i("div",{staticClass:"large-4 medium-6 small-12 cell"},[i("div",{staticClass:"grid-x grid-padding-x"},[i("InsInputWrap",{staticClass:"large-6 medium-6 small-12 cell",attrs:{id:"userFirstNameField",name:"userFirstNameField",maxlength:"30",placeholder:"First Name",label:"First Name",field:"text",autocomplete:"off"},model:{value:t.userData["First Name"],callback:function(e){t.$set(t.userData,"First Name",e)},expression:"userData['First Name']"}}),i("InsInputWrap",{staticClass:"large-6 medium-6 small-12 cell",attrs:{id:"userLastNameField",name:"userLastNameField",maxlength:"30",placeholder:"Last Name",label:"Last Name",field:"text",autocomplete:"off"},model:{value:t.userData["Last Name"],callback:function(e){t.$set(t.userData,"Last Name",e)},expression:"userData['Last Name']"}})],1),i("div",{staticClass:"grid-x grid-padding-x"},[i("InsSelectWrap",{staticClass:"large-12 medium-12 small-12 cell",attrs:{id:"userAssignedToField",name:"form[properties_attributes][contact_type]",label:"Contact Type",placeholder:"- Select -",searchable:""},model:{value:t.userData["Contact Type"],callback:function(e){t.$set(t.userData,"Contact Type",e)},expression:"userData['Contact Type']"}},[i("ins-select-option",{attrs:{label:"Primary",value:"Primary"}}),i("ins-select-option",{attrs:{label:"Secondary",value:"Secondary"}}),t._l(t.contactTypes.results,function(t){return i("ins-select-option",{key:t.id,attrs:{label:t.value,value:t.id}})})],2),t.mutatingCompanies?t._e():i("InsSelectWrap",{staticClass:"large-12 medium-12 small-12 cell",attrs:{id:"userAssignedToField",name:"form[properties_attributes][contact_type]",label:"Company",placeholder:"- Select -","dynamic-placeholder":"Add New Company",searchable:"","with-dynamic-option":""},on:{onSubmitOption:t.onSubmitOptionHandler},model:{value:t.userData["company_id"],callback:function(e){t.$set(t.userData,"company_id",e)},expression:"userData['company_id']"}},[t.companyOptions.length?t._e():i("ins-select-option",{attrs:{label:"No company yet.",value:"",disabled:""}}),t._l(t.companyOptions,function(t){return i("ins-select-option",{key:t.id,attrs:{label:t.label,value:t.id}})})],2)],1),i("InsInputWrap",{ref:"userEmailField",attrs:{id:"userEmailField",name:"userEmailField",maxlength:"30",placeholder:"Email Address",label:"Email Address*",field:"email",required:"true",autocomplete:"off",errorMessage:t.emailErrorMessage},nativeOn:{keyup:function(e){return t.validateEmail(e)}},model:{value:t.userData["Email"],callback:function(e){t.$set(t.userData,"Email",e)},expression:"userData['Email']"}})],1),i("div",{staticClass:"large-4 medium-6 small-12 cell"},[i("ins-input-tel",{ref:"homePhone",attrs:{id:"homePhone",label:"Home Phone","area-code":"userDataHomeAreaCode","areacode-placeholder":"Area Code","phone-number":"userDataHomePhoneNumber","phonenum-placeholder":"Phone Number","phonenum-value":t.homePhoneNumValue,"areacode-value":t.homeAreaCodeValue,readonly:"view"===t.formType}}),i("ins-input-tel",{ref:"workPhone",attrs:{id:"workPhone",label:"Work Phone","area-code":"userDataWorkAreaCode","areacode-placeholder":"Area Code","phone-number":"userDataWorkPhoneNumber","phonenum-placeholder":"Phone Number","phonenum-value":t.workPhoneNumValue,"areacode-value":t.workAreaCodeValue,readonly:"view"===t.formType}}),i("ins-input-tel",{ref:"mobilePhone",attrs:{id:"mobilePhone",label:"Mobile Phone","area-code":"userDataMobileAreaCode","areacode-placeholder":"Area Code","phone-number":"userDataMobilePhoneNumber","phonenum-placeholder":"Phone Number","phonenum-value":t.mobilePhoneNumValue,"areacode-value":t.mobileAreaCodeValue,readonly:"view"===t.formType}})],1)]),i("div",{staticClass:"grid-x grid-padding-x spacer-top-m"},[i("div",{staticClass:"large-12 small-12 cell"},[i("h4",{staticClass:"ins-card-heading"},[t._v("Additional Info")])]),i("div",{staticClass:"large-4 medium-6 small-12 cell"},[i("InsInputWrap",{attrs:{id:"userFacebookField",name:"userFacebookField",maxlength:"50",placeholder:"https://facebook.com/",label:"Facebook Profile Link",field:"url",validate:!0,autocomplete:"off"},model:{value:t.userData["Facebook"],callback:function(e){t.$set(t.userData,"Facebook",e)},expression:"userData['Facebook']"}}),i("InsInputWrap",{attrs:{id:"userTwitterField",name:"userTwitterField",maxlength:"50",placeholder:"https://twitter.com/",label:"Twitter Profile Link",field:"url",validate:!0,autocomplete:"off"},model:{value:t.userData["Twitter"],callback:function(e){t.$set(t.userData,"Twitter",e)},expression:"userData['Twitter']"}}),i("InsInputWrap",{attrs:{id:"userYoutubeField",name:"userYoutubeField",maxlength:"50",placeholder:"https://youtube.com/",label:"YouTube Profile Link",field:"url",validate:!0,autocomplete:"off"},model:{value:t.userData["Youtube"],callback:function(e){t.$set(t.userData,"Youtube",e)},expression:"userData['Youtube']"}})],1),i("div",{staticClass:"large-4 medium-6 small-12 cell"},[i("InsInputWrap",{attrs:{id:"userLinkedinField",name:"userLinkedinField",maxlength:"50",placeholder:"https://linkedin.com/",label:"Linkedin Profile Link",field:"url",validate:!0,autocomplete:"off"},model:{value:t.userData["Linkedin"],callback:function(e){t.$set(t.userData,"Linkedin",e)},expression:"userData['Linkedin']"}}),i("InsInputWrap",{attrs:{id:"userInstagramField",name:"userInstagramField",maxlength:"50",placeholder:"https://instagram.com/",label:"Instagram Profile Link",field:"url",validate:!0,autocomplete:"off"},model:{value:t.userData["Instagram"],callback:function(e){t.$set(t.userData,"Instagram",e)},expression:"userData['Instagram']"}})],1),i("div",{staticClass:"large-4 medium-6 small-12 cell"},[i("InsTextareaWrap",{attrs:{id:"userNoteField",name:"userNoteField",placeholder:"Notes",label:"Notes",autocomplete:"off",maxlength:"255"},model:{value:t.userData["Notes"],callback:function(e){t.$set(t.userData,"Notes",e)},expression:"userData['Notes']"}})],1)]),i("div",{staticClass:"grid-x grid-padding-x spacer-top-m"},[i("div",{staticClass:"large-12 small-12 cell"},[i("h4",{staticClass:"ins-card-heading"},[t._v("Addresses")]),i("p",[t._v("Home Address")]),i("AddressFields",{attrs:{field:"Home",rawData:t.HomeAddressData},on:{addressFieldChanged:t.addressFieldChangedHandler}})],1)]),i("div",{staticClass:"grid-x grid-padding-x spacer-top-m"},[i("div",{staticClass:"large-12 small-12 cell"},[i("p",[t._v("Work Address")]),i("AddressFields",{attrs:{field:"Work",rawData:t.WorkAddressData},on:{addressFieldChanged:t.addressFieldChangedHandler}})],1)]),i("div",{ref:"shippingAddress-1",staticClass:"grid-x grid-padding-x spacer-top-m",attrs:{id:"shippingAddress-1"}},[i("div",{staticClass:"large-12 small-12 cell"},[i("p",[t._v("Shipping Address 1 ")]),i("AddressFields",{attrs:{field:"Shipping1",rawData:t.Shipping1AddressData},on:{addressFieldChanged:t.addressFieldChangedHandler}})],1)]),i("div",{ref:"shippingAddress-2",staticClass:"grid-x grid-padding-x spacer-top-m",attrs:{id:"shippingAddress-2"}},[i("div",{staticClass:"large-12 small-12 cell"},[i("p",[t._v("Shipping Address 2")]),i("AddressFields",{attrs:{field:"Shipping2",rawData:t.Shipping2AddressData},on:{addressFieldChanged:t.addressFieldChangedHandler}})],1)]),i("div",{ref:"shippingAddress-3",staticClass:"grid-x grid-padding-x spacer-top-m",attrs:{id:"shippingAddress-3"}},[i("div",{staticClass:"large-12 small-12 cell"},[i("p",[t._v("Shipping Address 3")]),i("AddressFields",{attrs:{field:"Shipping3",rawData:t.Shipping3AddressData},on:{addressFieldChanged:t.addressFieldChangedHandler}})],1)]),i("div",{ref:"poAddress",staticClass:"grid-x grid-padding-x spacer-top-m",attrs:{id:"poAddress"}},[i("div",{staticClass:"large-12 small-12 cell"},[i("p",[t._v("PO Address")]),i("AddressFields",{attrs:{field:"PO",rawData:t.POAddressData},on:{addressFieldChanged:t.addressFieldChangedHandler}})],1)]),i("div",{ref:"billingAddress",staticClass:"grid-x grid-padding-x spacer-top-m",attrs:{id:"billingAddress"}},[i("div",{staticClass:"large-12 small-12 cell"},[i("p",[t._v("Billing Address")]),i("AddressFields",{attrs:{field:"Billing",rawData:t.BillingAddressData},on:{addressFieldChanged:t.addressFieldChangedHandler}})],1)])]),i("div",{staticClass:"spacer"}),i("div",{staticClass:"grid-x grid-margin-x"},["edit"==t.formType?i("div",{staticClass:"large-4 medium-5 small-12 cell footer-btn-container small-order-2 medium-order-1"},[i("ins-button",{attrs:{label:"ARCHIVE CONTACT",color:"negative",type:"button"},on:{onClickInsButton:t.archiveContact}})],1):t._e(),i("div",{class:("edit"===t.formType?"large-8  medium-7":"large-12 medium-12")+" small-12 cell text-right footer-btn-container small-order-1 medium-order-2"},[i("ins-button",{attrs:{type:"button",label:"Cancel",outlined:"",disabled:t.submittingForm},on:{onClickInsButton:t.backToList}}),i("ins-button",{attrs:{type:"button",solid:"",label:t.buttonLabel,disabled:t.submittingForm},on:{onClickInsButton:t.fetchContactList}}),"add"==t.formType?i("ins-button",{attrs:{type:"button",label:"Save and Create Another",solid:"",disabled:t.submittingForm},on:{onClickInsButton:t.saveAddMore}}):t._e()],1)])],1):t._e()])])])])},re=[],oe=(i("34ef"),i("6b54"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ins-select",{attrs:{label:t.label,value:t.value,placeholder:t.placeholder,disabled:t.disabled,readonly:t.readonly,button:t.button,small:t.small,searchable:t.searchable,multiple:t.multiple,"with-dynamic-option":t.withDynamicOption,"dynamic-placeholder":t.dynamicPlaceholder},on:{onSubmitOption:t.onSubmitOptionHandler,valueChange:t.onValueChange}},[t._t("default")],2)}),le=[],ce={name:"InsSelectWrap",props:{label:String,value:String,placeholder:String,dynamicPlaceholder:String,disabled:Boolean,readonly:Boolean,button:Boolean,small:Boolean,searchable:Boolean,multiple:Boolean,withDynamicOption:Boolean},methods:{onValueChange:function(t){var e=this;e.$emit("input",t.detail)},onSubmitOptionHandler:function(t){this.$emit("onSubmitOption",t.detail)}}},de=ce,ue=Object(P["a"])(de,oe,le,!1,null,null,null),he=ue.exports,me=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ins-image-picker",{attrs:{"img-type":t.imgType,label:t.label,"button-color":t.buttonColor,value:t.value,"upload-img-container":t.uploadImgContainer,"upload-img-rec-width":t.uploadImgRecWidth,"upload-img-rec-height":t.uploadImgRecHeight,"upload-img-rec-file-size":t.uploadImgRecFileSize},on:{valueChange:t.onValueChange}})},pe=[],fe={name:"InsImagePickerWrap",props:{imgType:String,buttonColor:String,value:String,label:String,uploadImgContainer:String,uploadImgRecWidth:"",uploadImgRecHeight:"",uploadImgRecFileSize:""},methods:{onValueChange:function(t){var e=this;e.$emit("input",t.detail.base64),e.$emit("fileNameChanged",t.detail.filename)}}},_e=fe,ge=Object(P["a"])(_e,me,pe,!1,null,null,null),be=ge.exports,ve=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ins-textarea",{attrs:{label:t.label,value:t.value,placeholder:t.placeholder,name:t.name,disabled:t.disabled,readonly:t.readonly,required:t.required,maxlength:t.maxlength,"error-message":t.errorMessage,"has-error":t.hasError},on:{valueChange:t.onValueChange}})},ye=[],Ce={name:"InsTextareaWrap",props:{label:String,value:String,placeholder:String,name:String,errorMessage:String,maxlength:String,hasError:Boolean,disabled:Boolean,readonly:Boolean,required:String},methods:{onValueChange:function(t){this.$emit("input",t.detail)}}},De=Ce,ke=Object(P["a"])(De,ve,ye,!1,null,null,null),Te=ke.exports,we=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"address-wrap grid-x grid-padding-x"},[i("div",{staticClass:"large-4 medium-6 small-12 cell"},[i("InsInputWrap",{ref:"searchAddressField",attrs:{name:"searchAddress",label:"Search Address",field:"text",placeholder:""!==t.googleMapsApiKey?"Search Address":"No Google API Key",disabled:""===t.googleMapsApiKey,autocomplete:"off"},model:{value:t.searchAddress,callback:function(e){t.searchAddress=e},expression:"searchAddress"}}),i("div",{staticClass:"grid-x grid-padding-x"},[i("InsInputWrap",{staticClass:"large-5 medium-5 small-5 cell",attrs:{id:"usersearchStreetField",name:"usersearchStreetField",maxlength:"50",placeholder:"Address 1",label:"Address 1",field:"text",autocomplete:"off"},on:{input:t.bindValue},model:{value:t.mapData["street"],callback:function(e){t.$set(t.mapData,"street",e)},expression:"mapData['street']"}}),i("InsInputWrap",{staticClass:"large-7 medium-7 small-7 cell",attrs:{id:"usersearchAddressField",name:"usersearchAddressField",maxlength:"50",placeholder:"Address 2",label:"Address 2",field:"text",autocomplete:"off"},on:{input:t.bindValue},model:{value:t.mapData["address"],callback:function(e){t.$set(t.mapData,"address",e)},expression:"mapData['address']"}})],1)],1),i("div",{staticClass:"large-4 medium-6 small-12 cell"},[i("InsInputWrap",{attrs:{id:"usersearchCityField",name:"usersearchCityField",maxlength:"50",placeholder:"City",label:"City",field:"text",autocomplete:"off"},on:{input:t.bindValue},model:{value:t.mapData["city"],callback:function(e){t.$set(t.mapData,"city",e)},expression:"mapData['city']"}}),i("InsInputWrap",{attrs:{id:"usersearchStateField",name:"usersearchStateField",maxlength:"50",placeholder:"State",label:"State",field:"text",autocomplete:"off"},on:{input:t.bindValue},model:{value:t.mapData["state"],callback:function(e){t.$set(t.mapData,"state",e)},expression:"mapData['state']"}})],1),i("div",{staticClass:"large-4 medium-6 small-12 cell"},[i("InsInputWrap",{staticClass:"large-5 medium-5 small-5 cell",attrs:{id:"usersearchAreaCodeField",name:"usersearchAreaCodeField",maxlength:"50",placeholder:"Post Code",label:"Post Code",field:"text",autocomplete:"off"},on:{input:t.bindValue},model:{value:t.mapData["postcode"],callback:function(e){t.$set(t.mapData,"postcode",e)},expression:"mapData['postcode']"}}),i("InsInputWrap",{staticClass:"large-5 medium-5 small-5 cell",attrs:{id:"usersearchCountryField",name:"usersearchCountryField",maxlength:"50",placeholder:"Country",label:"Country",field:"text",autocomplete:"off"},on:{input:t.bindValue},model:{value:t.mapData["country"],callback:function(e){t.$set(t.mapData,"country",e)},expression:"mapData['country']"}})],1)])},Ee=[],$e={name:"AddressFields",components:{InsInputWrap:At,InsSelectWrap:he},data:function(){return{googleMapsApiKey:"",searchAddressField:void 0,searchAddress:"",mapData:{street:"",address:"",city:"",state:"",postcode:"",country:""}}},props:{field:String,rawData:Object},methods:{bindValue:function(){this.$emit("addressFieldChanged",{mapData:this.mapData,field:this.field})},initGoogleMap:function(){var t=this;this.googleMapsApiKey=localStorage.getItem("google_maps_api_key")?JSON.parse(localStorage.getItem("google_maps_api_key")).results[0].value:"",setTimeout(function(){""!==t.googleMapsApiKey&&(t.searchAddressField=new google.maps.places.Autocomplete(t.$refs.searchAddressField.$el.querySelector("input")),t.searchAddressField.addListener("place_changed",t.fillAddress))},700)},fillAddress:function(){var t=this,e=this.searchAddressField.getPlace();this.searchAddress=e.formatted_address,this.mapData["street"]="",this.mapData["address"]="",this.mapData["city"]="",this.mapData["state"]="",this.mapData["country"]="",this.mapData["postcode"]="",e.address_components.forEach(function(e){var i=e.types[0];switch(i){case"street_number":t.mapData["address"]=e["short_name"]+" ";break;case"route":t.mapData["address"]+=e["long_name"];break;case"locality":t.mapData["city"]=e["long_name"];break;case"colloquial_area":t.mapData["city"]=e["long_name"];break;case"administrative_area_level_1":t.mapData["state"]=e["short_name"];break;case"country":t.mapData["country"]=e["long_name"];break;case"postal_code":t.mapData["postcode"]=e["short_name"];break}}),this.bindValue()}},created:function(){this.initGoogleMap(),this.rawData&&(this.mapData=this.rawData)}},xe=$e,Ae=(i("860f"),Object(P["a"])(xe,we,Ee,!1,null,null,null)),Re=Ae.exports,Se={data:function(){return{s3Data:"",s3FormData:"",parsedS3FormData:"",s3Image:"",s3UploadURL:"",s3AssetURL:"",s3FileName:"",s3Type:"image"}},methods:{setS3FormData:function(t){var e={key:t.key,success_action_status:t.success_action_status,acl:t.acl,policy:t.policy,"x-amz-credential":t["x-amz-credential"],"x-amz-algorithm":t["x-amz-algorithm"],"x-amz-date":t["x-amz-date"],"x-amz-signature":t["x-amz-signature"],"x-amz-meta-versions":"{}"};return t["Content-Disposition"]&&(e["Content-Disposition"]=t["Content-Disposition"]),e},getS3Credentials:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,$.ajax({type:"get",url:e}).done(function(t){return t}).error(function(t){return console.error("Error getting POS S3 credentials.",t),!1});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getS3AssetURL:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e,i,s,a,n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.s3Image=s,this.s3FileName=a,this.s3Type=n||"image",t.next=5,this.getS3Credentials(e);case 5:return this.s3Data=t.sent,t.next=8,this.buildS3FormData(i);case 8:return t.abrupt("return",this.s3AssetURL);case 9:case"end":return t.stop()}},t,this)}));function e(e,i,s,a,n){return t.apply(this,arguments)}return e}(),buildS3FormData:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=this.s3Data[e][this.s3Type].s3_upload.form_data,this.s3UploadURL=this.s3Data[e][this.s3Type].s3_upload.direct_upload_url,t.next=4,this.getImage(i);case 4:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getImage:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=this.s3Image?this.s3Image:"",this.s3FormData=this.setS3FormData(e),this.parsedS3FormData=this.parseToFormData(this.s3FormData),this.appendImagetoS3FormData(i),t.next=6,this.s3SubmitForm(this.parsedS3FormData);case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),appendImagetoS3FormData:function(t){if(""!==t||void 0!==t){var e=t.split(",")[1],i=t.split(";")[0].split("/");if(i){var s=this.base64ToBlob(e,"image/"+i[1]);this.parsedS3FormData.append("file",s,this.s3FileName)}}},base64ToBlob:function(t,e){e=e||"";for(var i=1024,s=window.atob(t),a=[],n=0,r=s.length;n<r;n+=i){for(var o=s.slice(n,n+i),l=new Array(o.length),c=0;c<o.length;c++)l[c]=o.charCodeAt(c);var d=new Uint8Array(l);a.push(d)}return new Blob(a,{type:e})},parseToFormData:function(t){var e=new FormData;return Object(te["each"])(t,function(t,i){e.append(i,t)}),e},s3SubmitForm:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=this,t.next=3,$.ajax({type:"post",url:i.s3UploadURL,contentType:!1,processData:!1,data:e}).done(function(t){var e=$(t),s=e.find("Location").text();i.s3AssetURL=s}).error(function(t){console.error("Error uploading file to S3.",t)});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()}},Ie={name:"EditCRMDetails",mixins:[m,Se],components:{InsInputWrap:At,InsTextareaWrap:Te,InsSelectWrap:he,InsImagePickerWrap:be,AddressFields:Re},data:function(){return{submittingForm:!1,showForm:!1,formData:{},userData:{},HomeAddressData:{},WorkAddressData:{},Shipping1AddressData:{},Shipping2AddressData:{},Shipping3AddressData:{},POAddressData:{},BillingAddressData:{},oldContactType:"",countShippingAddress:0,addShippingAddress:!0,formMethod:"",formName:"",fromURL:"/api/users",authToken:"",emailErrorMessage:"Invalid email address.",userCountryCode:"au",buttonLabel:"Save",addMore:!1,toastMsg:"",toastOpt:{closeHtml:'<button><i class="icon-close-1"></i></button>',closeButton:!0,timeOut:0,extendedTimeOut:0},sourceProfile:"/insites/api/get-current-user-data.json",workAreaCodeValue:"",workPhoneNumValue:"",mobileAreaCodeValue:"",mobilePhoneNumValue:"",homeAreaCodeValue:"",homePhoneNumValue:"",headers:{},formModel:{form_configuration_name:"modules/insites_core/insites_crm_delete_customer",form:{profiles_attributes:{"modules/insites_core/insites_customer_attributes":{properties_attributes:{is_enabled:"false"}}}}},s3FormCredentialURL:"/insites/api/s3-contact-form.json",storeSettingsData:{},s3IconChange:!1,s3IconImage:"",s3IconURL:"",parsedS3FormData:""}},computed:Object(Ct["b"])({userProfile:function(t){return t.CrmStore.userProfile},formType:function(t){return t.CrmStore.formType},contactTypes:function(t){return t.SystemFieldsStore.contact_type},swalContactTypes:function(t){return t.SystemFieldsStore.swalContactTypes},companyOptions:function(t){return t.CrmStore.companyOptions},mutatingCompanies:function(t){return t.CrmStore.mutatingCompanies},googleMapsApiKey:function(t){return t.SystemFieldsStore.google_maps_api_key}}),methods:{addressFieldChangedHandler:function(t){for(var e in t.mapData){var i=e.replace("search","");this.userData["".concat(t.field).concat(i)]=t.mapData[e]}},onSubmitOptionHandler:function(t){var e={form_configuration_name:"modules/insites_core/insites_add_new_company",parent_resource_id:"modules/insites_core/insites_company",form:{properties:{company_name:t,is_enabled:"true"}}};this.addCompanyOption(e)},showShippingAddress:function(){this.countShippingAddress<3&&this.countShippingAddress>=0?this.countShippingAddress++:this.addShippingAddress=!1;var t="shippingAddress-".concat(this.countShippingAddress);this.$refs[t].classList.remove("hide"),3==this.countShippingAddress&&(this.addShippingAddress=!1)},addCompanyOption:function(t){var e=this;this.submittingForm=!0;var i=z()(t),s="/api/customizations";this.$http.post(s,i,{headers:this.headers}).then(function(i){var s=i.data.id.toString();e.$store.commit("pushCompanyOption",{id:s,label:t.form.properties.company_name}),e.userData["company_id"]=s,e.submittingForm=!1,toastIt("success","Successfully created company.",e.ops)}).catch(function(t){console.error("error",t),e.submittingForm=!1,toastIt("error","Failed to add company.",e.ops)})},getFilename:function(t){this.profilePictureName=t,this.s3IconChange=!0},base64ToBlob:function(t,e){e=e||"";for(var i=1024,s=window.atob(t),a=[],n=0,r=s.length;n<r;n+=i){for(var o=s.slice(n,n+i),l=new Array(o.length),c=0;c<o.length;c++)l[c]=o.charCodeAt(c);var d=new Uint8Array(l);a.push(d)}return new Blob(a,{type:e})},appendToFormData:function(t){var e=new FormData;return Object(te["each"])(t,function(t,i){e.append(i,t)}),e},backToList:function(){InsitesUtil.goBack()},saveAddMore:function(){this.addMore=!0,this.fetchContactList()},attachFile:function(){this.$refs.profilePic.click()},buildFormData:function(t){var e=this.$refs.mobilePhone.getCountryData();e=e.dialCode;var i=this.$refs.homePhone.getCountryData();i=i.dialCode;var s=this.$refs.workPhone.getCountryData();s=s.dialCode;var a=(Object(te["isEmpty"])(this.userData["First Name"])?"":this.userData["First Name"])+(Object(te["isEmpty"])(this.userData["Last Name"])?"":" "+this.userData["Last Name"]);this.formData={authenticity_token:this.authToken,form_configuration_name:this.formName,"form[email]":Object(te["isEmpty"])(this.userData["Email"])?"":this.userData["Email"],"form[first_name]":Object(te["isEmpty"])(this.userData["First Name"])?"":this.userData["First Name"],"form[last_name]":Object(te["isEmpty"])(this.userData["Last Name"])?"":this.userData["Last Name"],"form[name]":"".concat(a),"form[profiles_attributes][modules/insites_core/insites_customer_attributes][properties_attributes][company_id]":Object(te["isEmpty"])(this.userData["company_id"])?"":this.userData["company_id"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][properties_attributes][contact_type]":Object(te["isEmpty"])(this.userData["Contact Type"])?"":this.userData["Contact Type"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][properties_attributes][notes]":Object(te["isEmpty"])(this.userData["Notes"])?"":this.userData["Notes"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][properties_attributes][is_enabled]":"true","form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][home_address_attributes][street]":Object(te["isEmpty"])(this.userData["Homestreet"])?"":this.userData["Homestreet"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][home_address_attributes][address]":Object(te["isEmpty"])(this.userData["Homeaddress"])?"":this.userData["Homeaddress"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][home_address_attributes][city]":Object(te["isEmpty"])(this.userData["Homecity"])?"":this.userData["Homecity"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][home_address_attributes][state]":Object(te["isEmpty"])(this.userData["Homestate"])?"":this.userData["Homestate"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][home_address_attributes][postcode]":Object(te["isEmpty"])(this.userData["Homepostcode"])?"":this.userData["Homepostcode"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][home_address_attributes][country]":Object(te["isEmpty"])(this.userData["Homecountry"])?"":this.userData["Homecountry"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][work_address_attributes][street]":Object(te["isEmpty"])(this.userData["Workstreet"])?"":this.userData["Workstreet"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][work_address_attributes][address]":Object(te["isEmpty"])(this.userData["Workaddress"])?"":this.userData["Workaddress"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][work_address_attributes][city]":Object(te["isEmpty"])(this.userData["Workcity"])?"":this.userData["Workcity"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][work_address_attributes][state]":Object(te["isEmpty"])(this.userData["Workstate"])?"":this.userData["Workstate"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][work_address_attributes][postcode]":Object(te["isEmpty"])(this.userData["Workpostcode"])?"":this.userData["Workpostcode"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][work_address_attributes][country]":Object(te["isEmpty"])(this.userData["Workcountry"])?"":this.userData["Workcountry"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_1_attributes][street]":Object(te["isEmpty"])(this.userData["Shipping1street"])?"":this.userData["Shipping1street"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_1_attributes][address]":Object(te["isEmpty"])(this.userData["Shipping1address"])?"":this.userData["Shipping1address"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_1_attributes][city]":Object(te["isEmpty"])(this.userData["Shipping1city"])?"":this.userData["Shipping1city"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_1_attributes][state]":Object(te["isEmpty"])(this.userData["Shipping1state"])?"":this.userData["Shipping1state"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_1_attributes][postcode]":Object(te["isEmpty"])(this.userData["Shipping1postcode"])?"":this.userData["Shipping1postcode"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_1_attributes][country]":Object(te["isEmpty"])(this.userData["Shipping1country"])?"":this.userData["Shipping1country"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_2_attributes][street]":Object(te["isEmpty"])(this.userData["Shipping2street"])?"":this.userData["Shipping2street"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_2_attributes][address]":Object(te["isEmpty"])(this.userData["Shipping2address"])?"":this.userData["Shipping2address"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_2_attributes][city]":Object(te["isEmpty"])(this.userData["Shipping2city"])?"":this.userData["Shipping2city"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_2_attributes][state]":Object(te["isEmpty"])(this.userData["Shipping2state"])?"":this.userData["Shipping2state"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_2_attributes][postcode]":Object(te["isEmpty"])(this.userData["Shipping2postcode"])?"":this.userData["Shipping2postcode"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_2_attributes][country]":Object(te["isEmpty"])(this.userData["Shipping2country"])?"":this.userData["Shipping2country"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_3_attributes][street]":Object(te["isEmpty"])(this.userData["Shipping3street"])?"":this.userData["Shipping3street"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_3_attributes][address]":Object(te["isEmpty"])(this.userData["Shipping3address"])?"":this.userData["Shipping3address"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_3_attributes][city]":Object(te["isEmpty"])(this.userData["Shipping3city"])?"":this.userData["Shipping3city"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_3_attributes][state]":Object(te["isEmpty"])(this.userData["Shipping3state"])?"":this.userData["Shipping3state"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_3_attributes][postcode]":Object(te["isEmpty"])(this.userData["Shipping3postcode"])?"":this.userData["Shipping3postcode"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][shipping_address_3_attributes][country]":Object(te["isEmpty"])(this.userData["Shipping3country"])?"":this.userData["Shipping3country"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][po_address_attributes][street]":Object(te["isEmpty"])(this.userData["POstreet"])?"":this.userData["POstreet"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][po_address_attributes][address]":Object(te["isEmpty"])(this.userData["POaddress"])?"":this.userData["POaddress"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][po_address_attributes][city]":Object(te["isEmpty"])(this.userData["POcity"])?"":this.userData["POcity"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][po_address_attributes][state]":Object(te["isEmpty"])(this.userData["POstate"])?"":this.userData["POstate"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][po_address_attributes][postcode]":Object(te["isEmpty"])(this.userData["POpostcode"])?"":this.userData["POpostcode"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][po_address_attributes][country]":Object(te["isEmpty"])(this.userData["POcountry"])?"":this.userData["POcountry"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][billing_address_attributes][street]":Object(te["isEmpty"])(this.userData["Billingstreet"])?"":this.userData["Billingstreet"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][billing_address_attributes][address]":Object(te["isEmpty"])(this.userData["Billingaddress"])?"":this.userData["Billingaddress"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][billing_address_attributes][city]":Object(te["isEmpty"])(this.userData["Billingcity"])?"":this.userData["Billingcity"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][billing_address_attributes][state]":Object(te["isEmpty"])(this.userData["Billingstate"])?"":this.userData["Billinsstate"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][billing_address_attributes][postcode]":Object(te["isEmpty"])(this.userData["Billingpostcode"])?"":this.userData["Billingpostcode"],"form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_addresses_attributes][billing_address_attributes][country]":Object(te["isEmpty"])(this.userData["Billingcountry"])?"":this.userData["Billingcountry"],"form[profiles_attributes][modules/insites_core/insites_contact_number_attributes][properties_attributes][mobile_phone_country_code]":e,"form[profiles_attributes][modules/insites_core/insites_contact_number_attributes][properties_attributes][mobile_phone_area_code]":document.getElementsByName("userDataMobileAreaCode")[0].value,"form[profiles_attributes][modules/insites_core/insites_contact_number_attributes][properties_attributes][mobile_phone_number]":document.getElementsByName("userDataMobilePhoneNumber")[0].value,"form[profiles_attributes][modules/insites_core/insites_contact_number_attributes][properties_attributes][home_phone_country_code]":i,"form[profiles_attributes][modules/insites_core/insites_contact_number_attributes][properties_attributes][home_phone_area_code]":document.getElementsByName("userDataHomeAreaCode")[0].value,"form[profiles_attributes][modules/insites_core/insites_contact_number_attributes][properties_attributes][home_phone_number]":document.getElementsByName("userDataHomePhoneNumber")[0].value,"form[profiles_attributes][modules/insites_core/insites_contact_number_attributes][properties_attributes][work_phone_country_code]":s,"form[profiles_attributes][modules/insites_core/insites_contact_number_attributes][properties_attributes][work_phone_area_code]":document.getElementsByName("userDataWorkAreaCode")[0].value,"form[profiles_attributes][modules/insites_core/insites_contact_number_attributes][properties_attributes][work_phone_number]":document.getElementsByName("userDataWorkPhoneNumber")[0].value,"form[profiles_attributes][modules/insites_core/insites_social_links_attributes][properties_attributes][facebook_link]":Object(te["isEmpty"])(this.userData["Facebook"])?"":this.userData["Facebook"],"form[profiles_attributes][modules/insites_core/insites_social_links_attributes][properties_attributes][twitter_link]":Object(te["isEmpty"])(this.userData["Twitter"])?"":this.userData["Twitter"],"form[profiles_attributes][modules/insites_core/insites_social_links_attributes][properties_attributes][youtube_link]":Object(te["isEmpty"])(this.userData["Youtube"])?"":this.userData["Youtube"],"form[profiles_attributes][modules/insites_core/insites_social_links_attributes][properties_attributes][linkedin_link]":Object(te["isEmpty"])(this.userData["Linkedin"])?"":this.userData["Linkedin"],"form[profiles_attributes][modules/insites_core/insites_social_links_attributes][properties_attributes][instagram_link]":Object(te["isEmpty"])(this.userData["Instagram"])?"":this.userData["Instagram"]}},bindValues:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.submittingForm=!0,this.toastMsg="Contact",e=document.getElementById("crmForm"),"add"===this.formType&&(this.formURL="/api/users"),!InsitesUtil.formValidate(yt()($(e).find(".ins-form-field, .ins-select-value-input, .ins-textarea-field")))){t.next=16;break}if(this.buildFormData(e),this.parsedFormData=this.appendToFormData(this.formData),!this.s3IconChange){t.next=13;break}return t.next=10,this.getS3AssetURL(this.s3FormCredentialURL,"profile_image",this.s3IconImage,this.profilePictureName);case 10:this.s3IconImage=t.sent,this.parsedFormData.append("form[profiles_attributes][modules/insites_core/insites_customer_attributes][custom_images_attributes][profile_image_attributes][image]",this.s3IconImage),this.s3IconChange=!1;case 13:this.submitForm(this.parsedFormData),t.next=18;break;case 16:this.addMore=!1,this.submittingForm=!1;case 18:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),submitForm:function(t){var e=this,i={type:this.formMethod,contentType:!1,processData:!1,data:t,success:function(t){e.successHandler()},error:function(t){e.errorHandler(t)}};$.ajax(this.formURL,i)},checkIfContact:function(){var t=this,e="/insites/api/get-customer-profile-data.json?email=".concat(this.userData["Email"]);return this.$http.get(e).then(function(t){var e=t.data.items;if(e){var i=e.results[0].customer_details;return!!i&&(i.is_enabled&&"true"===i.is_enabled?"enabled":"disabled")}return!1}).catch(function(e){t.addMore=!1,t.submittingForm=!1,toastIt("error","Failed to add contact. Please try again.",t.ops)})},setAsContact:function(){var t=this,e="/insites/api/set-as-contact?email=".concat(this.userData["Email"]);this.$http.get(e).then(function(e){t.successHandler()}).catch(function(e){t.addMore=!1,t.submittingForm=!1,toastIt("error","Failed to add contact. Please try again.",t.ops)})},successHandler:function(){toastIt("success","".concat(this.toastMsg," has been ").concat("add"===this.formType?"created":"updated","."),this.ops),"add"===this.formType?(document.getElementById("crmForm").reset(),this.userData["First Name"]="",this.userData["Last Name"]="",this.userData["Email"]="",this.s3IconImage=""):"edit"===this.formType&&this.$store.commit("setContactData",this.userData),!this.addMore&&InsitesUtil.goBack(),this.addMore=!1,this.submittingForm=!1},errorHandler:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){var i,s,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(i="",s=this,console.log("error",e),!e.responseJSON){t.next=19;break}if(!e.responseJSON.errors){t.next=17;break}if(!("undefined"!==e.responseJSON.errors.email&&null!==e.responseJSON.errors.email&&"email"in e.responseJSON.errors)){t.next=17;break}if("has already been taken"!=e.responseJSON.errors.email[0].toLowerCase()){t.next=13;break}return t.next=9,s.checkIfContact();case 9:a=t.sent,"enabled"===a?(this.addMore=!1,this.submittingForm=!1,toastIt("error","Contact already exist.",this.ops)):"disabled"===a?this.warnUser("This contact is archived, do you want to restore them?"):this.warnUser("Email already exist, do you want to add them as contact?"),t.next=17;break;case 13:i+=e.responseJSON.errors.email?"Email "+e.responseJSON.errors.email[0]+"<br />":"",this.addMore=!1,this.submittingForm=!1,toastIt("error",i,this.ops);case 17:t.next=22;break;case 19:this.addMore=!1,this.submittingForm=!1,toastIt("error","Opps something went wrong. Please try again.",this.ops);case 22:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),userExistsError:function(t){var e=this;swal({title:"",html:'\n          <ins-loader\n              state-icon="error"\n              icon-color="error"\n              state-message="'.concat(t,'">\n          </ins-loader>'),type:"",width:330,showCancelButton:!1}).then(function(t){t.value&&(e.bindingValues=!1,e.addMore=!1,e.submittingForm=!1)})},warnUser:function(t){var e=this;swal({title:"",html:'\n          <ins-loader\n              state-icon="warning"\n              icon-color="warning"\n              state-message="'.concat(t,' This will use their existing data.">\n          </ins-loader>'),type:"",width:330,showCancelButton:!0,confirmButtonText:"Yes"}).then(function(t){t.value?e.setAsContact():t.dismiss&&(e.bindingValues=!1,e.addMore=!1,e.submittingForm=!1)})},setAddressValue:function(){var t=this;setTimeout(function(){var e=["HomeAddressData","WorkAddressData","Shipping1AddressData","Shipping2AddressData","Shipping3AddressData","POAddressData","BillingAddressData"];e.forEach(function(e){if(!Object(te["isEmpty"])(t[e])){var i=e.replace("AddressData","");t.userData["".concat(i,"street")]=t[e].street,t.userData["".concat(i,"address")]=t[e].address,t.userData["".concat(i,"city")]=t[e].city,t.userData["".concat(i,"state")]=t[e].state,t.userData["".concat(i,"country")]=t[e].country,t.userData["".concat(i,"postcode")]=t[e].postcode}})})},setPhoneValue:function(){var t=this;setTimeout(function(){$("#homePhone .phone").intlTelInput("setNumber","+"+t.userData["Home Phone Country Code"]),t.homeAreaCodeValue=t.userData["Home Phone Area Code"],t.homePhoneNumValue=t.userData["Home Phone Number"],$("#mobilePhone .phone").intlTelInput("setNumber","+"+t.userData["Mobile Phone Country Code"]),t.mobileAreaCodeValue=t.userData["Mobile Phone Area Code"],t.mobilePhoneNumValue=t.userData["Mobile Phone Number"],$("#workPhone .phone").intlTelInput("setNumber","+"+t.userData["Work Phone Country Code"]),t.workAreaCodeValue=t.userData["Work Phone Area Code"],t.workPhoneNumValue=t.userData["Work Phone Number"]},300)},validateInput:function(t){return t=t.target?t.target:t,""===t.value.trim()||null===t.value?(this.invalidFieldNotif(t),1):(this.validFieldNotif(t),0)},blurValidateInput:function(t){return""===t.value.trim()||null===t.value?(this.invalidFieldNotif(t),1):(this.validFieldNotif(t),0)},invalidFieldNotif:function(t){t.closest("ins-input").setAttribute("has-error",!0)},validFieldNotif:function(t){t.closest("ins-input").removeAttribute("has-error")},validateEmail:function(t){t=t.target?t.target:t;var e=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return""===t.value?(this.emailErrorMessage="Email address is required.",1):1==e.test(String(t.value).toLowerCase())?(this.validFieldNotif(t),0):(this.emailErrorMessage="Invalid email address.",this.invalidFieldNotif(t),1)},fetchCompanyData:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e="/insites/api/get-all-company-list-data.json?size=1000&page=1",t.next=3,this.$http.get(e).then(this.companyResponseHandler).catch(this.companyErrorHandler);case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),companyResponseHandler:function(t){t.data.items.results.length?this.$store.commit("setCompanyOptions",t.data.items.results):this.companyErrorHandler()},companyErrorHandler:function(t){console.log("error",t),toastIt("error","Failed to get company list. Please try again",InsitesUtil.opt())},updateUserData:function(t){this.s3IconImage=t.customer_details&&t.customer_details.profile_image?t.customer_details.profile_image.original:"",this.userData={id:t.id,"Contact Type":t.customer_details.contact_type,company_id:t.customer_details.company_id,"First Name":null!==t.first_name||""!==t.first_name?t.first_name:"","Last Name":null!==t.last_name||""!==t.last_name?t.last_name:"",Name:"".concat(t.first_name?t.first_name:""," ").concat(t.last_name?t.last_name:""),Email:null!==t.email||""!==t.email?t.email:"",Phone:Object(te["isEmpty"])(t.contact_number)?"":this.constructPhoneNumber("mobile",t.contact_number),"Mobile Phone Country Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.mobile_phone_country_code),"Mobile Phone Area Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.mobile_phone_area_code),"Mobile Phone Number":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.mobile_phone_number),"Home Phone":Object(te["isEmpty"])(t.contact_number)?"":this.constructPhoneNumber("home",t.contact_number),"Home Phone Country Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.home_phone_country_code),"Home Phone Area Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.home_phone_area_code),"Home Phone Number":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.home_phone_number),"Work Phone":Object(te["isEmpty"])(t.contact_number)?"":this.constructPhoneNumber("work",t.contact_number),"Work Phone Country Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.work_phone_country_code),"Work Phone Area Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.work_phone_area_code),"Work Phone Number":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.work_phone_number),Facebook:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.facebook_link),Instagram:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.instagram_link),Twitter:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.twitter_link),Google:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.google_plus_link),Linkedin:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.linkedin_link),Youtube:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.youtube_link),Notes:this.checkValue(t.customer_details.notes)}},updateContactData:function(t){this.HomeAddressData=t.customer_details.home_address[0],this.WorkAddressData=t.customer_details.work_address[0],this.Shipping1AddressData=t.customer_details.shipping_address_1[0],this.Shipping2AddressData=t.customer_details.shipping_address_2[0],this.Shipping3AddressData=t.customer_details.shipping_address_3[0],this.POAddressData=t.customer_details.po_address[0],this.BillingAddressData=t.customer_details.billing_address[0]},setUserData:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.$store.state.CrmStore.userData["Email"]){t.next=6;break}this.userData=this.$store.state.CrmStore.userData,this.s3IconImage=this.$store.state.CrmStore.userData["Profile Image"],e=this.$store.state.CrmStore.userData.raw,t.next=18;break;case 6:return this.fetchCompanyData(),t.next=9,ot(this.checkURLParamsID());case 9:if(i=t.sent,i=i.results.items,!i.results.length){t.next=16;break}e=i.results[0],this.updateUserData(e),t.next=18;break;case 16:return this.toastInvalidIDNotification("contact"),t.abrupt("return",this.$router.push("/customers"));case 18:this.updateContactData(e);case 19:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),setFormSettings:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,i,s,a,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this,e=[],this.checkURLParamsID()?(this.$store.commit("pushFormType","edit"),e=[Nt,Ot,{label:"Edit Contact",link:"#".concat(this.$route.path)}],this.userData["id"]=this.checkURLParamsID()):(this.$store.commit("pushFormType","add"),e=[Nt,Ot,Ft]),"add"!==this.formType){t.next=12;break}this.buttonLabel="Save",this.formMethod="POST",this.formURL="/api/users",this.formName="modules/insites_core/insites_add_new_customer",this.userData={},this.$store.state.CrmStore.addFromCompany&&(this.userData.company_id=this.$store.state.CrmStore.addFromCompany),t.next=34;break;case 12:if("view"!==this.formType||!this.checkURLParamsID()){t.next=22;break}for(this.buttonLabel="Update",this.userData=this.$store.state.CrmStore.userData,this.formMethod,this.formURL,this.formName="",i=document.getElementById("crmForm"),s=i.elements,a=0,n=s.length;a<n;++a)s[a].readOnly=!0,s[a].disabled=!0;this.setPhoneValue(),t.next=34;break;case 22:if("edit"!==this.formType||!this.checkURLParamsID()){t.next=33;break}return t.next=25,this.setUserData();case 25:this.buttonLabel="Update",this.formMethod="PUT",this.formURL="/api/users/".concat(this.userData.id),this.formName="modules/insites_core/insites_crm_update_customer",this.setPhoneValue(),this.setAddressValue(),t.next=34;break;case 33:"remove"===this.formType?this.userData=this.$store.state.CrmStore.userData:InsitesUtil.goBack();case 34:InsitesUtil.setBreadCrumbs(e),this.formType&&(this.showForm=!0,this.oldContactType=this.userData["Contact Type"]);case 36:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),archiveContact:function(){var t=this;swal({title:"",html:'\n          <ins-loader\n            state-icon="warning"\n            icon-color="warning"\n            state-message="Are you sure you want to archive these items?">\n          </ins-loader>',type:"",width:330,showCancelButton:!0,confirmButtonText:"Archive"}).then(function(e){e.value&&t.deleteContact()})},deleteContact:function(){var t=this;this.submittingForm=!0;var e="/api/users/".concat(this.userData.id),i=z()(this.formModel);this.$http.put(e,i,{headers:this.headers}).then(function(e){toastIt("success","Contact has been archived.",t.ops)}).catch(function(t){InsitesUtil.goBack()}).catch(function(e){t.submittingForm=!1,toastIt("error","Failed to archive user. Please try again.",t.ops)})},setInsRendererLabel:function(){var t=this,e=document.querySelector("ins-renderer");e?"add"===this.formType?e.updateRouteLabel("Add Contact"):"edit"===this.formType&&e.updateRouteLabel("Edit Contact"):setTimeout(function(){t.setInsRendererLabel()},300)},fetchContactList:function(){if(this.submittingForm=!0,this.userData["company_id"]&&"Primary"===this.userData["Contact Type"]){var t="/insites/api/get-all-company-contact-list-data.json?id=".concat(this.userData["company_id"]);this.$http.get(t).then(this.responseHandler).catch(this.errorHandlerCompany)}else this.bindValues()},responseHandler:function(t){var e=t.data.items.results;e.length?this.checkPrimaryContact(e):this.bindValues()},errorHandlerCompany:function(t){console.error("error",t),this.addMore=!1,this.submittingForm=!1,toastIt("error","Failed to validate company for Primary Contact",this.ops)},checkPrimaryContact:function(t){var e=t.find(function(t){return"Primary"===t.customer_details.contact_type});e?this.oldContactType===this.userData["Contact Type"]?this.bindValues():this.primaryContactHandler(e):this.bindValues()},primaryContactHandler:function(t){var e=this,i="".concat(t.first_name," ").concat(t.last_name),s=this.getCompanyName(),a="<strong>".concat(i,"</strong> is set as the Primary Contact for <strong>").concat(s,"</strong>. Do you want to change this?");swal({title:"",html:a,type:"warning",showCancelButton:!0,width:330,confirmButtonText:"Yes"}).then(function(s){s.value?e.selectPrimaryType(i,t):(e.addMore=!1,e.submittingForm=!1)})},selectPrimaryType:function(t,e){var i=this,s="Please select a contact type for <strong>".concat(t,"</strong>");swal({title:"",html:s,width:330,input:"select",inputOptions:this.swalContactTypes,inputPlaceholder:"- Select -",allowOutsideClick:!1,allowEscapeKey:!1,showCancelButton:!0,confirmButtonText:"Update"}).then(function(t){t.value?i.updatePrimaryContact(e,t.value):(i.addMore=!1,i.submittingForm=!1)})},updatePrimaryContact:function(t,e){var i=this,s="/api/users/".concat(t.id),a={form_configuration_name:"modules/insites_core/insites_crm_update_customer",form:{profiles_attributes:{"modules/insites_core/insites_customer_attributes":{properties_attributes:{contact_type:e}}}}},n=z()(a);this.$http.put(s,n,{headers:this.headers}).then(function(t){toastIt("success","Successfully updated current primary contact.",i.ops),i.bindValues()}).catch(function(t){console.error("error",t),i.addMore=!1,i.submittingForm=!1,toastIt("error","Failed to update current primary contact.",i.ops)})},getCompanyName:function(){var t=this,e=this.companyOptions.find(function(e){return e.id===t.userData["company_id"]});return e.label}},mounted:function(){var t=this;this.headers=this.apiHeader(),setTimeout(function(){t.setFormSettings(),t.$store.state.CrmStore.userData["Home Phone Country Code"]=""===t.$store.state.CrmStore.userData["Home Phone Country Code"]?"61":t.$store.state.CrmStore.userData["Home Phone Country Code"],t.$store.state.CrmStore.userData["Mobile Phone Country Code"]=""===t.$store.state.CrmStore.userData["Mobile Phone Country Code"]?"61":t.$store.state.CrmStore.userData["Mobile Phone Country Code"],t.$store.state.CrmStore.userData["Work Phone Country Code"]=""===t.$store.state.CrmStore.userData["Work Phone Country Code"]?"61":t.$store.state.CrmStore.userData["Work Phone Country Code"]},500),this.setInsRendererLabel(),"localhost"!==window.location.hostname&&(this.authToken=JSON.parse(document.getElementById("formConfig").innerHTML))},beforeDestroy:function(){this.$store.commit("setAddFromCompany",!1)}},Ne=Ie,Pe=(i("06f4"),Object(P["a"])(Ne,ne,re,!1,null,null,null)),Oe=Pe.exports,Le=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"grid-container-full"},[i("div",{staticClass:"grid-x"},[i("div",{staticClass:"cell large-12 medium-12 small-12"},[t.showForm?i("form",{attrs:{id:"crmForm",action:"#","data-abide":"","data-live-validate":"true",novalidate:"",onsubmit:"event.preventDefault()",enctype:"multipart/form-data"}},[i("ins-card",{staticClass:"main-wrap",attrs:{steady:""}},[i("div",{staticClass:"grid-x grid-padding-x "},[i("div",{staticClass:"cell large-12 medium-12 small-12"},[i("h4",{staticClass:"ins-card-heading"},[t._v("Contact Details")]),i("InsImagePickerWrap",{attrs:{name:"form[custom_images_attributes][profile_images_attributes][image]",type:"picture","button-color":"blue",label:"ADD LOGO"},on:{fileNameChanged:t.getFilename},model:{value:t.s3IconImage,callback:function(e){t.s3IconImage=e},expression:"s3IconImage"}})],1)]),i("div",{staticClass:"grid-x grid-padding-x "},[i("div",{staticClass:"large-4 medium-6 small-12 cell"},[i("InsInputWrap",{attrs:{id:"userNameField",name:"form[properties_attributes][company_name]",placeholder:"Company Name",label:"Company Name*",field:"text",autocomplete:"off",required:"true",errorMessage:"Company Name is required."},nativeOn:{keyup:function(e){return t.validateInput(e)}},model:{value:t.userData["Company"],callback:function(e){t.$set(t.userData,"Company",e)},expression:"userData['Company']"}}),i("InsSelectWrap",{attrs:{id:"userAssignedToField",name:"form[properties_attributes][company_type]",label:"Company Type",placeholder:"- Select -",searchable:""},model:{value:t.userData["Company Type"],callback:function(e){t.$set(t.userData,"Company Type",e)},expression:"userData['Company Type']"}},[t.companyTypes.results.length?t._e():i("ins-select-option",{attrs:{label:"No company types yet.",value:"",disabled:""}}),t._l(t.companyTypes.results,function(t){return i("ins-select-option",{key:t.id,attrs:{label:t.value,value:t.id}})})],2)],1),i("div",{staticClass:"large-4 medium-6 small-12 cell"},[t.loadingCRMData?t._e():i("InsSelectWrap",{attrs:{id:"userAssignedToField",name:"form[properties_attributes][assigned_to]",label:"Assigned To",placeholder:"- Select -",searchable:""},model:{value:t.userData["Assigned To"],callback:function(e){t.$set(t.userData,"Assigned To",e)},expression:"userData['Assigned To']"}},[t.administratorList.results.length?t._e():i("ins-select-option",{attrs:{label:"No administrators yet.",value:"",disabled:""}}),t._l(t.administratorList.results,function(t){return i("ins-select-option",{key:t.id,attrs:{label:t.first_name+" "+t.last_name,value:t.id}})})],2),i("InsSelectWrap",{attrs:{id:"userAssignedToField",name:"form[properties_attributes][industry_type]",label:"Industry Type",placeholder:"- Select -",searchable:""},model:{value:t.userData["Industry Type"],callback:function(e){t.$set(t.userData,"Industry Type",e)},expression:"userData['Industry Type']"}},[t.industryTypes.results.length?t._e():i("ins-select-option",{attrs:{label:"No industry types yet.",value:"",disabled:""}}),t._l(t.industryTypes.results,function(t){return i("ins-select-option",{key:t.id,attrs:{label:t.value,value:t.id}})})],2)],1),i("div",{staticClass:"large-4 medium-6 small-12 cell"},[i("InsInputWrap",{ref:"userWebsite",attrs:{id:"userWebsite",name:"form[properties_attributes][website]",placeholder:"https://insites.io/",label:"Website",field:"url",validate:!0,autocomplete:"off"},model:{value:t.userData["Website"],callback:function(e){t.$set(t.userData,"Website",e)},expression:"userData['Website']"}}),i("ins-input-tel",{ref:"mobilePhone",attrs:{id:"mobilePhone",label:"Phone","area-code":"userDataMobileAreaCode","areacode-placeholder":"Area Code","phone-number":"userDataMobilePhoneNumber","phonenum-placeholder":"Phone Number","phonenum-value":t.mobilePhoneNumValue,"areacode-value":t.mobileAreaCodeValue,readonly:"view"===t.formType}})],1)]),i("div",{staticClass:"grid-x grid-padding-x spacer-top-m"},[i("div",{staticClass:"large-12 small-12 cell"},[i("h4",{staticClass:"ins-card-heading"},[t._v("Additional Info")])]),i("div",{staticClass:"large-4 medium-6 small-12 cell"},[i("InsInputWrap",{attrs:{id:"userFacebookField",name:"form[properties_attributes][facebook_link]",placeholder:"https://facebook.com/",label:"Facebook Profile Link",field:"url",validate:!0,autocomplete:"off"},model:{value:t.userData["Facebook"],callback:function(e){t.$set(t.userData,"Facebook",e)},expression:"userData['Facebook']"}}),i("InsInputWrap",{attrs:{id:"userTwitterField",name:"form[properties_attributes][twitter_link]",placeholder:"https://twitter.com/",label:"Twitter Profile Link",field:"url",validate:!0,autocomplete:"off"},model:{value:t.userData["Twitter"],callback:function(e){t.$set(t.userData,"Twitter",e)},expression:"userData['Twitter']"}}),i("InsInputWrap",{attrs:{id:"userYoutubeField",name:"form[properties_attributes][youtube_link]",placeholder:"https://youtube.com/",label:"YouTube Profile Link",field:"url",validate:!0,autocomplete:"off"},model:{value:t.userData["Youtube"],callback:function(e){t.$set(t.userData,"Youtube",e)},expression:"userData['Youtube']"}})],1),i("div",{staticClass:"large-4 medium-6 small-12 cell"},[i("InsInputWrap",{attrs:{id:"userLinkedinField",name:"form[properties_attributes][linkedin_link]",placeholder:"https://linkedin.com/",label:"Linkedin Profile Link",field:"url",validate:!0,autocomplete:"off"},model:{value:t.userData["Linkedin"],callback:function(e){t.$set(t.userData,"Linkedin",e)},expression:"userData['Linkedin']"}}),i("InsInputWrap",{attrs:{id:"userInstagramField",name:"form[properties_attributes][instagram_link]",placeholder:"https://instagram.com/",label:"Instagram Profile Link",field:"url",validate:!0,autocomplete:"off"},model:{value:t.userData["Instagram"],callback:function(e){t.$set(t.userData,"Instagram",e)},expression:"userData['Instagram']"}})],1),i("div",{staticClass:"large-4 medium-6 small-12 cell"},[i("InsTextareaWrap",{attrs:{id:"userNoteField",name:"userNoteField",placeholder:"Notes",label:"Notes",autocomplete:"off",maxlength:"255"},model:{value:t.userData["Notes"],callback:function(e){t.$set(t.userData,"Notes",e)},expression:"userData['Notes']"}})],1)]),i("div",{staticClass:"grid-x grid-padding-x spacer-top-m"},[i("div",{staticClass:"large-12 small-12 cell"},[i("h4",{staticClass:"ins-card-heading"},[t._v("Addresses")]),i("p",[t._v("Location 1")]),i("AddressFields",{attrs:{field:"Location1",rawData:t.Location1AddressData},on:{addressFieldChanged:t.addressFieldChangedHandler}})],1)]),i("div",{staticClass:"grid-x grid-padding-x spacer-top-m"},[i("div",{staticClass:"large-12 small-12 cell"},[i("p",[t._v("Location 2")]),i("AddressFields",{attrs:{field:"Location2",rawData:t.Location2AddressData},on:{addressFieldChanged:t.addressFieldChangedHandler}})],1)]),i("div",{staticClass:"grid-x grid-padding-x spacer-top-m"},[i("div",{staticClass:"large-12 small-12 cell"},[i("p",[t._v("Location 3")]),i("AddressFields",{attrs:{field:"Location3",rawData:t.Location3AddressData},on:{addressFieldChanged:t.addressFieldChangedHandler}})],1)])]),i("div",{staticClass:"spacer"}),i("div",{staticClass:"grid-x grid-margin-x"},["edit"==t.formType?i("div",{staticClass:"cell large-4 medium-5 small-12 footer-btn-container small-order-2 medium-order-1"},[i("ins-button",{attrs:{label:"ARCHIVE COMPANY",color:"negative",type:"button"},on:{onClickInsButton:t.archiveCompany}})],1):t._e(),i("div",{class:("edit"===t.formType?"large-8 medium-7":"large-12 medium-12")+" small-12 cell text-right footer-btn-container small-order-1 medium-order-2"},[i("ins-button",{attrs:{type:"button",label:"Cancel",color:"blue",outlined:"true",size:"normal",disabled:t.submittingForm},on:{onClickInsButton:t.backToList}}),i("ins-button",{attrs:{type:"button",color:"blue",solid:"true",size:"normal",label:t.buttonLabel,disabled:t.submittingForm},on:{onClickInsButton:t.bindValues}}),"add"===t.formType?i("ins-button",{attrs:{type:"button",label:"Save and Create Another",color:"blue",solid:"true",size:"normal",disabled:t.submittingForm},on:{onClickInsButton:t.saveAddMore}}):t._e()],1)])],1):t._e()])])])])},Fe=[],je=i("bd86"),Be={name:"EditCompanyDetails",mixins:[m,Se],components:{InsInputWrap:At,InsSelectWrap:he,InsImagePickerWrap:be,InsTextareaWrap:Te,AddressFields:Re},computed:Object(Ct["b"])({formType:function(t){return t.CrmStore.formType},companyTypes:function(t){return t.SystemFieldsStore.company_type},industryTypes:function(t){return t.SystemFieldsStore.industry_type},administratorList:function(t){return t.SystemFieldsStore.administratorList},googleMapsApiKey:function(t){return t.SystemFieldsStore.google_maps_api_key}}),data:function(){return{showForm:!1,submittingForm:!1,userData:{},Location1AddressData:{},Location2AddressData:{},Location3AddressData:{},userProfile:this.$store.state.CrmStore.userProfile,formMethod:"",formName:"",fromURL:"/api/customizations",searchAddress:"",searchAddressField:void 0,parentResourceId:"modules/insites_core/insites_company",profilePictureName:"",authToken:"",location:"",userCountryCode:"au",buttonLabel:"Save",addMore:!1,toastMsg:"",sourceProfile:"/insites/api/get-current-user-data.json",workAreaCodeValue:"",workPhoneNumValue:"",mobileAreaCodeValue:"",mobilePhoneNumValue:"",homeAreaCodeValue:"",homePhoneNumValue:"",loadingCRMData:!1,headers:{},sourceCRMDetails:"/insites/api/get-company-contact-list-data.json?id=",contactModel:{form_configuration_name:"modules/insites_core/insites_crm_delete_customer",form:{profiles_attributes:{"modules/insites_core/insites_customer_attributes":{properties_attributes:{is_enabled:"false"}}}}},companyModel:{form_configuration_name:"modules/insites_core/insites_crm_delete_company",parent_resource_id:"modules/insites_core/insites_company",form:{properties:{is_enabled:"false"}}},s3FormCredentialURL:"/insites/api/s3-company-form.json",storeSettingsData:{},s3IconChange:!1,s3IconImage:"",s3IconURL:"",parsedS3FormData:"",formData:{}}},methods:{addressFieldChangedHandler:function(t){for(var e in t.mapData){var i=e.replace("search","");this.userData["".concat(t.field).concat(i)]=t.mapData[e]}},getFilename:function(t){this.profilePictureName=t,this.s3IconChange=!0},base64ToBlob:function(t,e){e=e||"";for(var i=1024,s=window.atob(t),a=[],n=0,r=s.length;n<r;n+=i){for(var o=s.slice(n,n+i),l=new Array(o.length),c=0;c<o.length;c++)l[c]=o.charCodeAt(c);var d=new Uint8Array(l);a.push(d)}return new Blob(a,{type:e})},appendToFormData:function(t){var e=new FormData;return Object(te["each"])(t,function(t,i){e.append(i,t)}),e},backToList:function(){InsitesUtil.goBack()},saveAddMore:function(){this.addMore=!0,this.bindValues()},attachFile:function(){this.$refs.profilePic.click()},buildFormData:function(t){var e=this.$refs.mobilePhone.getCountryData();e=e.dialCode,this.formData={authenticity_token:this.authToken,form_configuration_name:this.formName,parent_resource_id:this.parentResourceId,"form[properties_attributes][company_name]":Object(te["isEmpty"])(this.userData["Company"])?"":this.userData["Company"],"form[properties_attributes][is_enabled]":"true","form[properties_attributes][website]":Object(te["isEmpty"])(this.userData["Website"])?"":this.userData["Website"],"form[properties_attributes][industry_type]":Object(te["isEmpty"])(this.userData["Industry Type"])?"":this.userData["Industry Type"],"form[properties_attributes][company_type]":Object(te["isEmpty"])(this.userData["Company Type"])?"":this.userData["Company Type"],"form[properties_attributes][assigned_to]":Object(te["isEmpty"])(this.userData["Assigned To"])?"":this.userData["Assigned To"],"form[custom_addresses_attributes][location_1_attributes][street]":Object(te["isEmpty"])(this.userData["Location1street"])?"":this.userData["Location1street"],"form[custom_addresses_attributes][location_1_attributes][address]":Object(te["isEmpty"])(this.userData["Location1address"])?"":this.userData["Location1address"],"form[custom_addresses_attributes][location_1_attributes][city]":Object(te["isEmpty"])(this.userData["Location1city"])?"":this.userData["Location1city"],"form[custom_addresses_attributes][location_1_attributes][state]":Object(te["isEmpty"])(this.userData["Location1state"])?"":this.userData["Location1state"],"form[custom_addresses_attributes][location_1_attributes][postcode]":Object(te["isEmpty"])(this.userData["Location1postcode"])?"":this.userData["Location1postcode"],"form[custom_addresses_attributes][location_1_attributes][country]":Object(te["isEmpty"])(this.userData["Location1country"])?"":this.userData["Location1country"],"form[custom_addresses_attributes][location_2_attributes][street]":Object(te["isEmpty"])(this.userData["Location2street"])?"":this.userData["Location2street"],"form[custom_addresses_attributes][location_2_attributes][address]":Object(te["isEmpty"])(this.userData["Location2address"])?"":this.userData["Location2address"],"form[custom_addresses_attributes][location_2_attributes][city]":Object(te["isEmpty"])(this.userData["Location2city"])?"":this.userData["Location2city"],"form[custom_addresses_attributes][location_2_attributes][state]":Object(te["isEmpty"])(this.userData["Location2state"])?"":this.userData["Location2state"],"form[custom_addresses_attributes][location_2_attributes][postcode]":Object(te["isEmpty"])(this.userData["Location2postcode"])?"":this.userData["Location2postcode"],"form[custom_addresses_attributes][location_2_attributes][country]":Object(te["isEmpty"])(this.userData["Location2country"])?"":this.userData["Location2country"],"form[custom_addresses_attributes][location_3_attributes][street]":Object(te["isEmpty"])(this.userData["Location3street"])?"":this.userData["Location3street"],"form[custom_addresses_attributes][location_3_attributes][address]":Object(te["isEmpty"])(this.userData["Location3address"])?"":this.userData["Location3address"],"form[custom_addresses_attributes][location_3_attributes][city]":Object(te["isEmpty"])(this.userData["Location3city"])?"":this.userData["Location3city"],"form[custom_addresses_attributes][location_3_attributes][state]":Object(te["isEmpty"])(this.userData["Location3state"])?"":this.userData["Location3state"],"form[custom_addresses_attributes][location_3_attributes][postcode]":Object(te["isEmpty"])(this.userData["Location3postcode"])?"":this.userData["Location3postcode"],"form[custom_addresses_attributes][location_3_attributes][country]":Object(te["isEmpty"])(this.userData["Location3country"])?"":this.userData["Location3country"],"form[properties_attributes][mobile_phone_country_code]":e,"form[properties_attributes][mobile_phone_area_code]":document.getElementsByName("userDataMobileAreaCode")[0].value,"form[properties_attributes][mobile_phone_number]":document.getElementsByName("userDataMobilePhoneNumber")[0].value,"form[properties_attributes][facebook_link]":Object(te["isEmpty"])(this.userData["Facebook"])?"":this.userData["Facebook"],"form[properties_attributes][twitter_link]":Object(te["isEmpty"])(this.userData["Twitter"])?"":this.userData["Twitter"],"form[properties_attributes][youtube_link]":Object(te["isEmpty"])(this.userData["Youtube"])?"":this.userData["Youtube"],"form[properties_attributes][linkedin_link]":Object(te["isEmpty"])(this.userData["Linkedin"])?"":this.userData["Linkedin"],"form[properties_attributes][instagram_link]":Object(te["isEmpty"])(this.userData["Instagram"])?"":this.userData["Instagram"],"form[properties_attributes][notes]":Object(te["isEmpty"])(this.userData["Notes"])?"":this.userData["Notes"]},this.parsedFormData=this.appendToFormData(this.formData)},bindValues:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.submittingForm=!0,this.toastMsg="Company",e=document.getElementById("crmForm"),"add"===this.formType&&(this.formURL="/api/customizations"),!InsitesUtil.formValidate(yt()($(e).find(".ins-form-field, .ins-select-value-input, .ins-textarea-field")))){t.next=15;break}if(this.buildFormData(e),!this.s3IconChange){t.next=12;break}return t.next=9,this.getS3AssetURL(this.s3FormCredentialURL,"profile_image",this.s3IconImage,this.profilePictureName);case 9:this.s3IconImage=t.sent,this.parsedFormData.append("form[custom_images][profile_image][image]",this.s3IconImage),this.s3IconChange=!1;case 12:this.submitForm(this.parsedFormData),t.next=17;break;case 15:this.addMore=!1,this.submittingForm=!1;case 17:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),submitForm:function(t){var e=this,i={type:this.formMethod,contentType:!1,processData:!1,data:t,success:function(t){e.successHandler()},error:function(t){e.errorHandler(t)}};$.ajax(this.formURL,i)},successHandler:function(){toastIt("success","".concat(this.toastMsg," has been ").concat("add"===this.formType?"created":"updated","."),this.ops),"add"===this.formType?(document.getElementById("crmForm").reset(),this.userData["Name"]="",this.userData["Company"]="",this.s3IconImage=""):"edit"===this.formType&&this.$store.commit("setCompanyData",this.userData),!this.addMore&&InsitesUtil.goBack(),this.addMore=!1,this.submittingForm=!1},errorHandler:function(t){this.addMore=!1,this.submittingForm=!1;var e="";t.responseJSON&&t.responseJSON.errors&&("undefined"===t.responseJSON.errors.email&&null===t.responseJSON.errors.email||(e+=t.responseJSON.errors.email?"- Email "+t.responseJSON.errors.email[0]+"<br />":""),"undefined"===t.responseJSON.errors.password&&null===t.responseJSON.errors.password||(e+=t.responseJSON.errors.password?"- Password "+t.responseJSON.errors.password[0]:"")),toastIt("error",e,this.ops)},setAddressValue:function(){var t=this;setTimeout(function(){var e=["Location1AddressData","Location2AddressData","Location3AddressData"];e.forEach(function(e){if(!Object(te["isEmpty"])(t[e])){var i=e.replace("AddressData","");t.userData["".concat(i,"street")]=t[e].street,t.userData["".concat(i,"address")]=t[e].address,t.userData["".concat(i,"city")]=t[e].city,t.userData["".concat(i,"state")]=t[e].state,t.userData["".concat(i,"country")]=t[e].country,t.userData["".concat(i,"postcode")]=t[e].postcode}})},600)},setPhoneValue:function(){var t=this;t.$refs.mobilePhone;setTimeout(function(){$("#mobilePhone .phone").intlTelInput("setNumber","+"+t.userData["Company Mobile Phone Country Code"]),t.mobileAreaCodeValue=t.userData["Company Mobile Phone Area Code"],t.mobilePhoneNumValue=t.userData["Company Mobile Phone Number"]},300)},formValidate:function(t){var e=0,i=this;return yt()($(".ins-form-field, .ins-select-value-input, .ins-textarea-field")).forEach(function(t){!0!==t.hasAttribute("required")&&"true"!=t.getAttribute("required")||(e+=i.validateInput(t)),"email"===t.getAttribute("type")&&(e+=i.validateEmail(t))}),!(e>0)},validateInput:function(t){return t=t.target?t.target:t,""===t.value.trim()||null===t.value?(this.invalidFieldNotif(t),1):(this.validFieldNotif(t),0)},invalidFieldNotif:function(t){t.closest("ins-input").setAttribute("has-error",!0)},validFieldNotif:function(t){t.closest("ins-input").removeAttribute("has-error")},validateEmail:function(t){var e=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return 1==e.test(String(t.value).toLowerCase())?(this.validFieldNotif(t),0):(this.invalidFieldNotif(t),1)},updateUserData:function(t){var e;this.s3IconImage=t.profile_image?t.profile_image.original:"",this.userData=(e={id:t.id?t.id:"",Company:null===t.company_name?"":t.company_name,"Company Mobile Phone Country Code":this.checkValue(t.mobile_phone_country_code),"Company Mobile Phone Area Code":this.checkValue(t.mobile_phone_area_code),"Company Mobile Phone Number":this.checkValue(t.mobile_phone_number),"Company Home Phone Country Code":this.checkValue(t.home_phone_country_number),"Company Home Phone Area Code":this.checkValue(t.home_phone_area_number),"Company Home Phone Number":this.checkValue(t.home_phone_number),"Company Work Phone Country Code":this.checkValue(t.work_phone_country_number),"Company Work Phone Area Code":this.checkValue(t.work_phone_area_number),"Company Work Phone Number":this.checkValue(t.work_phone_number),Location1address:t.location_1.length>0&&"undefined"!==t.location_1[0].address?t.location_1[0].address:"",Location1street:t.location_1.length>0&&"undefined"!==t.location_1[0].street?t.location_1[0].street:"",Location1city:t.location_1.length>0&&"undefined"!==t.location_1[0].city?t.location_1[0].city:"",Location1state:t.location_1.length>0&&"undefined"!=t.location_1[0].state?t.location_1[0].state:"",Location1postode:t.location_1.length>0&&"undefined"!=t.location_1[0].postcode?t.location_1[0].postcode:"",Location1country:t.location_1.length>0&&"undefined"!==t.location_1[0].country?t.location_1[0].country:"",Facebook:this.checkValue(t.facebook_link),Instagram:this.checkValue(t.instagram_link),Twitter:this.checkValue(t.twitter_link),Google:this.checkValue(t.google_plus_link),Linkedin:this.checkValue(t.linkedin_link),Youtube:this.checkValue(t.youtube_link),Notes:this.checkValue(t.notes),Website:this.checkValue(t.website),"Industry Type":this.checkValue(t.industry_type),"Company Type":this.checkValue(t.company_type),"Assigned To":this.checkValue(t.assigned_to)},Object(je["a"])(e,"Industry Type",this.checkValue(t.industry_type)),Object(je["a"])(e,"Company Type",this.checkValue(t.company_type)),e)},updateCompanyData:function(t){this.Location1AddressData=t.location_1[0],this.Location2AddressData=t.location_2[0],this.Location3AddressData=t.location_3[0]},setUserData:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.$store.state.CrmStore.userData.id){t.next=6;break}e=this.$store.state.CrmStore.userData.raw,this.userData=this.$store.state.CrmStore.userData,this.s3IconImage=this.$store.state.CrmStore.userData["Company_Img"],t.next=16;break;case 6:return t.next=8,ct(this.checkURLParamsID());case 8:if(i=t.sent,!i.results.items.results.length){t.next=14;break}e=i.results.items.results[0],this.updateUserData(e),t.next=16;break;case 14:return this.toastInvalidIDNotification("company"),t.abrupt("return",this.$router.push("/customers"));case 16:this.updateCompanyData(e);case 17:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),setFormSettings:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,i,s,a,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this,e=[],this.checkURLParamsID()?(this.$store.commit("pushFormType","edit"),this.userData["id"]=this.checkURLParamsID()):this.$store.commit("pushFormType","add"),"add"!==this.formType){t.next=13;break}this.buttonLabel="Save",this.formMethod="POST",this.formURL="/api/customizations",this.parentResourceId="modules/insites_core/insites_company",this.formName="modules/insites_core/insites_add_new_company",this.userData={},e=[Nt,Ot,Lt],t.next=39;break;case 13:if("view"!==this.formType||!this.checkURLParamsID()){t.next=25;break}return this.buttonLabel="Update",t.next=17,this.setUserData();case 17:for(this.formMethod="",this.formURL="",this.formName="",i=document.getElementById("crmForm"),s=i.elements,a=0,n=s.length;a<n;++a)s[a].readOnly=!0,s[a].disabled=!0;e=[Nt,Ot,{label:"Edit Company",link:"#".concat(this.$route.path)}],this.setPhoneValue(),t.next=39;break;case 25:if("edit"!==this.formType||!this.checkURLParamsID()){t.next=38;break}return this.buttonLabel="Update",t.next=29,this.setUserData();case 29:this.formMethod="PUT",this.formURL="/api/customizations/".concat(this.userData.id),this.parentResourceId="modules/insites_core/insites_company",this.formName="modules/insites_core/insites_crm_update_company",e=[Nt,Ot,{label:"Edit Company",link:"#".concat(this.$route.path)}],this.setPhoneValue(),this.setAddressValue(),t.next=39;break;case 38:"remove"===this.formType?this.userData=this.$store.state.CrmStore.userData:InsitesUtil.goBack();case 39:InsitesUtil.setBreadCrumbs(e),this.formType&&(this.showForm=!0);case 41:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),archiveCompany:function(){var t=this,e="Are you sure you want to archive this company? This will also archive related contacts.";swal({title:"",html:'\n          <ins-loader\n            state-icon="warning"\n            icon-color="warning"\n            state-message="'.concat(e,'">\n          </ins-loader>'),type:"",width:330,showCancelButton:!0,confirmButtonClass:"negative",confirmButtonText:"Archive"}).then(function(e){e.value&&t.getAllContacts()})},getAllContacts:function(){var t=this,e="".concat(this.sourceCRMDetails).concat(this.userData.id,"&sortBy=updated_at&orderBy=desc");this.$http.get(e).then(function(e){e.data.items.results.length?t.deleteAllContacts(e.data.items.results):t.deleteCompany()}).catch(this.errorHandler)},deleteAllContacts:function(t){var e=this,i=!0,s=0;t.forEach(function(a){if(i){var n="/api/users/".concat(a.id),r=z()(e.contactModel);e.$http.put(n,r,{headers:e.headers}).then(function(i){s++,s===t.length&&e.deleteCompany()}).catch(function(t){e.errorHandler(t),i=!1})}})},deleteCompany:function(){var t=this,e="/api/customizations/".concat(this.userData.id),i=z()(this.companyModel);this.$http.put(e,i,{headers:this.headers}).then(function(e){toastIt("success","Successfully archived company.",t.ops),t.$store.commit("removeCompanyOption",t.userData.id),InsitesUtil.goBack()}).catch(this.errorHandler)},setInsRendererLabel:function(){var t=this,e=document.querySelector("ins-renderer");e?"add"===this.formType?e.updateRouteLabel("Add Company"):"edit"===this.formType&&e.updateRouteLabel("Edit Company"):setTimeout(function(){t.setInsRendererLabel()},300)}},mounted:function(){var t=this;this.setInsRendererLabel(),this.headers=this.apiHeader(),setTimeout(function(){t.$store.state.CrmStore.userData["Company Mobile Phone Country Code"]=""===t.$store.state.CrmStore.userData["Company Mobile Phone Country Code"]?"61":t.$store.state.CrmStore.userData["Company Mobile Phone Country Code"],t.setFormSettings()},500),"localhost"!==window.location.hostname?this.authToken=JSON.parse(document.getElementById("formConfig").innerHTML):(this.authToken="+Qj2j1eQpuy1fFxW6atnOluUyHLbL5cwDYL14rhASm13C+nkIPB6A5Ajxf/Cf1xFveFpEKMUd812HpUhyiBShQ==",this.location="")}},Me=Be,He=(i("7867"),Object(P["a"])(Me,Le,Fe,!1,null,null,null)),Ue=He.exports,Ve=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"case-list-tbl"}},[i("div",{attrs:{id:"case-filters"}},[i("ins-filter",{staticClass:"hydrated",attrs:{"with-date-filter":"","date-title":"Date Period"},on:{onFilterApply:t.onFilterApplyHandler}})],1),i("ins-base-table",{attrs:{id:"insBaseTable","searchbar-placeholder":"Search by Subject, Contact, Email or Assignee..."},on:{onPaginationChange:t.tablePaginationHandler,onTableSearch:t.tableSearchHandler,onTableSort:t.tableSortHandler,onTableBulkAction:t.tableBulkActionHandler,onTableRowAction:t.tableRowActionHandler}}),i("div",{staticClass:"spacer large"})],1)},We=[],Ke=(i("7f7f"),{name:"ListCases",mixins:[m],components:{InsSelectWrap:he},data:function(){return{caseData:this.caseData,source:"/insites/api/get-all-cases-data.json",sourceCaseData:"/insites/api/get-case-data.json?id=",sourceAdminData:"/insites/api/get-crm-data.json?id=",totalCount:0,pageNumber:1,pageSize:10,searchKeyword:"",sortedKeyword:"created_at",sortedBy:"desc",headers:{},rawFormData:{utf8:"✓",form_configuration_name:"modules/insites_core/insites_delete_case_customization",authenticity_token:"",resource_id:"new",parent_resource_id:"",parent_resource_class:"CustomModelType",_method:"DELETE",customization_id:""},showAssignedToFilter:!1,filterDataAssignedTo:[{first_name:"All",last_name:"",id:""}],filterDataStatus:["All","New","Pending","Open","Flagged","Closed"],filteredAssignedTo:"",filteredStatus:"",filteredDateFrom:"",filteredDateTo:"",continueDeletion:!1}},computed:Object(Ct["b"])({administratorList:function(t){return t.SystemFieldsStore.administratorList}}),methods:{selectsHandler:function(t){this.filteredAssignedTo=t,this.fetchDataFromSrc()},onFilterApplyHandler:function(t){this.searchKeyword="",document.getElementsByClassName("ins-searchbar-wrap")[0].querySelector("input").value="",this.filteredDateFrom=t.detail["Date Period"].from,this.filteredDateTo=t.detail["Date Period"].to,this.fetchDataFromSrc()},tablePaginationHandler:function(t){this.insBaseTable.loadingScreen=!0,this.pageSize=t.detail.pageSize,this.pageNumber=t.detail.pageNumber,this.fetchDataFromSrc()},tableSearchHandler:function(t){var e=this;if(13===t.detail.keyCode&&""!==t.detail.value||""===t.detail.value&&""!==this.searchKeyword){if(this.insBaseTable.loadingScreen=!0,this.searchKeyword=t.detail.value,!this.searchKeyword)return void this.processTableData();this.filteredData=[],this.rawData.forEach(function(t){Xt()(t).forEach(function(i){if("Subject"===i||"Contact"===i||"Email"===i||"Assigned To"===i){var s=t[i];if(s.toLowerCase().includes(e.searchKeyword.toLowerCase())){var a=e.filteredData.find(function(e){return e.id===t.id});a||e.filteredData.push(t)}}})}),this.sortedKeyword&&this.filteredData.length>0&&this.filteredData.sort(this.dynamicKeySort(this.sortedKeyword)),this.insBaseTable.pageNumber=1,this.processTableData(),this.filteredData.length||(this.insBaseTable.loadingScreen=!0,this.insBaseTable.loaderTitle="",this.insBaseTable.loaderMessage='No result found for "'+this.searchKeyword+'"',this.insBaseTable.loaderIcon="")}},dynamicKeySort:function(t,e){var i="asc"===e?1:-1;return function(e,s){var a=e[t]<s[t]?-1:e[t]>s[t]?1:0;return a*i}},tableSortHandler:function(t){this.sortedKeyword=t.detail.keyword,this.sortedBy=t.detail.order,this.searchKeyword?this.filteredData.sort(this.dynamicKeySort(this.sortedKeyword,this.sortedBy)):this.rawData.sort(this.dynamicKeySort(this.sortedKeyword,this.sortedBy)),this.processTableData()},tableBulkActionHandler:function(t){"Delete"===t.detail.action&&this.archiveSelection(t.detail.selections)},tableRowActionHandler:function(t){"View"===t.detail.action&&this.viewItem(t.detail),"Delete"===t.detail.action&&(this.continueDeletion=!1,this.deleteItem(t.detail,!0))},archiveSelection:function(t){var e=this;swal({title:"",html:'\n                <ins-loader\n                    state-icon="warning"\n                    icon-color="warning"\n                    state-message="Are you sure you want to delete these cases?">\n                </ins-loader>',type:"",width:330,showCancelButton:!0,confirmButtonClass:"negative",confirmButtonText:"Delete"}).then(function(i){if(i.value){var s=0;e.continueDeletion=!0,t.forEach(function(){var i=Object(h["a"])(regeneratorRuntime.mark(function i(a){return regeneratorRuntime.wrap(function(i){while(1)switch(i.prev=i.next){case 0:if(!e.continueDeletion){i.next=5;break}return i.next=3,e.deleteCase(a,!1);case 3:s++,t.length===s&&(e.continueDeletion=!1,parent.toastIt("success","Cases have been deleted.",e.ops),e.fetchDataFromSrc());case 5:case"end":return i.stop()}},i,this)}));return function(t){return i.apply(this,arguments)}}())}})},deleteItem:function(t,e){var i=this,s="Are you sure you want to delete this case?";swal({title:"",html:'\n                <ins-loader\n                    state-icon="warning"\n                    icon-color="warning"\n                    state-message="'.concat(s,'">\n                </ins-loader>'),type:"",width:330,showCancelButton:!0,confirmButtonClass:"negative",confirmButtonText:"Delete"}).then(function(s){s.value&&i.deleteCase(t.data,e)}).catch(function(t){i.continueDeletion=!1,console.error("error",t),parent.toastIt("error","Failed to delete case.",i.ops),i.fetchDataFromSrc()})},deleteCase:function(t,e){var i=this,s="/api/customizations/".concat(t.id);this.rawFormData.customization_id=t.id,this.rawFormData.parent_resource_id=t.raw.case_type;var a=this.appendToFormData(this.rawFormData);this.$http.post(s,a).then(function(t){i.continueDeletion||(e&&parent.toastIt("success","Successfully deleted case.",i.ops),i.fetchDataFromSrc())}).catch(function(t){i.continueDeletion=!1,console.error("error",t),parent.toastIt("error","Failed to delete case.",i.ops),i.fetchDataFromSrc()})},appendToFormData:function(t){var e=new FormData;return Object(te["each"])(t,function(t,i){e.append(i,t)}),e},viewItem:function(t){this.$store.commit("pushCaseData",t.data),InsitesUtil.renderPage("Case Details","#/case-details/".concat(t.data.id)),this.$router.push("/case-details/".concat(t.data.id))},processTableData:function(){var t=this,e=this.pageNumber*this.pageSize,i=e-this.pageSize;this.displayedData=[],this.searchKeyword?(this.insBaseTable.totalCount=this.filteredData.length,this.filteredData.forEach(function(s,a){a>=i&&a<=e?t.displayedData.push(s):t.filteredData.length<t.pageSize&&t.displayedData.push(s)})):(this.rawData.forEach(function(s,a){a>=i&&a<e&&t.displayedData.push(s)}),this.insBaseTable.totalCount=this.rawData.length,this.displayedData.sort(this.dynamicKeySort(this.sortedKeyword,this.sortedBy))),this.insBaseTable.tableData=this.displayedData,this.insBaseTable.loadingScreen=!1},loaderStateHandler:function(t,e,i){this.insBaseTable.loadingScreen=!0,this.insBaseTable.loaderTitle=t,this.insBaseTable.loaderMessage=e,this.insBaseTable.loaderIcon=i},fetchDataFromSrc:function(){var t=this;this.rawData=[],this.displayedData=[],this.filteredData=[],this.insBaseTable.totalCount=0,this.loaderStateHandler("Processing Your Data","Just a moment, we're fetching and processing your data.","processing"),this.insBaseTable.loadingScreen=!0;var e="".concat(this.source,"?size=1000&page=1&sortBy=").concat(this.sortedKeyword,"&orderBy=").concat(this.sortedBy,"&assigned_to=").concat(this.filteredAssignedTo,"&case_status=").concat(this.filteredStatus,"&date_from=").concat(this.filteredDateFrom,"&date_to=").concat(this.filteredDateTo);this.$http.get(e).then(function(e){var i=e.data.items.results;i.length?t.bindTableData(i):(t.insBaseTable.loaderTitle="",t.searchKeyword?t.insBaseTable.loaderMessage='No results for "'.concat(t.searchKeyword,'"'):t.insBaseTable.loaderMessage="There are no Cases found.",t.insBaseTable.loaderIcon="no-data")}).catch(function(e){console.error("Error: "+e),t.errorHandler()})},errorHandler:function(){this.insBaseTable.loaderTitle=void 0,this.insBaseTable.loaderMessage="Failed to load Data. Please try again.",this.insBaseTable.loaderIcon="error"},checkValue:function(t,e){return t&&"undefined"!==t&&null!==t?"".concat(e?"+":"").concat(t):""},capitalize:function(t){return this.checkValue(t).split("_").map(function(t){return t.charAt(0).toUpperCase()+t.substring(1)}).join(" ")},getName:function(t){var e="";return Object(te["isEmpty"])(t.userData)||(t.userData.name?e=t.userData.name:(""!==this.checkValue(t.userData.first_name)&&(e=this.userData.first_name),""!==this.checkValue(this.userData.last_name)&&(e+=" ".concat(t.userData.last_name)))),e},getEmail:function(t){return Object(te["isEmpty"])(t.userData)?"":t.userData.email?t.userData.email:t.userData.email_address?t.userData.email_address:""},getPhone:function(t,e){return Object(te["isEmpty"])(e)?"":this.constructPhoneNumber(t,e)},constructPhoneNumber:function(t,e){var i="";return e&&""!=this.checkValue(e.contact_number)&&this.checkValue(e.contact_number[t+"_phone_area_code"])&&this.checkValue(e.contact_number[t+"_phone_number"])&&(i="".concat(this.checkValue(e.contact_number[t+"_phone_country_code"],!0)),i+=" ".concat(this.checkValue(e.contact_number[t+"_phone_area_code"])),i+=" ".concat(this.checkValue(e.contact_number[t+"_phone_number"]))),i.trim()},getCaseData2:function(t){var e=this,i="".concat(this.sourceCaseData).concat(t);return new bt.a(function(t,s){e.$http.get(i).then(function(e){var i=e.data.items.results;t({state:!0,data:i})}).catch(function(t){window.error_test=t;var e=t,i=Xt()(e).length;if(0===i)s({state:!1,issue:"other_issue"});else{var a=e["request"]["status"];s(429===a?{state:!1,issue:429}:{state:!1,issue:"other_issue"})}})})},getCaseDataWrapperRetry:function(t){var e=this,i=3;return new bt.a(function(s){(function i(a){0==a&&s([]),setTimeout(Object(h["a"])(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.getCaseData2(t);case 3:r=n.sent,s(r),n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](0),429===n.t0.issue?(a-=1,i(a)):s([]);case 10:case"end":return n.stop()}},n,this,[[0,7]])})),2e3)})(i)})},getAssignedTo:function(t){var e=this,i="".concat(this.sourceAdminData).concat(t);return this.$http.get(i).then(function(t){var e=t.data.items.results;return e.length>0?"".concat(e[0].first_name," ").concat(e[0].last_name):""}).catch(function(t){return console.error("Error: "+t),e.errorHandler(),""})},bindTableData:function(t){var e=this,i=[];t.forEach(function(){var s=Object(h["a"])(regeneratorRuntime.mark(function s(a){var n,r,o,l,c;return regeneratorRuntime.wrap(function(s){while(1)switch(s.prev=s.next){case 0:return"",n="",r="new",o=[],s.next=6,e.getCaseDataWrapperRetry(a.case_id);case 6:if(l=s.sent,!l.data){s.next=19;break}if(!(l.data.length>0)){s.next=19;break}if(o=l.data[0],""===e.checkValue(o.assigned_to)){s.next=16;break}return s.next=13,e.getAssignedTo(o.assigned_to);case 13:s.t0=s.sent,s.next=17;break;case 16:s.t0="";case 17:n=s.t0,r=""!==e.checkValue(o.status)?o.status.toLowerCase():"new";case 19:c={id:a.case_id,raw:a,caseData:o,Subject:"".concat(e.capitalize(e.checkValue(a.case_label))),Contact:e.getName(a),Email:e.getEmail(a),"Mobile Phone":e.getPhone("mobile",a.userData),"Assigned To":n,"Date Created":InsitesUtil.formatLocalisation(a.created_at),created_at:a.created_at,Status:r},i.push(c),e.rawData=i,t.length===i.length&&e.processTableData();case 23:case"end":return s.stop()}},s,this)}));return function(t){return s.apply(this,arguments)}}())},setInsRendererLabel:function(){var t=this,e=document.querySelector("ins-renderer");e.updateRouteLabel?e.updateRouteLabel("Cases"):setTimeout(function(){t.setInsRendererLabel()},300)}},mounted:function(){this.setInsRendererLabel(),this.headers=this.apiHeader(),this.rawFormData.authenticity_token=this.headers["X-CSRF-Token"],this.insBaseTable=document.getElementById("insBaseTable"),this.insBaseTable.rowActions=["View","Delete"],this.insBaseTable.bulkActions=["Delete"],this.insBaseTable.tableHeaders=[{label:"Subject",type:"string",sortable:!0,hasColumnAction:!0,hasLink:!0},{label:"Contact",type:"string",sortable:!0},{label:"Email",type:"string",sortable:!0},{label:"Mobile Phone",type:"string",sortable:!1},{label:"Assigned To",type:"string",sortable:!0},{label:"Date Created",type:"string",sortable:!0},{label:"Status",type:"string",sortable:!0,hasTag:!0}],this.filteredDateFrom=Y()().format("YYYY-MM-DD"),this.filteredDateTo=Y()().format("YYYY-MM-DD"),this.fetchDataFromSrc()}}),ze=Ke,qe=(i("0101"),Object(P["a"])(ze,Ve,We,!1,null,null,null)),Ye=qe.exports,Ge=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"grid-container-full",attrs:{id:"caseDetails"}},[i("div",{staticClass:"grid-x grid-margin-x"},[i("div",{staticClass:"cell large-6 medium-12 small-12 margin-bottom-30"},[i("ins-card",{attrs:{steady:""}},[i("div",{staticClass:"grid-x grid-padding-x"},[i("div",{staticClass:"cell large-12 medium-12 small-12"},[i("h4",[t._v("Case Details")]),i("table",{staticClass:"information-wrap"},[i("tr",[i("td",{staticClass:"td-label"},[t._v("Case ID")]),i("td",[t._v(t._s(t.checkValue(t.caseDetails["id"])))])]),i("tr",[i("td",{staticClass:"td-label"},[t._v("Date Created")]),i("td",[t._v(t._s(t.formatDateCreated(t.caseDate)))])]),i("tr",[i("td",{staticClass:"td-label"},[t._v("Form Title")]),i("td",[t._v(t._s(t.caseFormTitle))])]),i("tr",[i("td",{staticClass:"td-label"},[t._v("Work Flow")]),i("td",[t._v("-")])])]),i("InsSelectWrap",{attrs:{id:"userAssignedToField",name:"userAssignedToField",label:"Assigned To",placeholder:"- Select -",searchable:""},model:{value:t.caseAssignedTo,callback:function(e){t.caseAssignedTo=e},expression:"caseAssignedTo"}},t._l(t.administratorList.results,function(e){return i("ins-select-option",{key:e.id,attrs:{label:t.checkValue(e.first_name)+" "+t.checkValue(e.last_name),value:e.id}})}),1),i("InsSelectWrap",{attrs:{id:"caseStatus",name:"caseStatus",label:"Status",placeholder:"- Select -"},model:{value:t.caseStatus,callback:function(e){t.caseStatus=e},expression:"caseStatus"}},[i("ins-select-option",{attrs:{label:"New",value:"new"}}),i("ins-select-option",{attrs:{label:"Flagged",value:"flagged"}}),i("ins-select-option",{attrs:{label:"Open",value:"open"}}),i("ins-select-option",{attrs:{label:"Closed",value:"closed"}})],1)],1)])]),i("div",{staticClass:"grid-x grid-padding-y"},[i("div",{staticClass:"cell large-6 medium-6 small-12"},[i("ins-button",{attrs:{label:"Delete Case",type:"button",color:"negative"},on:{onClickInsButton:t.deleteItem}})],1),i("div",{staticClass:"cell large-6 medium-6 small-12 text-right"},[i("ins-button",{attrs:{label:"Update Details",type:"button",color:"solid"},on:{onClickInsButton:t.updateItem}})],1)])],1),i("div",{staticClass:"cell large-6 medium-12 small-12 margin-bottom-30"},[i("ins-card",{attrs:{steady:""}},[i("div",{staticClass:"grid-x grid-padding-x"},[i("div",{staticClass:"cell large-12 medium-12 small-12"},[i("h4",[t._v("Form Submission")]),i("table",{staticClass:"information-wrap"},t._l(t.caseSubmissionData,function(e){return"case_id"!==e.label?i("tr",{key:e.case_id},[i("td",{staticClass:"td-label"},[t._v(t._s(e.label))]),"text"===e.type?i("td",[t._v(t._s(e.value))]):t._e(),"email"===e.type?i("td",[i("a",{attrs:{href:"mailto:"+e.value}},[t._v(t._s(e.value))])]):t._e(),"attachments"===e.type||"images"===e.type?i("td",[i("a",{attrs:{target:"_blank",href:""+e.value,download:""+e.fileName}},[t._v(t._s(e.fileName))])]):t._e()]):t._e()}),0)])])])],1)])])},Je=[],Xe={name:"CaseDetails",mixins:[m],components:{InsSelectWrap:he},data:function(){return{adminList:[],sourceCaseData:"/insites/api/get-case-data.json?id=",sourceCaseDetails:"/insites/api/get-case-details-data.json?id=",caseDetails:{},caseFormTitle:"",caseDate:"",caseAssignedTo:"",caseStatus:"new",caseForm:[],caseSubmissionData:[],headers:{},newCase:!0,rawFormData:{utf8:"✓",form_configuration_name:"modules/insites_core/insites_delete_case_customization",authenticity_token:"",resource_id:"new",parent_resource_id:"",parent_resource_class:"CustomModelType",_method:"DELETE",customization_id:""},addCaseFormData:{form_configuration_name:"modules/insites_core/insites_add_case_details",parent_resource_id:"modules/insites_core/insites_cases",form:{properties:{assigned_to:"",case_id:"",status:""}}}}},computed:Object(Ct["b"])({caseData:function(t){return t.CaseStore.caseData},administratorList:function(t){return t.SystemFieldsStore.administratorList}}),methods:{setCaseData:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getCaseData(this.checkURLParamsID());case 2:return e=t.sent,t.next=5,this.getCaseDetails(this.checkURLParamsID());case 5:i=t.sent,this.$store.commit("pushCaseData",this.formatCaseData(i[0],e[0])),this.caseDetails=this.caseData,this.setFormTitle(),this.caseAssignedTo=this.caseDetails.caseData?this.caseDetails.caseData.assigned_to:"",this.caseStatus=this.caseDetails.caseData?this.caseDetails.caseData.status:"new",this.bindCase();case 12:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),formatCaseData:function(t,e){var i={id:t.case_id,raw:t,caseData:e,Subject:"".concat(this.capitalize(this.checkValue(t.case_label))),"Assigned To":e?e.assigned_to:"","Date Created":InsitesUtil.formatLocalisation(t.created_at),created_at:t.created_at,Status:e?e.status:""};return i},setFormTitle:function(){this.caseFormTitle=this.checkValue(this.capitalize(this.caseDetails["raw"]["case_label"]))},buildCaseData:function(t,e){t=this.capitalize(t);var i={};if("Addresses"===t)i={label:this.capitalize(e["name"]),value:"".concat(this.checkValue(e["address"])," ").concat(this.checkValue(e["address2"])," ").concat(this.checkValue(e["city"])," ").concat(this.checkValue(e["state"])," ").concat(this.checkValue(e["country"])," ").concat(this.checkValue(e["postcode"])),type:"text"};else if("Attachments"===t)i={label:this.capitalize(e["name"]),fileName:e["file_name"],value:e["url"],type:"attachments"};else if("Images"===t)i={label:this.capitalize(e["name"]),fileName:e["filename"]?e["filename"]:this.capitalize(e["name"]),value:e["original"],type:"images"};else for(var s in e){var a=s.toLowerCase().indexOf("email")>=0?"email":"text";i={label:this.capitalize(s),value:this.checkValue(e[s]),type:a}}this.caseSubmissionData.push(i)},bindCase:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,i,s,a,n,r,o,l,c=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getCaseDetails(this.caseDetails.id);case 2:for(r in e=t.sent,this.caseDate=Y()(this.caseDetails.raw.created_at).format("DD-MMM-YYYY hh:mm A ZZ"),i=e[0].case_data,s=e[0].case_addresses,a=e[0].case_images,n=e[0].case_attachments,this,i)o=r.toLowerCase().indexOf("email")>=0?"email":"text",l={label:this.capitalize(r),value:this.checkValue(i[r]),type:o},this.caseSubmissionData.push(l);this.caseSubmissionData.sort(this.dynamicKeySort("label","asc")),s&&s.forEach(function(t){c.buildCaseData("addresses",t)}),n&&n.forEach(function(t){c.buildCaseData("attachments",t)}),a&&a.forEach(function(t){c.buildCaseData("images",t)});case 14:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),formatDateCreated:function(t){var e=this.checkValue(t);return e?InsitesUtil.formatLocalisation(t):e},capitalize:function(t){return this.checkValue(t).replace(/_/g," ").split(" ").map(function(t){return t.charAt(0).toUpperCase()+t.substring(1)}).join(" ")},dynamicKeySort:function(t,e){var i="asc"===e?1:-1;return function(e,s){var a=e[t]<s[t]?-1:e[t]>s[t]?1:0;return a*i}},deleteItem:function(){var t=this,e="Are you sure you want to delete this case?",i=this;swal({title:"",html:'\n                <ins-loader\n                    state-icon="warning"\n                    icon-color="warning"\n                    state-message="'.concat(e,'">\n                </ins-loader>'),type:"",width:330,showCancelButton:!0,confirmButtonClass:"negative",confirmButtonText:"Delete"}).then(function(e){e.value&&(t.continueDeletion=!0,t.deleteCase(i.caseDetails))})},deleteCase:function(t){var e=this,i="/api/customizations/".concat(t.id);this.rawFormData.customization_id=t.id,this.rawFormData.parent_resource_id=t.raw.case_type;var s=this.appendToFormData(this.rawFormData);this.$http.post(i,s).then(function(t){parent.toastIt("success","Case has been successfully deleted.",e.ops),InsitesUtil.goBack()}).catch(function(t){console.error("error",t),parent.toastIt("error","Failed to delete case.",e.ops)})},appendToFormData:function(t){var e=new FormData;return Object(te["each"])(t,function(t,i){e.append(i,t)}),e},updateItem:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,i,s,a,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e="",i=[],s="post",this.addCaseFormData.form.properties.assigned_to=this.caseAssignedTo,this.addCaseFormData.form.properties.case_id=this.caseDetails.id,this.addCaseFormData.form.properties.status=this.caseStatus,a=z()(this.addCaseFormData),t.next=9,this.getCaseData(this.caseDetails.id);case 9:i=t.sent,this.newCase&&!i.length?(e="/api/customizations",s="post"):(e="/api/customizations/".concat(i[0].id),s="put"),this.$http[s](e,a,{headers:this.headers}).then(function(t){parent.toastIt("success","Case has been updated.",n.ops)}).catch(function(t){console.error("error",t),parent.toastIt("error","Failed to update case.",n.ops)});case 12:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getCaseData:function(t){var e=this,i="".concat(this.sourceCaseData).concat(t),s=this;return this.$http.get(i).then(function(t){var e=t.data.items.results;return e.length?(s.newCase=!1,e):(s.newCase=!0,[])}).catch(function(t){return console.error("Error: "+t),e.errorHandler(),[]})},getCaseDetails:function(t){var e=this,i="".concat(this.sourceCaseDetails).concat(t);return this.$http.get(i).then(function(t){var e=t.data.items.results;return e.length?e:[]}).catch(function(t){return console.error("Error: "+t),e.errorHandler(),[]})},setInsRendererLabel:function(){var t=this,e=document.querySelector("ins-renderer");e.updateRouteLabel?e.updateRouteLabel("Case Details"):setTimeout(function(){t.setInsRendererLabel()},300)}},created:function(){this.headers=this.apiHeader(),this.rawFormData.authenticity_token=this.headers["X-CSRF-Token"]},mounted:function(){this.setInsRendererLabel(),this.setCaseData();var t=[Nt,Pt,{label:"Case Details",link:"#".concat(this.$route.path)}];InsitesUtil.setBreadCrumbs(t)}},Qe=Xe,Ze=Object(P["a"])(Qe,Ge,Je,!1,null,null,null),ti=Ze.exports,ei=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"grid-container-full"},[t.companyData?i("div",{staticClass:"grid-x grid-margin-x"},[i("div",{staticClass:"cell large-8 medium-12 small-12 margin-bottom-30"},[i("ins-card",{attrs:{steady:""}},[i("div",{staticClass:"grid-x grid-padding-x"},[i("div",{staticClass:"cell large-12 medium-12 small-12"},[i("ProfileHead",{attrs:{"profile-name":t.checkValue(t.companyData["Company"]),"profile-img":t.checkValue(t.companyData["Company_Img"]),"profile-facebook":t.checkValue(t.companyData["Facebook"]),"profile-google-plus":t.checkValue(t.companyData["Google"]),"profile-instagram":t.checkValue(t.companyData["Instagram"]),"profile-linkedin":t.checkValue(t.companyData["Linkedin"]),"profile-twitter":t.checkValue(t.companyData["Twitter"]),"profile-youtube":t.checkValue(t.companyData["Youtube"])}}),i("div",{staticClass:"cell large-12 medium-12 small-12"},[i("div",{staticClass:"grid-x"},[i("div",{staticClass:"cell large-6 medium-12 small-12"},[i("table",{staticClass:"information-wrap"},[i("tr",[i("td",{staticClass:"td-label"},[t._v("Customer ID")]),i("td",[t._v(t._s(t.checkValue(t.companyData["company_id"])))])]),i("tr",[i("td",{staticClass:"td-label"},[t._v("Phone")]),i("td",[t._v(t._s(t.constructPhoneNumber()))])]),i("tr",[i("td",{staticClass:"td-label"},[t._v("Website")]),i("td",[i("a",{attrs:{href:t.checkURL(t.companyData["Website"]),target:"_blank"}},[t._v("\n                          "+t._s(t.checkValue(t.companyData["Website"]))+"\n                        ")])])]),i("tr",[i("td",{staticClass:"td-label"},[t._v("Assigned To")]),i("td",[t.assignedAdmin?i("span",[t._v("\n                          "+t._s(t.assignedAdmin.first_name+" "+t.assignedAdmin.last_name)+"\n                        ")]):t._e()])]),i("tr",[i("td",{staticClass:"td-label"},[t._v("Company Type")]),i("td",[t.companyType?i("span",[t._v("\n                          "+t._s(t.companyType.value)+"\n                        ")]):t._e()])]),i("tr",[i("td",{staticClass:"td-label"},[t._v("Industry Type")]),i("td",[t.industryType?i("span",[t._v("\n                          "+t._s(t.industryType.value)+"\n                        ")]):t._e()])])])]),i("div",{staticClass:"cell large-6 medium-12 small-12"},[t.constructedAddress?i("GoogleMapDirection",{attrs:{address:t.constructedAddress}}):i("div",{staticClass:"map-wrap no-location"},[i("div",{staticClass:"no-location"},[t._v("\n                      Map not Available\n                    ")])])],1)])]),i("div",{staticClass:"cell large-12 medium-12 small-12"},[i("div",{staticClass:"notes-wrap"},[i("InsTextareaWrap",{attrs:{label:"Notes",value:t.checkValue(t.companyData["Notes"]),readonly:""}})],1)]),i("div",{staticClass:"cell large-12 medium-12 small-12 text-right"},[i("ins-button",{attrs:{label:"EDIT COMPANY",outlined:""},on:{onClickInsButton:t.editCompanyHandler}})],1)],1)])])],1),i("div",{staticClass:"cell large-4 medium-12 small-12 activities-if margin-bottom-30"},[i("AdminActivities",{attrs:{activities:t.activities}})],1),i("div",{staticClass:"cell large-12 medium-12 small-12 margin-bottom-30"},[i("div",{staticClass:"header-buttons"},[i("ins-button",{staticClass:"add-new-contact-btn",attrs:{label:"ADD NEW CONTACT",solid:""},on:{onClickInsButton:t.addNewContactHandler}})],1),i("ContactList",{attrs:{"company-id":t.companyData["company_id"]}})],1),i("div",{staticClass:"cell large-12 medium-12 small-12 margin-bottom-30"},[i("ins-button",{attrs:{label:"ARCHIVE COMPANY",color:"negative"},on:{onClickInsButton:t.archiveCompany}})],1)]):t._e()])},ii=[],si=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"google-map-direction-wrap"},[i("div",{staticClass:"map-wrap"},[""===t.googleMapsApiKey||t.address?""===!t.googleMapsApiKey||t.address?t._e():i("div",{staticClass:"no-location",style:"background-image: "+t.bgImg},[t._v("\n      No Google Maps API Key\n    ")]):i("div",{staticClass:"no-location",style:"background-image: "+t.bgImg},[t._v("\n      Map not Available\n    ")]),t.address?i("div",{attrs:{id:"profileMap"}}):t._e()]),i("div",{staticClass:"address-wrap"},[i("span",[t._v(t._s(t.address))])]),t.address?i("div",{staticClass:"direction-wrap"},[i("a",{attrs:{target:"_blank",href:t.checkURL("https://www.google.com/maps/search/"+t.address)}},[i("i",{staticClass:"icon-location-arrow"}),i("span",[t._v("Get Directions")])])]):t._e()])},ai=[],ni={name:"GoogleMapDirection",props:["address","location"],data:function(){return{bgImg:"",googleMapsApiKey:""}},methods:{checkURL:function(t){return t.includes("https://")?t:t.includes("http://")?t:"//".concat(t)},setSystemFields:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){var i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,k(e);case 2:i=t.sent,s={type:e,value:i},this.$store.dispatch("checkSystemFields",s);case 5:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),mapInit:function(){this.mapTheme=InsitesUtil.getTheme();var t=document.getElementById("profileMap"),e=new google.maps.Geocoder,i=new google.maps.Map(t,{scrollwheel:!1,draggable:!0,disableDoubleClickZoom:!0,zoomControll:!1,zoom:16,styles:this.mapTheme});this.mapGetCoordinates(e,i)},mapGetCoordinates:function(t,e){t.geocode({address:this.address},function(t,i){if("OK"===i){e.setCenter(t[0].geometry.location);new google.maps.Marker({map:e,position:t[0].geometry.location})}else console.error("Geocode was not successful for the following reason: "+i)})}},mounted:function(){this.googleMapsApiKey=localStorage.getItem("google_maps_api_key")?JSON.parse(localStorage.getItem("google_maps_api_key")).results[0].value:"",this.address&&""!==this.address&&this.googleMapsApiKey&&""!==this.googleMapsApiKey&&this.mapInit(),"localhost"===document.location.hostname&&(this.bgImg="/assets/google-map-placeholder")}},ri=ni,oi=(i("6373"),Object(P["a"])(ri,si,ai,!1,null,null,null)),li=oi.exports,ci=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"profile-header-wrap"},[t.profileInitials?i("div",{staticClass:"profile-image-wrap"},[t.profileImg?i("img",{attrs:{src:t.profileImg,alt:t.profileName+" Profile Image"}}):i("div",{staticClass:"initials"},[t._v("\n      "+t._s(t.profileInitials)+"\n    ")])]):t._e(),i("div",{staticClass:"profile-name-wrap"},[i("h2",[t._v(t._s(t.profileName))])]),i("div",{staticClass:"social-links-wrap"},[t.profileFacebook?i("a",{staticClass:"social-link",attrs:{target:"_blank",href:t.checkURL(t.profileFacebook)}},[i("i",{staticClass:"icon-facebook-square"})]):t._e(),t.profileInstagram?i("a",{staticClass:"social-link",attrs:{target:"_blank",href:t.checkURL(t.profileInstagram)}},[i("i",{staticClass:"icon-instagram"})]):t._e(),t.profileLinkedin?i("a",{staticClass:"social-link",attrs:{target:"_blank",href:t.checkURL(t.profileLinkedin)}},[i("i",{staticClass:"icon-linkedin-square"})]):t._e(),t.profileTwitter?i("a",{staticClass:"social-link",attrs:{target:"_blank",href:t.checkURL(t.profileTwitter)}},[i("i",{staticClass:"icon-twitter-square"})]):t._e(),t.profileYoutube?i("a",{staticClass:"social-link",attrs:{target:"_blank",href:t.checkURL(t.profileYoutube)}},[i("i",{staticClass:"icon-youtube-square"})]):t._e()])])},di=[],ui={name:"ProfileHead",props:["profileName","profileImg","profileFacebook","profileTwitter","profileInstagram","profileGooglePlus","profileLinkedin","profileYoutube"],data:function(){return{profileInitials:""}},methods:{getInitials:function(){if(this.profileName){var t="",e=this.profileName.split(" ");return e.length>1&&(t="".concat(e[0][0]).concat(e[1][0])),1===e.length&&(t="".concat(e[0][0]).concat(e[0][1])),t}return!1},checkURL:function(t){return t.includes("https://")?t:t.includes("http://")?t:"//".concat(t)}},mounted:function(){this.profileInitials=this.getInitials()}},hi=ui,mi=(i("ce8e"),Object(P["a"])(hi,ci,di,!1,null,null,null)),pi=mi.exports,fi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ins-base-table",{ref:"contactListTable",attrs:{id:"testTable"},on:{onPaginationChange:t.tablePaginationHandler,onTableSearch:t.tableSearchHandler,onTableSort:t.tableSortHandler,onTableBulkAction:t.tableBulkActionHandler,onTableRowAction:t.tableRowActionHandler}})},_i=[],gi={name:"ViewCompanyDetails",mixins:[m],props:["companyId"],data:function(){return{hasTableData:!1,searchKeyword:"",pageNumber:1,pageSize:10,sortBy:"email",sortOrder:"asc",source:"/insites/api/get-company-contact-list-data.json",sourceSearch:"/insites/api/search-company-contact-list-data.json",contactModel:{form_configuration_name:"modules/insites_core/insites_crm_delete_customer",form:{profiles_attributes:{"modules/insites_core/insites_customer_attributes":{properties_attributes:{is_enabled:"false"}}}}},headers:{}}},methods:{tablePaginationHandler:function(t){this.pageSize=t.detail.pageSize,this.pageNumber=t.detail.pageNumber,this.fetchContactList()},tableSearchHandler:function(t){13===t.detail.keyCode&&""!==t.detail.value||""===t.detail.value&&""!==this.searchKeyword?(this.searchKeyword=t.detail.value,this.pageNumber=1,this.fetchContactList()):""===t.detail.value&&(this.searchKeyword="",this.pageNumber=1,this.fetchContactList())},tableSortHandler:function(t){this.sortBy=t.detail.keyword,this.sortOrder=t.detail.order,this.fetchContactList()},tableBulkActionHandler:function(t){var e=this;switch(t.detail.action){case"Archive":this.warnUser("Are you sure you want to archive these contacts?").then(function(i){return!!i.value&&e.archiveSelection(t.detail.selections)});break}},tableRowActionHandler:function(t){var e=this;switch(t.detail.action){case"Archive":this.warnUser("Are you sure you want to archive this contact?").then(function(i){return!!i.value&&e.archiveItem(t.detail.data.id)});break;case"Edit":this.editContactHandler(t.detail.data);break;case"View":this.viewContactHandler(t.detail.data);break}},archiveSelection:function(t){var e=this,i=0;t.forEach(function(s){i++,e.archiveItem(s.id,t.length,i)})},archiveItem:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a="/api/users/".concat(t),n=z()(this.contactModel);this.$http.put(a,n,{headers:this.headers}).then(function(t){s===i&&(toastIt("success","Successfully delete contact".concat(i>1?"s":""),e.ops),e.fetchContactList())}).catch(function(t){console.error("error",t),toastIt("error","Failed to archive contact",e.ops)})},warnUser:function(t){return swal({title:"",html:'\n          <ins-loader\n            state-icon="warning"\n            icon-color="warning"\n            state-message="'.concat(t,'">\n          </ins-loader>'),type:"",showCancelButton:!0,confirmButtonText:"Archive",width:330})},editContactHandler:function(t){t["Contact Type"]=t.temp_contact_type,this.$store.commit("pushUserData",t),this.$store.commit("pushFormType","edit"),InsitesUtil.renderPage("Edit Contact","#/edit-contact/".concat(t.Name?t.Name:t.Email)),this.setURLParameter("/edit-contact",t.id)},viewContactHandler:function(t){t["Contact Type"]=t.temp_contact_type,this.$store.commit("setContactData",t),InsitesUtil.renderPage("View Contact","#/view-contact/".concat(t.Name?t.Name:t.Email)),this.setURLParameter("/view-contact",t.id)},fetchContactList:function(){this.loadingStateHandler("Processing Your Data","Just a moment, we're fetching and processing your data.","processing");var t="";t=this.searchKeyword?this.constructURL(this.sourceSearch):this.constructURL(this.source),this.$http.get(t).then(this.responseHandler).catch(this.errorHandler)},responseHandler:function(t){var e=t.data.items;this.$refs.contactListTable.totalCount=e.total_entries,e.total_entries?(this.$refs.contactListTable.pageNumber=this.pageNumber,this.$refs.contactListTable.pageSize=this.pageSize,this.$refs.contactListTable.loadingScreen=!1,this.$refs.contactListTable.tableData=this.constructTableData(e.results)):this.searchKeyword?this.loadingStateHandler("",'No results for "'.concat(this.searchKeyword,'".'),"no data"):this.loadingStateHandler("","No contacts yet.","no data")},errorHandler:function(t){console.error("error",t),this.loadingStateHandler("","Failed to fetch contact list. Please try again.","error")},loadingStateHandler:function(t,e,i){this.$refs.contactListTable.loadingScreen=!0,this.$refs.contactListTable.loaderTitle=t,this.$refs.contactListTable.loaderMessage=e,this.$refs.contactListTable.loaderIcon=i},constructURL:function(t){var e="".concat(t,"?id=").concat(this.companyId);return e+="&size=".concat(this.pageSize),e+="&page=".concat(this.pageNumber),e+="&sortBy=".concat("Name"===this.sortBy?"first_name":"email"),e+="&orderBy=".concat(this.sortOrder),e+="&keyword=".concat(this.searchKeyword),e},constructTableHeader:function(t,e,i,s,a){return{label:t,type:e,sortable:i,hasImage:s,hasColumnAction:a}},constructTableData:function(t){return t.map(this.constructCRMTableData)},checkValue:function(t,e){return t&&"undefined"!==t&&"null"!==t&&t?"".concat(e?"+":"").concat(t):""},constructPhoneNumber:function(t,e){var i="";return t&&(this.checkValue(t[e+"_phone_area_code"])||this.checkValue(t[e+"_phone_number"]))&&(i="".concat(this.checkValue(t[e+"_phone_country_code"],!0)),i+=" ".concat(this.checkValue(t[e+"_phone_area_code"])),i+=" ".concat(this.checkValue(t[e+"_phone_number"]))),i.trim()},constructCRMTableData:function(t,e){return{id:null===t.id?"":t.id,raw:t,"First Name":t.first_name,"Last Name":t.last_name,Name:this.constructContactName(t),Email:t.email,"Home Phone":this.constructPhoneNumber(t.contact_number,"home"),"Mobile Phone":this.constructPhoneNumber(t.contact_number,"mobile"),"Work Phone":this.constructPhoneNumber(t.contact_number,"work"),"Mobile Phone Country Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.mobile_phone_country_code),"Mobile Phone Area Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.mobile_phone_area_code),"Mobile Phone Number":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.mobile_phone_number),"Home Phone Country Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.home_phone_country_code),"Home Phone Area Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.home_phone_area_code),"Home Phone Number":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.home_phone_number),"Work Phone Country Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.work_phone_country_code),"Work Phone Area Code":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.work_phone_area_code),"Work Phone Number":Object(te["isEmpty"])(t.contact_number)?"":this.checkValue(t.contact_number.work_phone_number),Notes:Object(te["isEmpty"])(t.customer_details)?"":this.checkValue(t.customer_details.notes),Facebook:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.facebook_link),Instagram:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.instagram_link),Twitter:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.twitter_link),Google:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.google_plus_link),Linkedin:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.linkedin_link),Youtube:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.youtube_link),company_id:Object(te["isEmpty"])(t.customer_details)?"":this.checkValue(t.customer_details.company_id),"Contact Type":Object(te["isEmpty"])(t.customer_details)?"":this.findContactType(t.customer_details.contact_type),temp_contact_type:Object(te["isEmpty"])(t.customer_details)?"":this.checkValue(t.customer_details.contact_type),Name_Img:Object(te["isEmpty"])(t.customer_details)?"":null===t.customer_details.profile_image?"":this.checkValue(t.customer_details.profile_image.original),Contact_Img:Object(te["isEmpty"])(t.customer_details)?"":null===t.customer_details.profile_image?"":this.checkValue(t.customer_details.profile_image.original),"Profile Image":Object(te["isEmpty"])(t.customer_details)?"":null===t.customer_details.profile_image?"":this.checkValue(t.customer_details.profile_image.original),"Home Address":Object(te["isEmpty"])(t.customer_details)?"":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].address):"","Home Street":Object(te["isEmpty"])(t.customer_details)?"":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].street):"","Home City":Object(te["isEmpty"])(t.customer_details)?"":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].city):"","Home State":Object(te["isEmpty"])(t.customer_details)?"":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].state):"","Home Area Code":Object(te["isEmpty"])(t.customer_details)?"":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].postcode):"","Home Country":Object(te["isEmpty"])(t.customer_details)?"":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].country):"","Last Activity":t.updated_at}},constructContactName:function(t){return Object(te["isEmpty"])(t)||null===t?"":t.first_name&&t.last_name?"".concat(t.first_name," ").concat(t.last_name):t.email?t.email:""},findContactType:function(t){if(t){if("Primary"===t)return"Primary";if("Secondary"===t)return"Secondary";var e=this.$store.state.SystemFieldsStore.contact_type.results.find(function(e){return e.id===t});return e?e.value:""}return""},checkEmpty:function(t,e){return Object(te["isEmpty"])(t)?"":this.checkValue(t[e])}},mounted:function(){this.fetchContactList(),this.headers=this.apiHeader(),this.$refs.contactListTable.tableHeaders=[this.constructTableHeader("Name","string",!0,!0,!0),this.constructTableHeader("Contact Type","string"),this.constructTableHeader("Work Phone","string"),this.constructTableHeader("Mobile Phone","string"),this.constructTableHeader("Email","string",!0)],this.$refs.contactListTable.rowActions=["View","Edit","Archive"],this.$refs.contactListTable.bulkActions=["Archive"],this.$refs.contactListTable.searchbarPlaceholder="Search"}},bi=gi,vi=(i("3e9b"),Object(P["a"])(bi,fi,_i,!1,null,null,null)),yi=vi.exports,Ci=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ins-card",{attrs:{"no-padding":"",steady:""}},[i("div",{staticClass:"activities-header"},[i("h1",[t._v("Timeline")])]),i("div",{staticClass:"grid-x grid-padding-x activities-wrap"},[t.activities?i("div",{staticClass:"large-12 medium-12 small-12 cell",attrs:{id:"activity-container-list"}},t._l(t.activities,function(e){return i("div",{key:e.id,staticClass:"grid-x grid-padding-x activity-row"},[i("div",{staticClass:"large-12 medium-12 small-12 cell no-padding-left"},[i("div",{staticClass:"stick-wrap"},[i("div",{class:["icon-wrap "+e.attributes.type]},[i("i",{staticClass:"icon-type icon-work"}),i("i",{staticClass:"icon-type icon-phone"}),i("i",{staticClass:"icon-type icon-mail"}),i("i",{staticClass:"icon-type icon-headset"}),i("i",{staticClass:"icon-type icon-notepad"}),i("i",{staticClass:"icon-type icon-notepad-1"}),i("i",{staticClass:"icon-type icon-goal-1"}),i("i",{staticClass:"icon-type icon-check"})])]),i("span",{staticClass:"date-time-wrap"},[i("div",{staticClass:"date"},[t._v(" "+t._s(e.attributes.date)+" ")]),i("div",{staticClass:"time"},[t._v(" "+t._s(e.attributes.time)+" ")])]),i("div",{staticClass:"details-wrap",domProps:{innerHTML:t._s(e.attributes.details)}}),i("div",{staticClass:"actions-wrap"},[i("button",{staticClass:"edit-btn",on:{click:function(i){return t.editActivity(e)}}},[i("i",{staticClass:"icon-edit"})]),i("button",{staticClass:"delete-btn",on:{click:function(i){return t.deleteActivity(e.id)}}},[i("i",{staticClass:"icon-delete"})])])])])}),0):t._e(),t.activities?t._e():i("div",{staticClass:"large-12 medium-12 small-12 cell"},[i("ins-loader",{attrs:{"state-title":"","state-message":"No Activites. This is a premium feature.","state-icon":""}})],1)])])},Di=[],ki=i("3d20"),Ti=i.n(ki),wi={name:"AdminActivities",computed:{},props:["activities"],methods:{editActivity:function(t){$("#activityModal").foundation("open")},addActivity:function(){$("#activityModal").foundation("open")},deleteActivity:function(t){var e=this,i="".concat(e.apiBaseUrl,"/activities/").concat(t),s=e.apiHeader.headers;$.ajax({url:i,method:"DELETE",headers:s,success:function(t){var e=this.$router.history.current.params.id,i=this.apiBaseUrl+"/checks/"+e+"/activities";this.$store.dispatch("getTimeline",{url:i}),Ti()("","Activity deleted successfully.","success")},error:function(t){console.error("error: ",t),Ti()("","Failed to delete activity. Please try again.","error")}})}}},Ei=wi,$i=(i("010d"),Object(P["a"])(Ei,Ci,Di,!1,null,null,null)),xi=$i.exports,Ai={name:"ViewCompanyDetails",mixins:[m],components:{InsInputWrap:At,InsSelectWrap:he,InsTextareaWrap:Te,AdminActivities:xi,ProfileHead:pi,GoogleMapDirection:li,ContactList:yi},data:function(){return{showDetails:!1,assignedAdmin:"",companyType:"",industryType:"",activities:void 0,companyData:void 0,constructedAddress:void 0,sourceCRMDetails:"/insites/api/get-company-contact-list-data.json?id=",mapTheme:InsitesUtil.getTheme(),headers:{},contactModel:{form_configuration_name:"modules/insites_core/insites_crm_delete_customer",form:{profiles_attributes:{"modules/insites_core/insites_customer_attributes":{properties_attributes:{is_enabled:"false"}}}}},companyModel:{form_configuration_name:"insites_crm_delete_company",parent_resource_id:"insites_company",form:{properties:{is_enabled:"false"}}}}},computed:Object(Ct["b"])({store_companyType:function(t){return t.SystemFieldsStore.company_type},store_industryType:function(t){return t.SystemFieldsStore.industry_type},store_adminList:function(t){return t.SystemFieldsStore.administratorList},store_googleMapAPI:function(t){return t.SystemFieldsStore.google_maps_api_key}}),watch:{store_companyType:function(){this.companyType=""===this.companyType&&this.companyData?this.getDataFromStore("Company Type","company_type"):this.companyType},store_industryType:function(){this.industryType=""===this.industryType&&this.companyData?this.getDataFromStore("Industry Type","industry_type"):this.industryType},store_adminList:function(){this.assignedAdmin=""===this.assignedAdmin&&this.companyData?this.getDataFromStore("Assigned To","administratorList"):this.assignedAdmin}},methods:{constructAddress:function(){var t="";return this.checkValue(this.companyData["Location1address"])&&(t=this.companyData["Location1address"]),this.checkValue(this.companyData["Location1street"])&&(t+=" ".concat(this.companyData["Location1street"])),this.checkValue(this.companyData["Location1city"])&&(t+=" ".concat(this.companyData["Location1city"])),this.checkValue(this.companyData["Location1state"])&&(t+=" ".concat(this.companyData["Location1state"])),this.checkValue(this.companyData["Location1country"])&&(t+=" ".concat(this.companyData["Location1country"])),this.checkValue(this.companyData["Location1postcode"])&&(t+=" ".concat(this.companyData["Location1postcode"])),t},constructPhoneNumber:function(){var t="";return(this.checkValue(this.companyData["Company Mobile Phone Area Code"])||this.checkValue(this.companyData["Company Mobile Phone Number"]))&&(t="".concat(this.checkValue(this.companyData["Company Mobile Phone Country Code"],!0)),t+=" ".concat(this.checkValue(this.companyData["Company Mobile Phone Area Code"])),t+=" ".concat(this.checkValue(this.companyData["Company Mobile Phone Number"]))),t.trim()},addNewContactHandler:function(){this.$store.commit("pushUserProfile","contact"),this.$store.commit("pushFormType","add"),this.$store.commit("pushFormName","insites_add_new_customer"),this.$store.commit("setAddFromCompany",this.companyData["id"]),this.$router.push("/manage-contact")},checkValue:function(t,e){return t&&"undefined"!==t&&"null"!==t&&t?"".concat(e?"+":"").concat(t):""},archiveCompany:function(){var t=this,e="Are you sure you want to archive this company? This will also archive related contacts.";swal({title:"",html:'\n            <ins-loader\n              state-icon="warning"\n              icon-color="warning"\n              state-message="'.concat(e,'">\n            </ins-loader>'),type:"",width:330,showCancelButton:!0,confirmButtonClass:"negative",confirmButtonText:"Archive"}).then(function(e){e.value&&t.getAllContacts()})},getAllContacts:function(){var t=this,e="".concat(this.sourceCRMDetails).concat(this.companyData.company_id,"&sortBy=updated_at&orderBy=desc");this.$http.get(e).then(function(e){e.items.results.length?t.deleteAllContacts(e.items.results):t.deleteCompany()}).catch(this.errorHandler)},deleteAllContacts:function(t){var e=this,i=!0,s=0;t.forEach(function(a){if(i){var n="/api/users/".concat(a.id),r=z()(e.contactModel);e.$http.put(n,r,{headers:e.headers}).then(function(i){s++,s===t.length&&e.deleteCompany()}).catch(function(t){e.errorHandler(t),i=!1})}})},deleteCompany:function(){var t=this,e="/api/customizations/".concat(this.companyData.company_id),i=z()(this.companyModel);this.$http.put(e,i,{headers:this.headers}).then(function(e){toastIt("success","Successfully archived company.",t.ops),t.$store.commit("removeCompanyOption",t.companyData.company_id),t.$router.push("/customers")}).catch(this.errorHandler)},errorHandler:function(t){console.error("error...",t),toastIt("error","Failed to archive company.",this.ops)},editCompanyHandler:function(){this.$store.commit("pushUserData",this.companyData),this.$store.commit("pushFormType","edit"),InsitesUtil.renderPage("Edit Company","#/edit-company/".concat(this.checkURLParamsID())),this.setURLParameter("/edit-company",this.checkURLParamsID())},getDataFromStore:function(t,e){var i,s=this,a=this.$store.state.SystemFieldsStore[e];if(a.results&&this.companyData){var n=a.results;i=n.find(function(e){return e.id===s.companyData[t]})}return i||!1},checkURL:function(t){var e=this.checkValue(t);return e?e.includes("https://")?e:e.includes("http://")?e:"//".concat(e):""},setInsRendererLabel:function(){var t=this,e=document.querySelector("ins-renderer");e.updateRouteLabel?e.updateRouteLabel("Customer Details"):setTimeout(function(){t.setInsRendererLabel()},300)},setCompanyData:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ct(this.checkURLParamsID());case 2:if(e=t.sent,!e.results.items.results.length){t.next=7;break}this.updatecompanyData(e.results.items.results[0]),t.next=9;break;case 7:return this.toastInvalidIDNotification("company"),t.abrupt("return",this.$router.push("/customers"));case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),checkCompanyData:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.companyData=JSON.parse(z()(this.$store.state.CrmStore.companyData)),!Object(te["isEmpty"])(this.companyData)){t.next=10;break}if(this.companyData=void 0,!this.checkURLParamsID()){t.next=8;break}return t.next=6,this.setCompanyData();case 6:t.next=10;break;case 8:return this.toastInvalidIDNotification("company"),t.abrupt("return",this.$router.push("/customers"));case 10:setTimeout(function(){e.constructedAddress=e.constructAddress(),e.companyType=""===e.companyType?e.getDataFromStore("Company Type","company_type"):e.companyType,e.industryType=""===e.industryType?e.getDataFromStore("Industry Type","industry_type"):e.industryType,e.assignedAdmin=""===e.assignedAdmin?e.getDataFromStore("Assigned To","administratorList"):e.assignedAdmin},500);case 11:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),updatecompanyData:function(t){var e;this.companyData=(e={company_id:t.id,Company_Img:Object(te["isEmpty"])(t)||null===t.profile_image?"":t.profile_image.original,Email:t.email,Website:this.checkValue(t.website),Company:null===t.company_name?"":t.company_name,Facebook:this.checkValue(t.facebook_link),Instagram:this.checkValue(t.instagram_link),Twitter:this.checkValue(t.twitter_link),Google:this.checkValue(t.google_plus_link),Linkedin:this.checkValue(t.linkedin_link),Youtube:this.checkValue(t.youtube_link),Notes:this.checkValue(t.notes)},Object(je["a"])(e,"Website",this.checkValue(t.website)),Object(je["a"])(e,"Industry Type",this.checkValue(t.industry_type)),Object(je["a"])(e,"Company Type",this.checkValue(t.company_type)),Object(je["a"])(e,"Assigned To",this.checkValue(t.assigned_to)),Object(je["a"])(e,"Company Mobile Phone Country Code",this.checkValue(t.mobile_phone_country_code)),Object(je["a"])(e,"Company Mobile Phone Area Code",this.checkValue(t.mobile_phone_area_code)),Object(je["a"])(e,"Company Mobile Phone Number",this.checkValue(t.mobile_phone_number)),Object(je["a"])(e,"Company Home Phone Country Code",this.checkValue(t.home_phone_country_number)),Object(je["a"])(e,"Company Home Phone Area Code",this.checkValue(t.home_phone_area_number)),Object(je["a"])(e,"Company Home Phone Number",this.checkValue(t.home_phone_number)),Object(je["a"])(e,"Company Work Phone Country Code",this.checkValue(t.work_phone_country_number)),Object(je["a"])(e,"Company Work Phone Area Code",this.checkValue(t.work_phone_area_number)),Object(je["a"])(e,"Company Work Phone Number",this.checkValue(t.work_phone_number)),Object(je["a"])(e,"Location1address",t.location_1.length>0&&"undefined"!==t.location_1[0].address?t.location_1[0].address:""),Object(je["a"])(e,"Location1street",t.location_1.length>0&&"undefined"!==t.location_1[0].street?t.location_1[0].street:""),Object(je["a"])(e,"Location1city",t.location_1.length>0&&"undefined"!==t.location_1[0].city?t.location_1[0].city:""),Object(je["a"])(e,"Location1state",t.location_1.length>0&&"undefined"!=t.location_1[0].state?t.location_1[0].state:""),Object(je["a"])(e,"Location1postode",t.location_1.length>0&&"undefined"!=t.location_1[0].postcode?t.location_1[0].postcode:""),Object(je["a"])(e,"Location1country",t.location_1.length>0&&"undefined"!==t.location_1[0].country?t.location_1[0].country:""),e)}},created:function(){this.headers=this.apiHeader(),this.checkCompanyData()},mounted:function(){this.setInsRendererLabel();var t=[Nt,Ot,{label:"View Company",link:"#".concat(this.$route.path)}];InsitesUtil.setBreadCrumbs(t)}},Ri=Ai,Si=(i("283d"),Object(P["a"])(Ri,ei,ii,!1,null,null,null)),Ii=Si.exports,Ni=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"grid-container-full"},[t.contactData?i("div",{staticClass:"grid-x grid-margin-x"},[i("div",{staticClass:"cell large-8 medium-12 small-12 margin-bottom-30"},[i("ins-card",{attrs:{steady:""}},[i("div",{staticClass:"grid-x grid-padding-x"},[i("div",{staticClass:"cell large-12 medium-12 small-12"},[""!==t.fullName?i("ProfileHead",{attrs:{"profile-name":t.checkValue(t.fullName),"profile-img":t.checkValue(t.contactData["Contact_Img"]),"profile-facebook":t.checkValue(t.contactData["Facebook"]),"profile-google-plus":t.checkValue(t.contactData["Google"]),"profile-instagram":t.checkValue(t.contactData["Instagram"]),"profile-linkedin":t.checkValue(t.contactData["Linkedin"]),"profile-twitter":t.checkValue(t.contactData["Twitter"]),"profile-youtube":t.checkValue(t.contactData["Youtube"])}}):t._e(),i("div",{staticClass:"cell large-12 medium-12 small-12"},[i("div",{staticClass:"grid-x"},[i("div",{staticClass:"cell large-6 medium-12 small-12"},[i("table",{staticClass:"information-wrap"},[i("tr",[i("td",{staticClass:"td-label"},[t._v("Contact Type")]),i("td",[t.contactType?i("span",[t._v("\n                          "+t._s(t.contactType)+"\n                        ")]):t._e()])]),i("tr",[i("td",{staticClass:"td-label"},[t._v("Work Phone")]),i("td",[t._v(t._s(t.checkValue(t.contactData["Work Phone"])))])]),i("tr",[i("td",{staticClass:"td-label"},[t._v("Mobile Phone")]),i("td",[t._v(t._s(t.checkValue(t.contactData["Mobile Phone"])))])]),i("tr",[i("td",{staticClass:"td-label"},[t._v("Home Phone")]),i("td",[t._v(t._s(t.checkValue(t.contactData["Home Phone"])))])]),i("tr",[i("td",{staticClass:"td-label"},[t._v("Email")]),i("td",[t._v(t._s(t.contactData["Email"]))])])])]),i("div",{staticClass:"cell large-6 medium-12 small-12"},[t.constructedAddress?i("GoogleMapDirection",{attrs:{address:t.constructedAddress}}):i("div",{staticClass:"map-wrap no-location"},[i("div",{staticClass:"no-location"},[t._v("\n                      Map not Available\n                    ")])])],1)])]),i("div",{staticClass:"cell large-12 medium-12 small-12"},[i("div",{staticClass:"notes-wrap"},[t._v("\n                "+t._s(t.contactData["Notes"])+"\n              ")])]),i("div",{staticClass:"cell large-12 medium-12 small-12 text-right"},[i("ins-button",{attrs:{label:"EDIT CONTACT",outlined:""},on:{onClickInsButton:t.editContactHandler}})],1)],1)])])],1),i("div",{staticClass:"cell large-4 medium-12 small-12 activities-if margin-bottom-30"},[i("AdminActivities",{attrs:{activities:t.activities}})],1),i("div",{staticClass:"cell large-12 medium-12 small-12"},[i("ins-button",{attrs:{label:"ARCHIVE CONTACT",color:"negative"},on:{onClickInsButton:t.archiveContact}})],1)]):t._e()])},Pi=[],Oi={name:"ViewContactDetails",mixins:[m],components:{InsInputWrap:At,InsSelectWrap:he,AdminActivities:xi,ProfileHead:pi,GoogleMapDirection:li},data:function(){return{fullName:"",activities:void 0,contactData:void 0,contactType:void 0,constructedAddress:void 0,formModel:{form_configuration_name:"modules/insites_core/insites_crm_delete_customer",form:{profiles_attributes:{"modules/insites_core/insites_customer_attributes":{properties_attributes:{is_enabled:"false"}}}}},mapTheme:InsitesUtil.getTheme()}},watch:{contactData:function(){this.fullName=this.contactData["First Name"]||this.contactData["Last Name"]?this.constructFullName():""}},methods:{constructAddress:function(){var t="";return this.checkValue(this.contactData["Home Address"])&&(t=this.contactData["Home Address"]),this.checkValue(this.contactData["Home Street"])&&(t+=" ".concat(this.contactData["Home Street"])),this.checkValue(this.contactData["Home City"])&&(t+=" ".concat(this.contactData["Home City"])),this.checkValue(this.contactData["Home State"])&&(t+=" ".concat(this.contactData["Home State"])),this.checkValue(this.contactData["Home Country"])&&(t+=" ".concat(this.contactData["Home Country"])),this.checkValue(this.contactData["Home Area Code"])&&(t+=" ".concat(this.contactData["Home Area Code"])),t},editContactHandler:function(){this.$store.commit("pushUserData",this.contactData),this.$store.commit("pushFormType","edit"),InsitesUtil.renderPage("Edit Contact","#/edit-contact/".concat(this.contactData.id)),this.setURLParameter("/edit-contact",this.contactData.id)},archiveContact:function(){var t=this;swal({title:"",html:'\n            <ins-loader\n              state-icon="warning"\n              icon-color="warning"\n              state-message="Are you sure you want to archive these items?">\n            </ins-loader>',type:"",width:330,showCancelButton:!0,confirmButtonClass:"negative",confirmButtonText:"Archive"}).then(function(e){e.value&&t.deleteContact()})},deleteContact:function(t){var e=this,i="/api/users/".concat(this.contactData.id),s=z()(this.formModel);this.$http.put(i,s,{headers:this.headers}).then(function(t){toastIt("success","Contact has been archived.",e.ops),e.$router.push("/customers")}).catch(function(t){toastIt("error","Failed to archive user. Please try again.",e.ops)})},setInsRendererLabel:function(){var t=this,e=document.querySelector("ins-renderer");e.updateRouteLabel?e.updateRouteLabel("Contact Details"):setTimeout(function(){t.setInsRendererLabel()},300)},getDataFromStore:function(t,e){var i=this;if("Primary"===this.contactData[t]||"Secondary"===this.contactData[t])return this.contactData[t];var s=this.$store.state.SystemFieldsStore[e],a=s.results.find(function(e){return e.id===i.contactData[t]});return!!a&&a.value},constructFullName:function(){var t="";return this.contactData["First Name"]&&(t+=this.contactData["First Name"]),this.contactData["Last Name"]&&(t+=" ".concat(this.contactData["Last Name"])),t||(t=this.contactData["Email"]),t},setContactData:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ot(this.checkURLParamsID());case 2:if(e=t.sent,!e.results.items.results.length){t.next=7;break}this.updateContactData(e.results.items.results[0]),t.next=9;break;case 7:return this.toastInvalidIDNotification("contact"),t.abrupt("return",this.$router.push("/customers"));case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),updateContactData:function(t){this.contactData={id:t.id,Contact_Img:Object(te["isEmpty"])(t.customer_details)||null===t.customer_details.profile_image?"":null===t.customer_details.profile_image?"":t.customer_details.profile_image.original,Email:t.email,"First Name":t.first_name,"Last Name":t.last_name,"Contact Type":t.customer_details.contact_type,Facebook:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.facebook_link),Instagram:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.instagram_link),Twitter:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.twitter_link),Google:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.google_plus_link),Linkedin:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.linkedin_link),Youtube:Object(te["isEmpty"])(t.social_links)?"":this.checkValue(t.social_links.youtube_link),"Work Phone":Object(te["isEmpty"])(t.contact_number)?"":this.constructPhoneNumber("work",t.contact_number),"Mobile Phone":Object(te["isEmpty"])(t.contact_number)?"":this.constructPhoneNumber("mobile",t.contact_number),"Home Phone":Object(te["isEmpty"])(t.contact_number)?"":this.constructPhoneNumber("home",t.contact_number),Notes:this.checkValue(t.customer_details.notes),"Home Address":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].address):"","Home Street":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].street):"","Home City":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].city):"","Home State":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].state):"","Home Area Code":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].postcode):"","Home Country":t.customer_details.home_address.length>0?this.checkValue(t.customer_details.home_address[0].country):""}},checkContactData:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.contactData=JSON.parse(z()(this.$store.state.CrmStore.contactData)),!Object(te["isEmpty"])(this.contactData)){t.next=10;break}if(this.contactData=void 0,!this.checkURLParamsID()){t.next=8;break}return t.next=6,this.setContactData();case 6:t.next=10;break;case 8:return this.toastInvalidIDNotification("contact"),t.abrupt("return",this.$router.push("/customers"));case 10:setTimeout(function(){e.fullName=e.constructFullName(),e.constructedAddress=e.constructAddress(),e.contactType=e.getDataFromStore("Contact Type","contact_type")},600);case 11:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},created:function(){this.headers=this.apiHeader(),this.checkContactData()},mounted:function(){this.setInsRendererLabel();var t=[Nt,Ot,{label:"View Contact",link:"#".concat(this.$route.path)}];InsitesUtil.setBreadCrumbs(t)}},Li=Oi,Fi=(i("b6c2"),Object(P["a"])(Li,Ni,Pi,!1,null,null,null)),ji=Fi.exports,Bi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"grid-container-full"},[i("div",{staticClass:"spacer small"}),i("div",{staticClass:"grid-x grid-margin-x margin-bottom-30"},[i("div",{staticClass:"large-4 medium-12 small-12 cell"},[i("SystemField",{attrs:{heading:"Company Type",type:"company_type"}})],1),i("div",{staticClass:"large-4 medium-12 small-12 cell"},[i("SystemField",{attrs:{heading:"Industry Type",type:"industry_type"}})],1),i("div",{staticClass:"large-4 medium-12 small-12 cell"},[i("SystemField",{attrs:{heading:"Contact Type",type:"contact_type"}})],1)]),i("div",{staticClass:"spacer large"})])},Mi=[],Hi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"system-field-wrap"},[i("h2",[t._v(t._s(t.heading))]),t.loading?t._e():i("ins-base-table",{ref:"systemFieldTable",attrs:{"without-search":"","static-table":""},on:{onPaginationChange:t.onPaginationChangeHandler}},[i("ins-base-table-row",[i("ins-base-table-td",[i("div",{staticClass:"new-system-field-wrap"},[i("InsInputWrap",{attrs:{placeholder:"Please enter "+t.heading},model:{value:t.newSystemField,callback:function(e){t.newSystemField=e},expression:"newSystemField"}}),i("ins-button",{ref:"newSystemFieldButton",attrs:{label:"Save",solid:"",loading:t.addingSystemField},on:{onClickInsButton:t.addSystemField}})],1)])],1),t._l(t.fields.results,function(e){return t.loading?t._e():i("ins-base-table-row",{key:e.id},[i("ins-base-table-td",{staticClass:"system-field-wrap__data"},[e.editMode?t._e():i("div",{staticClass:"view-mode"},[t._v("\n          "+t._s(e.value)+"\n        ")]),e.editMode?i("div",{staticClass:"edit-mode"},[i("InsInputWrap",{attrs:{placeholder:"Please enter "+t.heading},model:{value:e.tempValue,callback:function(i){t.$set(e,"tempValue",i)},expression:"field.tempValue"}}),i("div",{staticClass:"edit-mode__buttons"},[i("ins-button",{attrs:{label:"update",size:"small"},on:{onClickInsButton:function(i){return t.updateSystemField(e)}}}),i("ins-button",{attrs:{label:"cancel",size:"small"},on:{onClickInsButton:function(i){return t.cancelEditMode(e)}}})],1)],1):t._e(),e.editMode?t._e():i("div",{staticClass:"actions-wrap"},[i("button",{staticClass:"action edit",on:{click:function(i){return t.enableEditMode(e)}}},[t._v("\n            Edit\n          ")]),i("span",{staticClass:"seperator"},[t._v("|")]),i("button",{staticClass:"action archive",on:{click:function(i){return t.archiveSystemField(e)}}},[t._v("\n            Delete\n          ")])])])],1)})],2)],1)},Ui=[],Vi={name:"SystemField",mixins:[m],components:{InsInputWrap:At},props:{heading:String,type:String},data:function(){return{fields:{results:[]},loading:!1,newSystemField:"",addingSystemField:!1,pageNumber:1,pageSize:10,headers:{},sourceURL:"/api/customizations/",systemFieldModel:{form_configuration_name:"modules/insites_core/insites_add_system_fields",parent_resource_id:"modules/insites_core/insites_system_fields",form:{properties:{key:"",value:"",is_enabled:"true"}}}}},methods:{enableEditMode:function(t){t.editMode=!0},cancelEditMode:function(t){t.tempValue=t.value,t.editMode=!1},mutateSystemField:function(t,e,i){this.systemFieldModel.form.properties.key=this.type,this.systemFieldModel.form.properties.value=e.tempValue;var s="".concat(this.sourceURL).concat("put"===t?e.id:""),a=z()(this.systemFieldModel),n={headers:this.headers};this.$http[t](s,a,n).then(i).catch(this.errorHandler)},addSystemField:function(){var t=this;if(this.newSystemField){this.addingSystemField=!0,this.systemFieldModel.form.properties.is_enabled=!0;var e=this.newSystemField.toLowerCase();if("contact_type"===this.type&&"primary"===e&&"secondary"===e)this.addingSystemField=!1,toastIt("error","".concat(this.newSystemField," is a reserved system field for Contact Type."),this.ops);else{var i={tempValue:this.newSystemField};this.mutateSystemField("post",i,function(){setTimeout(function(){toastIt("success","New system field created successfully.",t.ops),t.addingSystemField=!1,t.newSystemField="",t.fetchSystemFields(),t.$store.dispatch("fetchSystemFields",t.type)},1e3)})}}else toastIt("error","Cannot add empty field.",this.ops)},updateSystemField:function(t){var e=this;t.tempValue?this.mutateSystemField("put",t,function(i){t.value=t.tempValue,t.editMode=!1,setTimeout(function(){e.$store.dispatch("fetchSystemFields",e.type)},1e3)}):toastIt("error","Cannot add empty field.",this.ops)},archiveSystemField:function(t){var e=this,i="Are you sure you want to delete this System Field?";swal({title:"",html:'\n          <ins-loader\n            state-icon="warning"\n            icon-color="warning"\n            state-message="'.concat(i,'">\n          </ins-loader>'),type:"",width:330,showCancelButton:!0,confirmButtonClass:"negative",confirmButtonText:"Delete"}).then(function(i){i.value&&(e.systemFieldModel.form.properties.is_enabled=!1,e.mutateSystemField("put",t,function(){setTimeout(function(){toastIt("success","System field has been deleted.",e.ops),e.fetchSystemFields(),e.$store.dispatch("fetchSystemFields",e.type)},1e3)}))})},onPaginationChangeHandler:function(t){this.pageNumber=t.detail.pageNumber,this.pageSize=t.detail.pageSize,this.fetchSystemFields()},fetchSystemFields:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,this.loaderStateHandler("","Loading system fields...","processing"),"/insites/api/get-system-fields-data.json?key=".concat(this.type,"&page=").concat(this.pageNumber,"&size=").concat(this.pageSize),t.next=5,k(this.type,this.pageNumber,this.pageSize);case 5:e=t.sent,e.state?(e.results.items.results.map(this.constructResults),this.fields=e.results.items):toastIt("error","Failed to load system fields.",this.ops),this.loading=!1,this.setupTable();case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),constructResults:function(t){return t.tempValue=t.value,t.editMode=!1,t},errorHandler:function(t){console.error("error...",t),this.addingSystemField=!1,toastIt("error","Failed to load System Fields.",this.ops)},loaderStateHandler:function(t,e,i){this.$refs.systemFieldTable.loadingScreen=!0,this.$refs.systemFieldTable.loaderTitle=t,this.$refs.systemFieldTable.loaderMessage=e,this.$refs.systemFieldTable.loaderIcon=i},setupTable:function(){var t=this;setTimeout(function(){t.$refs.systemFieldTable.totalCount=t.fields.total_entries,t.$refs.systemFieldTable.pageNumber=t.pageNumber,t.$refs.systemFieldTable.pageSize=t.pageSize,t.$refs.systemFieldTable.loadingScreen=!1},300)}},mounted:function(){this.headers=this.apiHeader(),this.fetchSystemFields()}},Wi=Vi,Ki=(i("2684"),Object(P["a"])(Wi,Hi,Ui,!1,null,null,null)),zi=Ki.exports,qi={name:"SystemFields",components:{SystemField:zi},data:function(){return{}},methods:{},mounted:function(){}},Yi=qi,Gi=Object(P["a"])(Yi,Bi,Mi,!1,null,null,null),Ji=Gi.exports,Xi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"grid-container-full"},[i("div",{staticClass:"grid-x margin-bottom-30"},[i("div",{staticClass:"large-4 medium-12 small-12 cell"},[i("div",{staticClass:"grid-x"},[i("div",{staticClass:"large-12 medium-12 small-12 cell"},[i("ins-card",{attrs:{steady:""}},[i("InsInputWrap",{attrs:{label:"Google Maps API Keys",placeholder:"Enter your API key here"},model:{value:t.tempGoogleMapsApiKey,callback:function(e){t.tempGoogleMapsApiKey=e},expression:"tempGoogleMapsApiKey"}})],1)],1),i("div",{staticClass:"large-12 medium-12 small-12 cell text-right api-key-button-wrap"},[i("ins-button",{attrs:{label:"SAVE",solid:"",loading:t.saving},on:{onClickInsButton:t.updateSystemFieldHandler}})],1)])])]),i("div",{staticClass:"spacer large"})])},Qi=[],Zi={name:"ApiKeys",mixins:[m],components:{InsInputWrap:At},computed:Object(Ct["b"])({googleMapsApiKey:function(t){return t.SystemFieldsStore.google_maps_api_key}}),data:function(){return{tempGoogleMapsApiKey:"",saving:!1,method:"post",headers:"",sourceURL:"/api/customizations/",systemFieldModel:{form_configuration_name:"modules/insites_core/insites_add_system_fields",parent_resource_id:"modules/insites_core/insites_system_fields",form:{properties:{key:"google_maps_api_key",value:"",is_enabled:"true"}}}}},watch:{googleMapsApiKey:function(){this.updateTempValue()}},methods:{updateSystemFieldHandler:function(){var t=this;this.saving=!0,this.systemFieldModel.form.properties.value=this.tempGoogleMapsApiKey;var e="".concat(this.sourceURL);"put"===this.method&&(e+="".concat(this.googleMapsApiKey.results[0].id));var i=z()(this.systemFieldModel),s={headers:this.headers};this.$http[this.method](e,i,s).then(function(e){toastIt("success","Successfully updated API Key",t.ops),setTimeout(function(){window.location.reload(!0)},1e3)}).catch(this.errorHandler)},errorHandler:function(t){console.error("error...",t),this.saving=!1,toastIt("error","Failed to update API Key",this.ops)},updateTempValue:function(){this.googleMapsApiKey.results.length&&(this.tempGoogleMapsApiKey=this.googleMapsApiKey.results[0].value,this.method="put")}},mounted:function(){this.headers=this.apiHeader(),this.updateTempValue()}},ts=Zi,es=(i("0a60"),Object(P["a"])(ts,Xi,Qi,!1,null,null,null)),is=es.exports,ss=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"grid-container-full"},[i("div",{staticClass:"grid-x"},[i("div",{staticClass:"error-wrap large-12 medium-12 small-12 cell"},[i("ins-card",{attrs:{steady:""}},[i("div",{staticClass:"text-center height-full vertical-align-middle"},[i("div",{staticClass:"small-12 cell"},[i("img",{staticClass:"margin-bottom-medium",attrs:{src:"https://uploads.staging.oregon.platform-os.com/instances/267/assets/modules/insites_core/insites_admin/images/error-404.svg?updated=1551331164",alt:"404 Page Not Found"}}),i("h2",[t._v("404 - Page Not Found")]),i("p",[t._v("The page you are looking for doesn't exist or another error occurred.")]),i("ins-button",{attrs:{label:"Go Back",type:"button",color:"blue",size:"normal",solid:"true"},on:{onClickInsButton:function(e){return t.backPage()}}})],1)])])],1)])])},as=[],ns={name:"PageNotFound",methods:{backPage:function(){this.$router.go(-1)},setInsRendererLabel:function(){var t=document.querySelector("ins-renderer"),e=this;setTimeout(function(){if(!t)return e.backPage();t.updateRouteLabel("")},500)}},mounted:function(){this.setInsRendererLabel()}},rs=ns,os=(i("f4b2"),Object(P["a"])(rs,ss,as,!1,null,null,null)),ls=os.exports;a["a"].use(n["a"]);var cs=new n["a"]({routes:[{path:"/overview",name:"overview",component:U},{path:"/admin-users",name:"adminUsers",component:pt},{path:"/manage-admin-user",name:"manageAdminUser",component:Ht},{path:"/edit-admin-user/:id?",name:"editAdminUser",component:Ht},{path:"/my-profile",name:"myProfile",component:qt},{path:"/customers",name:"Customers",component:ae},{path:"/manage-contact",name:"manageCRM",component:Oe},{path:"/edit-contact/:id?",name:"editCRM",component:Oe},{path:"/manage-company",name:"manageCompany",component:Ue},{path:"/edit-company/:id?",name:"editCompany",component:Ue},{path:"/cases",name:"Cases",component:Ye},{path:"/case-details/:id?",name:"CaseDetails",component:ti},{path:"/view-company/:id?",name:"ViewCompany",component:Ii},{path:"/view-contact/:id?",name:"ViewContact",component:ji},{path:"/system-fields",name:"SystemFields",component:Ji},{path:"/api-keys",name:"ApiKeys",component:is},{path:"/404",name:"404 Page Not Found",component:ls}]}),ds={state:{userData:{},formType:"",tempFormType:""},mutations:{pushUserData:function(t,e){t.userData=e},pushFormType:function(t,e){t.formType=e},pushTempFormType:function(t,e){t.tempFormType=e},pushFormName:function(t,e){t.formName=e},pushUserProfile:function(t,e){t.userProfile=e},resetAdminStore:function(t){t.formType="",t.tempFormType="",t.userData={}}}},us=ds,hs={state:{userData:{},companyData:{},contactData:{},formType:"",formName:"",userProfile:"",timeline:[],timelineId:"",activity:{attributes:{attendees_id:[],attendees:[],attachment:[],client_type:"",company_uuid:"",site_id:"",date:"",duration:"",entity_id:"",file_name:"",file_note:"",first_name:"",staff_id:"",last_name:"",notes:"",subject:"",time:"",type:"meeting"},type:"activities"},mode:"ADD",allCustomers:[],totalCountCustomers:0,addFromCompany:!1,companyOptions:[],mutatingCompanies:!1},mutations:{pushUserData:function(t,e){t.userData=e},pushFormType:function(t,e){t.formType=e},pushFormName:function(t,e){t.formName=e},pushUserProfile:function(t,e){t.userProfile=e},setActivity:function(t,e){t.activity=e},setMode:function(t,e){t.mode=e},setTimelineId:function(t,e){t.timelineId=e},setTimeline:function(t,e){t.timeline=e},setAddFromCompany:function(t,e){t.addFromCompany=e},setCompanyData:function(t,e){t.companyData=e},setContactData:function(t,e){t.contactData=e},setCompanyOptions:function(t,e){t.companyOptions=e.map(function(t){return{id:t.id,label:t.company_name}})},pushCompanyOption:function(t,e){t.mutatingCompanies=!0,t.companyOptions.push(e),setTimeout(function(){t.mutatingCompanies=!1},300)},removeCompanyOption:function(t,e){t.companyOptions.filter(function(t){return t.id!==e})}}},ms=hs,ps={state:{caseData:{},mode:"View"},mutations:{pushCaseData:function(t,e){t.caseData=e}}},fs=ps,_s={state:{contact_type:{results:[]},company_type:{results:[]},industry_type:{results:[]},google_maps_api_key:{results:[]},administratorList:{results:[]},swalContactTypes:{}},mutations:{setSystemField:function(t,e){t[e.type]=e.items,"google_maps_api_key"===e.type&&localStorage.setItem("google_maps_api_key",z()(e.items))},setSwalContactTypes:function(t,e){t.swalContactTypes["Secondary"]="Secondary",e.forEach(function(e){t.swalContactTypes[e.id]=e.value})},setAdministratorList:function(t,e){t.administratorList=e}},actions:{checkSystemFields:function(t,e){var i=e.value.results.items.results.length?e.value.results:{items:{results:[]}};t.commit("setSystemField",{type:e.type,items:i.items}),"contact_type"===e.datatype&&t.commit("setSwalContactTypes",i.items.results)}}},gs=_s,bs=[{value:"-1200@International Date Line West",useDaylightTime:"0",label:"(UTC-12:00) International Date Line West"},{value:"-1100@Midway Island, Samoa",useDaylightTime:"0",label:"(UTC-11:00) Midway Island, Samoa"},{value:"-1000@Hawaii",useDaylightTime:"0",label:"(UTC-10:00) Hawaii"},{value:"-0900@Alaska",useDaylightTime:"1",label:"(UTC-09:00) Alaska"},{value:"-0800@Pacific Time (US & Canada)",useDaylightTime:"1",label:"(UTC-08:00) Pacific Time (US & Canada)"},{value:"-0800@Tijuana, Baja California",useDaylightTime:"1",label:"(UTC-08:00) Tijuana, Baja California"},{value:"-0700@Arizona",useDaylightTime:"0",label:"(UTC-07:00) Arizona"},{value:"-0700@Chihuahua, La Paz, Mazatlan",useDaylightTime:"1",label:"(UTC-07:00) Chihuahua, La Paz, Mazatlan"},{value:"-0700@Mountain Time (US & Canada)",useDaylightTime:"1",label:"(UTC-07:00) Mountain Time (US & Canada)"},{value:"-0600@Central America",useDaylightTime:"0",label:"(UTC-06:00) Central America"},{value:"-0600@Central Time (US & Canada)",useDaylightTime:"1",label:"(UTC-06:00) Central Time (US & Canada)"},{value:"-0600@Guadalajara, Mexico City, Monterrey",useDaylightTime:"1",label:"(UTC-06:00) Guadalajara, Mexico City, Monterrey"},{value:"-0600@Saskatchewan",useDaylightTime:"0",label:"(UTC-06:00) Saskatchewan"},{value:"-0500@Bogota, Lima, Quito, Rio Branco",useDaylightTime:"0",label:"(UTC-05:00) Bogota, Lima, Quito, Rio Branco"},{value:"-0500@Eastern Time (US & Canada)",useDaylightTime:"1",label:"(UTC-05:00) Eastern Time (US & Canada)"},{value:"-0500@Indiana (East)",useDaylightTime:"1",label:"(UTC-05:00) Indiana (East)"},{value:"-0400@Atlantic Time (Canada)",useDaylightTime:"1",label:"(UTC-04:00) Atlantic Time (Canada)"},{value:"-0400@Caracas, La Paz",useDaylightTime:"0",label:"(UTC-04:00) Caracas, La Paz"},{value:"-0400@Manaus",useDaylightTime:"0",label:"(UTC-04:00) Manaus"},{value:"-0400@Santiago",useDaylightTime:"1",label:"(UTC-04:00) Santiago"},{value:"-0330@Newfoundland",useDaylightTime:"1",label:"(UTC-03:30) Newfoundland"},{value:"-0300@Brasilia",useDaylightTime:"1",label:"(UTC-03:00) Brasilia"},{value:"-0300@Buenos Aires, Georgetown",useDaylightTime:"0",label:"(UTC-03:00) Buenos Aires, Georgetown"},{value:"-0300@Greenland",useDaylightTime:"1",label:"(UTC-03:00) Greenland"},{value:"-0300@Montevideo",useDaylightTime:"1",label:"(UTC-03:00) Montevideo"},{value:"-0200@Mid-Atlantic",useDaylightTime:"1",label:"(UTC-02:00) Mid-Atlantic"},{value:"-0100@Cape Verde Is.",useDaylightTime:"0",label:"(UTC-01:00) Cape Verde Is."},{value:"-0100@Azores",useDaylightTime:"1",label:"(UTC-01:00) Azores"},{value:"+0000@Casablanca, Monrovia, Reykjavik",useDaylightTime:"0",label:"(UTC+00:00) Casablanca, Monrovia, Reykjavik"},{value:"+0000@Greenwich Mean Time : Dublin, Edinburgh, Lisbon, London",useDaylightTime:"1",label:"(UTC+00:00) Greenwich Mean Time : Dublin, Edinburgh, Lisbon, London"},{value:"+0100@Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna",useDaylightTime:"1",label:"(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna"},{value:"+0100@Belgrade, Bratislava, Budapest, Ljubljana, Prague",useDaylightTime:"1",label:"(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague"},{value:"+0100@Brussels, Copenhagen, Madrid, Paris",useDaylightTime:"1",label:"(UTC+01:00) Brussels, Copenhagen, Madrid, Paris"},{value:"+0100@Sarajevo, Skopje, Warsaw, Zagreb",useDaylightTime:"1",label:"(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb"},{value:"+0100@West Central Africa",useDaylightTime:"1",label:"(UTC+01:00) West Central Africa"},{value:"+0200@Amman",useDaylightTime:"1",label:"(UTC+02:00) Amman"},{value:"+0200@Athens, Bucharest, Istanbul",useDaylightTime:"1",label:"(UTC+02:00) Athens, Bucharest, Istanbul"},{value:"+0200@Beirut",useDaylightTime:"1",label:"(UTC+02:00) Beirut"},{value:"+0200@Cairo",useDaylightTime:"1",label:"(UTC+02:00) Cairo"},{value:"+0200@Harare, Pretoria",useDaylightTime:"0",label:"(UTC+02:00) Harare, Pretoria"},{value:"+0200@Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius",useDaylightTime:"1",label:"(UTC+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius"},{value:"+0200@Jerusalem",useDaylightTime:"1",label:"(UTC+02:00) Jerusalem"},{value:"+0200@Minsk",useDaylightTime:"1",label:"(UTC+02:00) Minsk"},{value:"+0200@Windhoek",useDaylightTime:"1",label:"(UTC+02:00) Windhoek"},{value:"+0300@Kuwait, Riyadh, Baghdad",useDaylightTime:"0",label:"(UTC+03:00) Kuwait, Riyadh, Baghdad"},{value:"+0300@Moscow, St. Petersburg, Volgograd",useDaylightTime:"1",label:"(UTC+03:00) Moscow, St. Petersburg, Volgograd"},{value:"+0300@Nairobi",useDaylightTime:"0",label:"(UTC+03:00) Nairobi"},{value:"+0300@Tbilisi",useDaylightTime:"0",label:"(UTC+03:00) Tbilisi"},{value:"+0330@Tehran",useDaylightTime:"1",label:"(UTC+03:30) Tehran"},{value:"+0400@Abu Dhabi, Muscat",useDaylightTime:"0",label:"(UTC+04:00) Abu Dhabi, Muscat"},{value:"+0400@Baku",useDaylightTime:"1",label:"(UTC+04:00) Baku"},{value:"+0400@Yerevan",useDaylightTime:"1",label:"(UTC+04:00) Yerevan"},{value:"+0430@Kabul",useDaylightTime:"0",label:"(UTC+04:30) Kabul"},{value:"+0500@Yekaterinburg",useDaylightTime:"1",label:"(UTC+05:00) Yekaterinburg"},{value:"+0500@Islamabad, Karachi, Tashkent",useDaylightTime:"0",label:"(UTC+05:00) Islamabad, Karachi, Tashkent"},{value:"+0530@Sri Jayawardenapura",useDaylightTime:"0",label:"(UTC+05:30) Sri Jayawardenapura"},{value:"+0530@Chennai, Kolkata, Mumbai, New Delhi",useDaylightTime:"0",label:"(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi"},{value:"+0545@Kathmandu",useDaylightTime:"0",label:"(UTC+05:45) Kathmandu"},{value:"+0600@Almaty, Novosibirsk",useDaylightTime:"1",label:"(UTC+06:00) Almaty, Novosibirsk"},{value:"+0600@Astana, Dhaka",useDaylightTime:"0",label:"(UTC+06:00) Astana, Dhaka"},{value:"+0630@Yangon (Rangoon)",useDaylightTime:"0",label:"(UTC+06:30) Yangon (Rangoon)"},{value:"+0700@Bangkok, Hanoi, Jakarta",useDaylightTime:"0",label:"(UTC+07:00) Bangkok, Hanoi, Jakarta"},{value:"+0700@Krasnoyarsk",useDaylightTime:"1",label:"(UTC+07:00) Krasnoyarsk"},{value:"+0800@Beijing, Chongqing, Hong Kong, Urumqi",useDaylightTime:"0",label:"(UTC+08:00) Beijing, Chongqing, Hong Kong, Urumqi"},{value:"+0800@Kuala Lumpur, Singapore",useDaylightTime:"0",label:"(UTC+08:00) Kuala Lumpur, Singapore"},{value:"+0800@Irkutsk, Ulaan Bataar",useDaylightTime:"0",label:"(UTC+08:00) Irkutsk, Ulaan Bataar"},{value:"+0800@Perth",useDaylightTime:"0",label:"(UTC+08:00) Perth"},{value:"+0800@Taipei",useDaylightTime:"0",label:"(UTC+08:00) Taipei"},{value:"+0900@Osaka, Sapporo, Tokyo",useDaylightTime:"0",label:"(UTC+09:00) Osaka, Sapporo, Tokyo"},{value:"+0900@Seoul",useDaylightTime:"0",label:"(UTC+09:00) Seoul"},{value:"+0900@Yakutsk",useDaylightTime:"1",label:"(UTC+09:00) Yakutsk"},{value:"+0930@Adelaide",useDaylightTime:"0",label:"(UTC+09:30) Adelaide"},{value:"+0930@Darwin",useDaylightTime:"0",label:"(UTC+09:30) Darwin"},{value:"+1000@Brisbane",useDaylightTime:"0",label:"(UTC+10:00) Brisbane"},{value:"+1000@Canberra, Melbourne, Sydney",useDaylightTime:"1",label:"(UTC+10:00) Canberra, Melbourne, Sydney"},{value:"+1000@Hobart",useDaylightTime:"1",label:"(UTC+10:00) Hobart"},{value:"+1000@Guam, Port Moresby",useDaylightTime:"0",label:"(UTC+10:00) Guam, Port Moresby"},{value:"+1000@Vladivostok",useDaylightTime:"1",label:"(UTC+10:00) Vladivostok"},{value:"+1100@Magadan, Solomon Is., New Caledonia",useDaylightTime:"1",label:"(UTC+11:00) Magadan, Solomon Is., New Caledonia"},{value:"+1200@Auckland, Wellington",useDaylightTime:"1",label:"(UTC+12:00) Auckland, Wellington"},{value:"+1200@Fiji, Kamchatka, Marshall Is.",useDaylightTime:"0",label:"(UTC+12:00) Fiji, Kamchatka, Marshall Is."},{value:"+1300@Nuku'alofa",useDaylightTime:"0",label:"(UTC+13:00) Nuku'alofa"}],vs={state:{settingsData:{date_format:"",time_format:"",time_zone:"",enable_dst:!1,enable_support:!1,support_url:"",branding_favicon:"",branding_logo:"",branding_name:"",branding_url:"",welcome_heading:"",welcome_subheading:""},fetchingSettingsData:!0,timezoneOptions:bs},mutations:{setSettingsAndBranding:function(t,e){var i=e[0];for(var s in i)i[s]?t.settingsData[s]="branding_logo"===s||"branding_favicon"===s?i[s]["original"]:i[s]:t.settingsData[s]=i[s];t.fetchingSettingsData=!1},setDefaults:function(t){t.settingsData.date_format="YYYY-MM-DD",t.settingsData.time_format="h:mm A",t.settingsData.time_zone=0,t.fetchingSettingsData=!1}},actions:{checkSettingsAndBrandingFields:function(t,e){var i;e.results.length?i=e.results[0]:(t.commit("setDefaults"),i=t.state.settingsData),t.commit("setSettingsAndBranding",i),localStorage.setItem("settingsData",z()(i))}}},ys=vs;a["a"].use(Ct["a"]);var Cs=new Ct["a"].Store({modules:{AdminStore:us,CrmStore:ms,CaseStore:fs,SystemFieldsStore:gs,SettingsBrandingStore:ys}}),Ds=["ins-card","ins-filter","ins-filter-item","ins-datepicker","ins-sparkline","ins-line-chart","ins-searchbar","ins-table","ins-tr","ins-th","ins-th-checkbox","ins-td","ins-td-checkbox","ins-action","ins-action-item","ins-loader","ins-button","ins-dropdown","ins-bar-chart","ins-radio","ins-toggle-switch","ins-input","ins-base-table","ins-base-table-row","ins-base-table-th","ins-base-table-td","ins-input-tel","ins-select","ins-select-option","ins-textarea","ins-image-picker","ins-backdrop","ins-heading"];a["a"].use(n["a"]),a["a"].use(c.a,o.a),a["a"].config.productionTip=!1,a["a"].config.ignoredElements=Object(s["a"])(Ds),new a["a"]({router:cs,store:Cs,render:function(t){return t(L)}}).$mount("#insites-core")},6373:function(t,e,i){"use strict";var s=i("29be"),a=i.n(s);a.a},"6d57":function(t,e,i){},7041:function(t,e,i){},7767:function(t,e,i){},7867:function(t,e,i){"use strict";var s=i("bb4e"),a=i.n(s);a.a},"860f":function(t,e,i){"use strict";var s=i("5327"),a=i.n(s);a.a},"913c":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var core_js_modules_es6_string_link__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("b54a"),core_js_modules_es6_string_link__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es6_string_link__WEBPACK_IMPORTED_MODULE_0__),_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_promise__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("795b"),_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_promise__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_promise__WEBPACK_IMPORTED_MODULE_1__),_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("e814"),_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es6_array_find__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("7514"),core_js_modules_es6_array_find__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es6_array_find__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es7_object_define_getter__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("4504"),core_js_modules_es7_object_define_getter__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es7_object_define_getter__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es7_object_lookup_getter__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("b9a1"),core_js_modules_es7_object_lookup_getter__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es7_object_lookup_getter__WEBPACK_IMPORTED_MODULE_5__),_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_array_is_array__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("a745"),_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_array_is_array__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_array_is_array__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("386d"),core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("6b54"),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("7f7f"),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("28a5"),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("ac6a"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_11__),_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("59ad"),_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("a481"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_13__),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("4917"),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_14__),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("3b2b"),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_15__),_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_object_keys__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("a4bb"),_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_object_keys__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_object_keys__WEBPACK_IMPORTED_MODULE_16__),_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("7618");!function(){var Ajax={settings:{},post:function(t){return new AjaxRequest("post",t)},get:function(t){return new AjaxRequest("get",t)}},AjaxRequest=function(t,e){var i={method:t,url:"",before:function(){},success:function(){},error:function(){},data:!1,async:!0,headers:{}};this.p=this.extend(i,e),this.p=this.extend(this.p,Ajax.settings),this.p.method=this.p.method.toUpperCase(),this.prepareData(),this.xhr=new XMLHttpRequest,this.xhr.open(this.p.method,this.p.url,this.p.async),this.setHeaders();var s="function"!=typeof this.p.before||this.p.before(this.xhr);!1!==s&&this.send()};AjaxRequest.prototype={extend:function(t,e){if(e)for(var i in e)t[i]=e[i];return t},prepareData:function(){"POST"!==this.p.method||this.isFormData()||(this.p.headers["Content-Type"]="application/x-www-form-urlencoded"),"object"!=Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(this.p.data)||this.isFormData()||(this.p.data=this.toParams(this.p.data)),"GET"===this.p.method&&(this.p.url=this.p.data?this.p.url+"?"+this.p.data:this.p.url)},setHeaders:function(){for(var t in this.xhr.setRequestHeader("X-Requested-With",this.p.headers["X-Requested-With"]||"XMLHttpRequest"),this.p.headers)this.xhr.setRequestHeader(t,this.p.headers[t])},isFormData:function(){return"undefined"!=typeof window.FormData&&this.p.data instanceof window.FormData},isComplete:function(){return!(this.xhr.status<200||this.xhr.status>=300&&304!==this.xhr.status)},send:function(){this.p.async?(this.xhr.onload=this.loaded.bind(this),this.xhr.send(this.p.data)):(this.xhr.send(this.p.data),this.loaded.call(this))},loaded:function(){if(this.isComplete()){var t=this.xhr.response,e=this.parseJson(t);t=e||t,"function"==typeof this.p.success&&this.p.success(t,this.xhr)}else"function"==typeof this.p.error&&this.p.error(this.xhr.statusText)},parseJson:function(t){try{var e=JSON.parse(t);if(e&&"object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(e))return e}catch(i){}return!1},toParams:function(t){return _Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_object_keys__WEBPACK_IMPORTED_MODULE_16___default()(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")}};var DomCache=[0],DomExpando="data"+ +new Date,DomHClass="is-hidden",DomHMClass="is-hidden-mobile",Dom=function(t,e){return this.parse(t,e)};Dom.ready=function(t){"loading"!=document.readyState?t():document.addEventListener("DOMContentLoaded",t)},Dom.prototype={get dom(){return!0},get length(){return this.nodes.length},parse:function(t,e){var i,s=/^\s*<(\w+|!)[^>]*>/;if(t){if(t.dom)return this.nodes=t.nodes,t;i="string"!=typeof t?t.nodeType&&11===t.nodeType?t.childNodes:t.nodeType||t===window?[t]:t:s.test(t)?this.create(t):this._query(t,e)}else i=[];this.nodes=this._slice(i)},create:function(t){if(/^<(\w+)\s*\/?>(?:<\/\1>|)$/.test(t))return[document.createElement(RegExp.$1)];var e=[],i=document.createElement("div"),s=i.childNodes;i.innerHTML=t;for(var a=0,n=s.length;n>a;a++)e.push(s[a]);return e},add:function(t){this.nodes=this.nodes.concat(this._toArray(t))},get:function(t){return this.nodes[t||0]||!1},getAll:function(){return this.nodes},eq:function(t){return new Dom(this.nodes[t])},first:function(){return new Dom(this.nodes[0])},last:function(){return new Dom(this.nodes[this.nodes.length-1])},contents:function(){return this.get().childNodes},each:function(t){for(var e=this.nodes.length,i=0;e>i;i++)t.call(this,this.nodes[i].dom?this.nodes[i].get():this.nodes[i],i);return this},is:function(t){return this.filter(t).length>0},filter:function(t){var e;return void 0===t?this:(e="function"==typeof t?t:function(e){return t instanceof Node?t===e:t&&t.dom?-1!==t.nodes.indexOf(e):(e.matches=e.matches||e.msMatchesSelector||e.webkitMatchesSelector,1===e.nodeType&&e.matches(t||"*"))},new Dom(this.nodes.filter(e)))},not:function(t){return this.filter(function(e){return!new Dom(e).is(t||!0)})},find:function(t){var e=[];return this.each(function(i){for(var s=this._query(t||"*",i),a=0;a<s.length;a++)e.push(s[a])}),new Dom(e)},children:function(t){var e=[];return this.each(function(t){if(t.children)for(var i=t.children,s=0;s<i.length;s++)e.push(i[s])}),new Dom(e).filter(t)},parent:function(t){var e=[];return this.each(function(t){t.parentNode&&e.push(t.parentNode)}),new Dom(e).filter(t)},parents:function(t,e){e=this._getContext(e);var i=[];return this.each(function(s){for(var a=s.parentNode;a&&a!==e;)t?new Dom(a).is(t)&&i.push(a):i.push(a),a=a.parentNode}),new Dom(i)},closest:function(t,e){e=this._getContext(e),t=t.dom?t.get():t;var i=[],s=t&&t.nodeType;return this.each(function(a){do{if(s&&a===t||new Dom(a).is(t))return i.push(a)}while((a=a.parentNode)&&a!==e)}),new Dom(i)},next:function(t){return this._getSibling(t,"nextSibling")},nextElement:function(t){return this._getSibling(t,"nextElementSibling")},prev:function(t){return this._getSibling(t,"previousSibling")},prevElement:function(t){return this._getSibling(t,"previousElementSibling")},css:function(t,e){if(void 0===e&&"object"!=Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(t)){var i=this.get();return"width"===t||"height"===t?i.style?this._getHeightOrWidth(t,i,!1)+"px":void 0:i.style?getComputedStyle(i,null)[t]:void 0}return this.each(function(i){var s={};for(var a in"object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(t)?s=t:s[t]=e,s)i.style&&(i.style[a]=s[a])})},attr:function(t,e,i){if(i=i?"data-":"",void 0===e&&"object"!=Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(t)){var s=this.get();return s&&3!==s.nodeType?"checked"===t?s.checked:this._getBooleanFromStr(s.getAttribute(i+t)):void 0}return this.each(function(s){var a={};for(var n in"object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(t)?a=t:a[t]=e,a)3!==s.nodeType&&("checked"===n?s.checked=a[n]:s.setAttribute(i+n,a[n]))})},data:function(t,e){if(void 0===t){var i=/^data\-(.+)$/,s=this.get().attributes,a={},n=function(t){return t[1].toUpperCase()};for(var r in s)if(i.test(s[r].nodeName)){var o=s[r].nodeName.match(i)[1],l=s[r].value;o=o.replace(/-([a-z])/g,n),l=this._isObjectString(l)?this._toObject(l):this._isNumber(l)?_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default()(l):this._getBooleanFromStr(l),a[o]=l}return a}return this.attr(t,e,!0)},val:function(t){if(void 0===t){var e=this.get();return e.type&&"checkbox"===e.type?e.checked:e.value}return this.each(function(e){e.value=t})},removeAttr:function(t){return this.each(function(e){var i=function(t){3!==e.nodeType&&e.removeAttribute(t)};t.split(" ").forEach(i)})},removeData:function(t){return this.each(function(e){var i=function(t){3!==e.nodeType&&e.removeAttribute("data-"+t)};t.split(" ").forEach(i)})},dataset:function(t,e){return this.each(function(i){DomCache[this.dataindex(i)][t]=e})},dataget:function(t){return DomCache[this.dataindex(this.get())][t]},dataindex:function(t){var e=t[DomExpando],i=DomCache.length;return e||(e=t[DomExpando]=i,DomCache[e]={}),e},addClass:function(t){return this._eachClass(t,"add")},removeClass:function(t){return this._eachClass(t,"remove")},toggleClass:function(t){return this._eachClass(t,"toggle")},hasClass:function(t){return this.nodes.some(function(e){return!!e.classList&&e.classList.contains(t)})},empty:function(){return this.each(function(t){t.innerHTML=""})},html:function(t){return void 0===t?this.get().innerHTML||"":this.empty().append(t)},text:function(t){return void 0===t?this.get().textContent||"":this.each(function(e){e.textContent=t})},after:function(t){return this._inject(t,function(t,e){if("string"==typeof t)e.insertAdjacentHTML("afterend",t);else for(var i=t instanceof Node?[t]:this._toArray(t).reverse(),s=0;s<i.length;s++)e.parentNode.insertBefore(i[s],e.nextSibling);return e})},before:function(t){return this._inject(t,function(t,e){if("string"==typeof t)e.insertAdjacentHTML("beforebegin",t);else for(var i=t instanceof Node?[t]:this._toArray(t),s=0;s<i.length;s++)e.parentNode.insertBefore(i[s],e);return e})},append:function(t){return this._inject(t,function(t,e){if("string"==typeof t||"number"==typeof t)e.insertAdjacentHTML("beforeend",t);else for(var i=t instanceof Node?[t]:this._toArray(t),s=0;s<i.length;s++)e.appendChild(i[s]);return e})},prepend:function(t){return this._inject(t,function(t,e){if("string"==typeof t||"number"==typeof t)e.insertAdjacentHTML("afterbegin",t);else for(var i=t instanceof Node?[t]:this._toArray(t).reverse(),s=0;s<i.length;s++)e.insertBefore(i[s],e.firstChild);return e})},wrap:function(t){return this._inject(t,function(t,e){var i="string"==typeof t||"number"==typeof t?this.create(t)[0]:t instanceof Node?t:this._toArray(t)[0];return e.parentNode&&e.parentNode.insertBefore(i,e),i.appendChild(e),new Dom(i)})},unwrap:function(){return this.each(function(t){var e=new Dom(t);return e.replaceWith(e.contents())})},replaceWith:function(t){return this._inject(t,function(t,e){for(var i=document.createDocumentFragment(),s="string"==typeof t||"number"==typeof t?this.create(t):t instanceof Node?[t]:this._toArray(t),a=0;a<s.length;a++)i.appendChild(s[a]);var n=i.childNodes[0];return e.parentNode.replaceChild(i,e),n})},remove:function(){return this.each(function(t){t.parentNode&&t.parentNode.removeChild(t)})},clone:function(t){var e=[];return this.each(function(i){var s=this._clone(i);t&&(s=this._cloneEvents(i,s)),e.push(s)}),new Dom(e)},show:function(){return this.each(function(t){if(t.style&&this._hasDisplayNone(t)){var e,i=t.getAttribute("domTargetShow"),s=!!t.classList&&t.classList.contains(DomHClass),a=!!t.classList&&t.classList.contains(DomHMClass);s?(e=DomHClass,t.classList.remove(DomHClass)):a?(e=DomHMClass,t.classList.remove(DomHMClass)):t.style.display=i||"block",e&&t.setAttribute("domTargetHide",e),t.removeAttribute("domTargetShow")}}.bind(this))},hide:function(){return this.each(function(t){if(t.style&&!this._hasDisplayNone(t)){var e=t.style.display,i=t.getAttribute("domTargetHide");i===DomHClass?t.classList.add(DomHClass):i===DomHMClass?t.classList.add(DomHMClass):("block"!==e&&t.setAttribute("domTargetShow",e),t.style.display="none"),t.removeAttribute("domTargetHide")}})},scrollTop:function(t){var e=this.get(),i=e===window,s=9===e.nodeType,a=s?document.scrollingElement||document.body.parentNode||document.body||document.documentElement:e;return void 0!==t?void(i?window.scrollTo(0,t):a.scrollTop=t):s?"undefined"!=typeof window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0:i?window.pageYOffset:a.scrollTop},offset:function(){return this._getDim("Offset")},position:function(){return this._getDim("Position")},width:function(t,e){return this._getSize("width","Width",t,e)},height:function(t,e){return this._getSize("height","Height",t,e)},outerWidth:function(){return this._getInnerOrOuter("width","outer")},outerHeight:function(){return this._getInnerOrOuter("height","outer")},innerWidth:function(){return this._getInnerOrOuter("width","inner")},innerHeight:function(){return this._getInnerOrOuter("height","inner")},click:function(){return this._triggerEvent("click")},focus:function(){return this._triggerEvent("focus")},trigger:function(t){return this.each(function(e){for(var i=t.split(" "),s=0;s<i.length;s++){var a,n={bubbles:!0,cancelable:!0};try{a=new window.CustomEvent(i[s],n)}catch(r){a=document.createEvent("CustomEvent"),a.initCustomEvent(i[s],!0,!0)}e.dispatchEvent(a)}})},on:function(t,e,i){return this.each(function(s){for(var a=t.split(" "),n=0;n<a.length;n++){var r=this._getEventName(a[n]),o=this._getEventNamespace(a[n]);e=i?this._getOneHandler(e,t):e,s.addEventListener(r,e),s._e=s._e||{},s._e[o]=s._e[o]||{},s._e[o][r]=s._e[o][r]||[],s._e[o][r].push(e)}})},one:function(t,e){return this.on(t,e,!0)},off:function(t,e){var i=function(t,e,i){return t===i},s=function(t,e,i,s){return e===s},a=function(t,e,i,s){return t===i&&e===s},n=function(){return!0};return void 0===t?this.each(function(t){this._offEvent(t,!1,!1,e,n)}):this.each(function(n){for(var r=t.split(" "),o=0;o<r.length;o++){var l=this._getEventName(r[o]),c=this._getEventNamespace(r[o]);"_events"===c?this._offEvent(n,l,c,e,i):l||"_events"===c?this._offEvent(n,l,c,e,a):this._offEvent(n,l,c,e,s)}})},serialize:function(t){for(var e={},i=this.get().elements,s=0;s<i.length;s++){var a=i[s];if((!/(checkbox|radio)/.test(a.type)||a.checked)&&a.name&&!a.disabled&&"file"!==a.type){if("select-multiple"===a.type)for(var n=0;n<a.options.length;n++){var r=a.options[n];r.selected&&(e[a.name]=r.value)}e[a.name]=this._isNumber(a.value)?_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default()(a.value):this._getBooleanFromStr(a.value)}}return t?e:this._toParams(e)},ajax:function(t,e){if("undefined"!=typeof AjaxRequest){var i=this.attr("method")||"post",s={url:this.attr("action"),data:this.serialize(),success:t,error:e};return new AjaxRequest(i,s)}},_queryContext:function(t,e){return e=this._getContext(e),3!==e.nodeType&&"function"==typeof e.querySelectorAll?e.querySelectorAll(t):[]},_query:function(t,e){if(e)return this._queryContext(t,e);if(/^[.#]?[\w-]*$/.test(t)){if("#"===t[0]){var i=document.getElementById(t.slice(1));return i?[i]:[]}return"."===t[0]?document.getElementsByClassName(t.slice(1)):document.getElementsByTagName(t)}return document.querySelectorAll(t)},_getContext:function(t){return t="string"==typeof t?document.querySelector(t):t,t&&t.dom?t.get():t||document},_inject:function(t,e){for(var i=this.nodes.length,s=[];i--;){var a="function"==typeof t?t.call(this,this.nodes[i]):t,n=0===i?a:this._clone(a),r=e.call(this,n,this.nodes[i]);r&&(r.dom?s.push(r.get()):s.push(r))}return new Dom(s)},_cloneEvents:function(t,e){var i=t._e;if(i)for(var s in e._e=i,i._events)for(var a=0;a<i._events[s].length;a++)e.addEventListener(s,i._events[s][a]);return e},_clone:function(t){return"undefined"!=typeof t?"string"==typeof t?t:t instanceof Node||t.nodeType?t.cloneNode(!0):"length"in t?[].map.call(this._toArray(t),function(t){return t.cloneNode(!0)}):void 0:void 0},_slice:function(t){return t&&0!==t.length?t.length?[].slice.call(t.nodes||t):[t]:[]},_eachClass:function(t,e){return this.each(function(i){if(t){var s=function(t){i.classList&&i.classList[e](t)};t.split(" ").forEach(s)}})},_triggerEvent:function(t){var e=this.get();return e&&3!==e.nodeType&&e[t](),this},_getOneHandler:function(t,e){var i=this;return function(){t.apply(this,arguments),i.off(e)}},_getEventNamespace:function(t){var e=t.split("."),i=e[1]?e[1]:"_events";return e[2]?i+e[2]:i},_getEventName:function(t){return t.split(".")[0]},_offEvent:function(t,e,i,s,a){for(var n in t._e)for(var r in t._e[n])if(a(r,n,e,i))for(var o=t._e[n][r],l=0;l<o.length;l++)"undefined"!=typeof s&&o[l].toString()!==s.toString()||(t.removeEventListener(r,o[l]),t._e[n][r].splice(l,1),0===t._e[n][r].length&&delete t._e[n][r],0===_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_object_keys__WEBPACK_IMPORTED_MODULE_16___default()(t._e[n]).length&&delete t._e[n])},_getInnerOrOuter:function(t,e){return this[t](void 0,e)},_getDocSize:function(t,e){var i=t.body,s=t.documentElement;return Math.max(i["scroll"+e],i["offset"+e],s["client"+e],s["scroll"+e],s["offset"+e])},_getSize:function(t,e,i,s){if(void 0===i){var a=this.get();return i=3===a.nodeType?0:9===a.nodeType?this._getDocSize(a,e):a===window?window["inner"+e]:this._getHeightOrWidth(t,a,s||"normal"),Math.round(i)}return this.each(function(e){i=_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default()(i),i+=this._adjustResultHeightOrWidth(t,e,s||"normal"),new Dom(e).css(t,i+"px")}.bind(this))},_getHeightOrWidth:function(t,e,i){if(!e)return 0;var s=t.charAt(0).toUpperCase()+t.slice(1),a=0,n=getComputedStyle(e,null),r=new Dom(e),o=r.parents().filter(function(t){return 1===t.nodeType&&"none"===getComputedStyle(t,null).display&&t});if("none"===n.display&&o.add(e),0!==o.length){var l="visibility: hidden !important; display: block !important;",c=[];o.each(function(t){var e=new Dom(t),i=e.attr("style");null!==i&&c.push(i),e.attr("style",null!==i?i+";"+l:l)}),a=r.get()["offset"+s]-this._adjustResultHeightOrWidth(t,e,i),o.each(function(t,e){var i=new Dom(t);void 0===c[e]?i.removeAttr("style"):i.attr("style",c[e])})}else a=e["offset"+s]-this._adjustResultHeightOrWidth(t,e,i);return a},_adjustResultHeightOrWidth:function(t,e,i){if(!e||!1===i)return 0;var s=0,a=getComputedStyle(e,null),n="border-box"===a.boxSizing;return"height"===t?(("inner"===i||"normal"===i&&n)&&(s+=(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default()(a.borderTopWidth)||0)+(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default()(a.borderBottomWidth)||0)),"outer"===i&&(s-=(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default()(a.marginTop)||0)+(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default()(a.marginBottom)||0))):(("inner"===i||"normal"===i&&n)&&(s+=(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default()(a.borderLeftWidth)||0)+(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default()(a.borderRightWidth)||0)),"outer"===i&&(s-=(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default()(a.marginLeft)||0)+(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default()(a.marginRight)||0))),s},_getDim:function(t){var e=this.get();return 3===e.nodeType?{top:0,left:0}:this["_get"+t](e)},_getPosition:function(t){return{top:t.offsetTop,left:t.offsetLeft}},_getOffset:function(t){var e=t.getBoundingClientRect(),i=t.ownerDocument,s=i.documentElement,a=i.defaultView;return{top:e.top+a.pageYOffset-s.clientTop,left:e.left+a.pageXOffset-s.clientLeft}},_getSibling:function(t,e){t=t&&t.dom?t.get():t;var i,s=t&&t.nodeType;return this.each(function(a){for(;a=a[e];)if(s&&a===t||new Dom(a).is(t))return void(i=a)}),new Dom(i)},_toArray:function(t){if(t instanceof NodeList){for(var e=[],i=0;i<t.length;i++)e[i]=t[i];return e}return void 0===t?[]:t.dom?t.nodes:t},_toParams:function(t){var e="";for(var i in t)e+="&"+this._encodeUri(i)+"="+this._encodeUri(t[i]);return e.replace(/^&/,"")},_toObject:function(t){return new Function("return "+t)()},_encodeUri:function(t){return encodeURIComponent(t).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},_isNumber:function(t){return!isNaN(t)&&!isNaN(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default()(t))},_isObjectString:function(t){return-1!==t.search(/^{/)},_getBooleanFromStr:function(t){return"true"===t||"false"!==t&&t},_hasDisplayNone:function(t){return"none"===t.style.display||"none"===(t.currentStyle?t.currentStyle.display:getComputedStyle(t,null).display)}};var uuid=0,$R=function(t,e){return RedactorApp(t,e,[].slice.call(arguments,2))};$R.app=[],$R.version="3.1.4",$R.options={},$R.modules={},$R.services={},$R.classes={},$R.plugins={},$R.mixins={},$R.modals={},$R.lang={},$R.dom=function(t,e){return new Dom(t,e)},$R.ajax=Ajax,$R.Dom=Dom,$R.keycodes={BACKSPACE:8,DELETE:46,UP:38,DOWN:40,ENTER:13,SPACE:32,ESC:27,TAB:9,CTRL:17,META:91,SHIFT:16,ALT:18,RIGHT:39,LEFT:37},$R.env={plugin:"plugins",module:"modules",service:"services",class:"classes",mixin:"mixins"},"undefined"!=typeof jQuery&&function(t){t.fn.redactor=function(t){return RedactorApp(this.toArray(),t,[].slice.call(arguments,1))}}(jQuery);var RedactorApp=function(t,e,i){for(var s,a="redactor",n=_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_array_is_array__WEBPACK_IMPORTED_MODULE_6___default()(t)?t:t&&t.nodeType?[t]:document.querySelectorAll(t),r="string"==typeof e||"function"==typeof e,o=[],l=0;l<n.length;l++){var c=n[l],d=$R.dom(c);if(s=d.dataget(a),s||r||(s=new App(c,e,uuid),d.dataset(a,s),$R.app[uuid]=s,uuid++),s&&r){var u,h="destroy"===e;e=h?"stop":e,"function"==typeof e?u=e.apply(s,i):(i.unshift(e),u=s.api.apply(s,i)),void 0!==u&&o.push(u),h&&d.dataset(a,!1)}}return 0===o.length||1===o.length?0===o.length?s:o[0]:o};$R.add=function(t,e,i){if("undefined"!=typeof $R.env[t])if(i.translations&&($R.lang=$R.extend(!0,{},$R.lang,i.translations)),i.modals&&($R.modals=$R.extend(!0,{},$R.modals,i.modals)),"mixin"===t)$R[$R.env[t]][e]=i;else{var s=function(){};if(s.prototype=i,i.mixins)for(var a=0;a<i.mixins.length;a++)$R.inherit(s,$R.mixins[i.mixins[a]]);$R[$R.env[t]][e]=s}},$R.addLang=function(t,e){"undefined"==typeof $R.lang[t]&&($R.lang[t]={}),$R.lang[t]=$R.extend($R.lang[t],e)},$R.create=function(t){var e=t.split("."),i=[].slice.call(arguments,1),s="classes";"undefined"!=typeof $R.env[e[0]]&&(s=$R.env[e[0]],t=e.slice(1).join("."));var a=new $R[s][t];if(a.init){var n=a.init.apply(a,i);return n||a}return a},$R.inherit=function(t,e){var i=function(){};i.prototype=e;var s=new i;for(var a in t.prototype)t.prototype.__lookupGetter__(a)?s.__defineGetter__(a,t.prototype.__lookupGetter__(a)):s[a]=t.prototype[a];return t.prototype=s,t.prototype["super"]=e,t},$R.error=function(t){throw t},$R.extend=function(){var t={},e=!1,i=0,s=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],i++);for(var a=function(i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e&&"[object Object]"===Object.prototype.toString.call(i[s])?t[s]=$R.extend(!0,t[s],i[s]):t[s]=i[s])};s>i;i++){var n=arguments[i];a(n)}return t},$R.opts={animation:!0,lang:"en",direction:"ltr",spellcheck:!0,structure:!1,scrollTarget:!1,styles:!0,stylesClass:"redactor-styles",placeholder:!1,source:!0,showSource:!1,inline:!1,breakline:!1,markup:"p",enterKey:!0,clickToEdit:!1,clickToSave:!1,clickToCancel:!1,focus:!1,focusEnd:!1,minHeight:!1,maxHeight:!1,maxWidth:!1,plugins:[],callbacks:{},preClass:!1,preSpaces:4,tabindex:!1,tabAsSpaces:!1,tabKey:!0,autosave:!1,autosaveName:!1,autosaveData:!1,toolbar:!0,toolbarFixed:!0,toolbarFixedTarget:document,toolbarFixedTopOffset:0,toolbarExternal:!1,toolbarContext:!0,air:!1,formatting:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],formattingAdd:!1,formattingHide:!1,buttons:["html","format","bold","italic","deleted","lists","image","file","link"],buttonsTextLabeled:!1,buttonsAdd:[],buttonsAddFirst:[],buttonsAddAfter:!1,buttonsAddBefore:!1,buttonsHide:[],buttonsHideOnMobile:[],imageUpload:!1,imageUploadParam:"file",imageData:!1,imageEditable:!0,imageCaption:!0,imageLink:!0,imagePosition:!1,imageResizable:!1,imageFloatMargin:"10px",imageFigure:!0,fileUpload:!1,fileUploadParam:"file",fileData:!1,fileAttachment:!1,uploadData:!1,dragUpload:!0,multipleUpload:!0,clipboardUpload:!0,uploadBase64:!1,linkTarget:!1,linkTitle:!1,linkNewTab:!1,linkNofollow:!1,linkSize:30,linkValidation:!0,cleanOnEnter:!0,cleanInlineOnEnter:!1,paragraphize:!0,removeScript:!0,removeNewLines:!1,removeComments:!0,replaceTags:{b:"strong",i:"em",strike:"del"},pastePlainText:!1,pasteLinkTarget:!1,pasteImages:!0,pasteLinks:!0,pasteClean:!0,pasteKeepStyle:[],pasteKeepClass:[],pasteKeepAttrs:["td","th"],pasteBlockTags:["pre","h1","h2","h3","h4","h5","h6","table","tbody","thead","tfoot","th","tr","td","ul","ol","li","blockquote","p","figure","figcaption"],pasteInlineTags:["a","img","br","strong","ins","code","del","span","samp","kbd","sup","sub","mark","var","cite","small","b","u","em","i","abbr"],activeButtons:{b:"bold",strong:"bold",i:"italic",em:"italic",del:"deleted",strike:"deleted",u:"underline"},activeButtonsAdd:{},activeButtonsObservers:{},autoparse:!0,autoparseStart:!0,autoparsePaste:!0,autoparseLinks:!0,autoparseImages:!0,autoparseVideo:!0,shortcodes:{"p.":{format:"p"},"quote.":{format:"blockquote"},"pre.":{format:"pre"},"h1.":{format:"h1"},"h2.":{format:"h2"},"h3.":{format:"h3"},"h4.":{format:"h4"},"h5.":{format:"h5"},"h6.":{format:"h6"},"*.":{format:"ul"}},shortcodesAdd:!1,shortcuts:{"ctrl+shift+m, meta+shift+m":{api:"module.inline.clearformat"},"ctrl+b, meta+b":{api:"module.inline.format",args:"b"},"ctrl+i, meta+i":{api:"module.inline.format",args:"i"},"ctrl+u, meta+u":{api:"module.inline.format",args:"u"},"ctrl+h, meta+h":{api:"module.inline.format",args:"sup"},"ctrl+l, meta+l":{api:"module.inline.format",args:"sub"},"ctrl+k, meta+k":{api:"module.link.open"},"ctrl+alt+0, meta+alt+0":{api:"module.block.format",args:"p"},"ctrl+alt+1, meta+alt+1":{api:"module.block.format",args:"h1"},"ctrl+alt+2, meta+alt+2":{api:"module.block.format",args:"h2"},"ctrl+alt+3, meta+alt+3":{api:"module.block.format",args:"h3"},"ctrl+alt+4, meta+alt+4":{api:"module.block.format",args:"h4"},"ctrl+alt+5, meta+alt+5":{api:"module.block.format",args:"h5"},"ctrl+alt+6, meta+alt+6":{api:"module.block.format",args:"h6"},"ctrl+shift+7, meta+shift+7":{api:"module.list.toggle",args:"ol"},"ctrl+shift+8, meta+shift+8":{api:"module.list.toggle",args:"ul"}},shortcutsAdd:!1,grammarly:!0,bufferLimit:100,emptyHtml:"<p></p>",markerChar:"\ufeff",imageTypes:["image/png","image/jpeg","image/gif"],inlineTags:["a","span","strong","strike","b","u","em","i","code","del","ins","samp","kbd","sup","sub","mark","var","cite","small","abbr"],blockTags:["pre","ul","ol","li","p","h1","h2","h3","h4","h5","h6","dl","dt","dd","div","table","tbody","thead","tfoot","tr","th","td","blockquote","output","figcaption","figure","address","section","header","footer","aside","article","iframe"],regex:{youtube:/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube\.com\S*[^\w\-\s])([\w\-]{11})(?=[^\w\-]|$)(?![?=&+%\w.-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,vimeo:/(http|https)?:\/\/(?:www.|player.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/|)(\d+)(?:[a-zA-Z0-9_-]+)?/gi,imageurl:/((https?|www)[^\s]+\.)(jpe?g|png|gif)(\?[^\s-]+)?/gi,url:/(https?:\/\/(?:www\.|(?!www))[^\s\.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/gi},input:!0,zindex:!1,modes:{inline:{pastePlainText:!0,pasteImages:!1,enterKey:!1,toolbar:!1,autoparse:!1,source:!1,showSource:!1,styles:!1,air:!1},original:{styles:!1}}},$R.lang.en={format:"Format",image:"Image",file:"File",link:"Link",bold:"Bold",italic:"Italic",deleted:"Strikethrough",underline:"Underline",superscript:"Superscript",subscript:"Subscript","bold-abbr":"B","italic-abbr":"I","deleted-abbr":"S","underline-abbr":"U","superscript-abbr":"Sup","subscript-abbr":"Sub",lists:"Lists","link-insert":"Insert Link","link-edit":"Edit Link","link-in-new-tab":"Open link in new tab",unlink:"Unlink",cancel:"Cancel",close:"Close",insert:"Insert",save:"Save",delete:"Delete",text:"Text",edit:"Edit",title:"Title",paragraph:"Normal text",quote:"Quote",code:"Code",heading1:"Heading 1",heading2:"Heading 2",heading3:"Heading 3",heading4:"Heading 4",heading5:"Heading 5",heading6:"Heading 6",filename:"Name",optional:"optional",unorderedlist:"Unordered List",orderedlist:"Ordered List",outdent:"Outdent",indent:"Indent",horizontalrule:"Line",upload:"Upload","upload-label":"Drop files here or click to upload","accessibility-help-label":"Rich text editor",caption:"Caption",bulletslist:"Bullets",numberslist:"Numbers","image-position":"Position",none:"None",left:"Left",right:"Right",center:"Center",undo:"Undo",redo:"Redo"},$R.buttons={html:{title:"HTML",icon:!0,api:"module.source.toggle"},undo:{title:"## undo ##",icon:!0,api:"module.buffer.undo"},redo:{title:"## redo ##",icon:!0,api:"module.buffer.redo"},format:{title:"## format ##",icon:!0,dropdown:{p:{title:"## paragraph ##",api:"module.block.format",args:{tag:"p"}},blockquote:{title:"## quote ##",api:"module.block.format",args:{tag:"blockquote"}},pre:{title:"## code ##",api:"module.block.format",args:{tag:"pre"}},h1:{title:"## heading1 ##",api:"module.block.format",args:{tag:"h1"}},h2:{title:"## heading2 ##",api:"module.block.format",args:{tag:"h2"}},h3:{title:"## heading3 ##",api:"module.block.format",args:{tag:"h3"}},h4:{title:"## heading4 ##",api:"module.block.format",args:{tag:"h4"}},h5:{title:"## heading5 ##",api:"module.block.format",args:{tag:"h5"}},h6:{title:"## heading6 ##",api:"module.block.format",args:{tag:"h6"}}}},bold:{title:"## bold-abbr ##",icon:!0,tooltip:"## bold ##",api:"module.inline.format",args:{tag:"b"}},italic:{title:"## italic-abbr ##",icon:!0,tooltip:"## italic ##",api:"module.inline.format",args:{tag:"i"}},deleted:{title:"## deleted-abbr ##",icon:!0,tooltip:"## deleted ##",api:"module.inline.format",args:{tag:"del"}},underline:{title:"## underline-abbr ##",icon:!0,tooltip:"## underline ##",api:"module.inline.format",args:{tag:"u"}},sup:{title:"## superscript-abbr ##",icon:!0,tooltip:"## superscript ##",api:"module.inline.format",args:{tag:"sup"}},sub:{title:"## subscript-abbr ##",icon:!0,tooltip:"## subscript ##",api:"module.inline.format",args:{tag:"sub"}},lists:{title:"## lists ##",icon:!0,observe:"list",dropdown:{observe:"list",unorderedlist:{title:"&bull; ## unorderedlist ##",api:"module.list.toggle",args:"ul"},orderedlist:{title:"1. ## orderedlist ##",api:"module.list.toggle",args:"ol"},outdent:{title:"< ## outdent ##",api:"module.list.outdent"},indent:{title:"> ## indent ##",api:"module.list.indent"}}},ul:{title:"&bull; ## bulletslist ##",icon:!0,api:"module.list.toggle",observe:"list",args:"ul"},ol:{title:"1. ## numberslist ##",icon:!0,api:"module.list.toggle",observe:"list",args:"ol"},outdent:{title:"## outdent ##",icon:!0,api:"module.list.outdent",observe:"list"},indent:{title:"## indent ##",icon:!0,api:"module.list.indent",observe:"list"},image:{title:"## image ##",icon:!0,api:"module.image.open"},file:{title:"## file ##",icon:!0,api:"module.file.open"},link:{title:"## link ##",icon:!0,observe:"link",dropdown:{observe:"link",link:{title:"## link-insert ##",api:"module.link.open"},unlink:{title:"## unlink ##",api:"module.link.unlink"}}},line:{title:"## horizontalrule ##",icon:!0,api:"module.line.insert"}};var App=function(t,e,i){this.module={},this.plugin={},this.instances={},this.started=!1,this.stopped=!1,this.uuid=i,this.rootElement=t,this.rootOpts=e,this.dragInside=!1,this.dragComponentInside=!1,this.keycodes=$R.keycodes,this.namespace="redactor",this.$win=$R.dom(window),this.$doc=$R.dom(document),this.$body=$R.dom("body"),this.editorReadOnly=!1,this.opts=$R.create("service.options",e,t),this.lang=$R.create("service.lang",this),this.buildServices(),this.buildModules(),this.buildPlugins(),this.start()};App.prototype={start:function(){this.stopped=!1,this.broadcast("start"),this.broadcast("startcode"),this.opts.clickToEdit?this.broadcast("startclicktoedit"):(this.broadcast("enable"),this.opts.showSource&&this.broadcast("startcodeshow"),this.broadcast("enablefocus")),this.broadcast("started"),this.started=!0},stop:function(){this.started=!1,this.stopped=!0,this.broadcast("stop"),this.broadcast("disable"),this.broadcast("stopped")},isStarted:function(){return this.started},isStopped:function(){return this.stopped},buildServices:function(){var t=["options","lang"],e=["uuid","keycodes","opts","lang","$win","$doc","$body"],i=[];for(var s in $R.services)-1===t.indexOf(s)&&(this[s]=$R.create("service."+s,this),i.push(s),e.push(s));for(var a=0;a<i.length;a++)for(var n=i[a],r=0;r<e.length;r++){var o=e[r];n!==o&&(this[n][o]=this[o])}},buildModules:function(){for(var t in $R.modules)this.module[t]=$R.create("module."+t,this),this.instances[t]=this.module[t]},buildPlugins:function(){for(var t=this.opts.plugins,e=0;e<t.length;e++){var i=t[e];"undefined"!=typeof $R.plugins[i]&&(this.plugin[i]=$R.create("plugin."+i,this),this.instances[i]=this.plugin[i])}},isDragInside:function(){return this.dragInside},setDragInside:function(t){this.dragInside=t},isDragComponentInside:function(){return this.dragComponentInside},setDragComponentInside:function(t){this.dragComponentInside=t},getDragComponentInside:function(){return this.dragComponentInside},isReadOnly:function(){return this.editorReadOnly},enableReadOnly:function(){this.editorReadOnly=!0,this.broadcast("enablereadonly"),this.component.clearActive(),this.toolbar.disableButtons()},disableReadOnly:function(){this.editorReadOnly=!1,this.broadcast("disablereadonly"),this.toolbar.enableButtons()},callMessageHandler:function(t,e,i){var s=e.split(".");if(1===s.length)"function"==typeof t["on"+e]&&t["on"+e].apply(t,i);else{s[0]="on"+s[0];var a=this.utils.checkProperty(t,s);"function"==typeof a&&a.apply(t,i)}},broadcast:function(t){var e=[].slice.call(arguments,1);for(var i in this.instances)this.callMessageHandler(this.instances[i],t,e);return this.callback.trigger(t,e)},on:function(t,e){this.callback.add(t,e)},off:function(t,e){this.callback.remove(t,e)},api:function(t){if((this.isStarted()||"start"===t)&&(!this.isReadOnly()||"disableReadOnly"===t)){this.broadcast("state");var e=[].slice.call(arguments,1),i=t.split("."),s=1===i.length,a="on"===i[0]||"off"===i[0],n=!a&&2===i.length,r="plugin"===i[0],o="module"===i[0];if(s){if("function"==typeof this[i[0]])return this.callInstanceMethod(this,i[0],e)}else{if(a)return"on"===i[0]?this.on(i[1],e[0]):this.off(i[1],e[0]||void 0);if(n){if(this.isInstanceExists(this,i[0]))return this.callInstanceMethod(this[i[0]],i[1],e);$R.error(new Error('Service "'+i[0]+'" not found'))}else if(r){if(this.isInstanceExists(this.plugin,i[1]))return this.callInstanceMethod(this.plugin[i[1]],i[2],e);$R.error(new Error('Plugin "'+i[1]+'" not found'))}else if(o){if(this.isInstanceExists(this.module,i[1]))return this.callInstanceMethod(this.module[i[1]],i[2],e);$R.error(new Error('Module "'+i[1]+'" not found'))}}}},isInstanceExists:function(t,e){return"undefined"!=typeof t[e]},callInstanceMethod:function(t,e,i){return"function"==typeof t[e]?t[e].apply(t,i):void 0}},$R.add("mixin","formatter",{buildArgs:function(t){this.args={class:t["class"]||!1,style:t.style||!1,attr:t.attr||!1},this.args["class"]||this.args.style||this.args.attr||(this.args=!1)},applyArgs:function(t,e){return this.args?this[this.type](this.args,!1,t,e):this._clearAll(t,e)},clearClass:function(t,e){this.selection.save();var i=e?$R.dom(e):this.getElements(t,!0);return i.removeAttr("class"),e=this._unwrapSpanWithoutAttr(i.getAll()),this.selection.restore(),e},clearStyle:function(t,e){this.selection.save();var i=e?$R.dom(e):this.getElements(t,!0);return i.removeAttr("style"),e=this._unwrapSpanWithoutAttr(i.getAll()),this.selection.restore(),e},clearAttr:function(t,e){this.selection.save();var i=e?$R.dom(e):this.getElements(t,!0);return this._removeAllAttr(i),e=this._unwrapSpanWithoutAttr(i.getAll()),this.selection.restore(),e},set:function(t,e,i,s){!1!==s&&this.selection.save();var a=i?$R.dom(i):this.getElements(e);return t["class"]&&(a.removeAttr("class"),a.addClass(t["class"])),t.style&&(a.removeAttr("style"),a.css(t.style),a.each(function(t){var e=$R.dom(t);e.attr("data-redactor-style-cache",e.attr("style"))})),t.attr&&(this._removeAllAttr(a),a.attr(t.attr)),!1!==s&&this.selection.restore(),a.getAll()},toggle:function(t,e,i,s){!1!==s&&this.selection.save();var a,n=i?$R.dom(i):this.getElements(e);return t["class"]&&(n.toggleClass(t["class"]),n.each(function(t){""===t.className&&t.removeAttribute("class")})),t.style&&(a=t.style,n.each(function(t){var e=$R.dom(t);for(var i in a){var s=a[i],n=e.css(i);n=this.utils.isRgb(n)?this.utils.rgb2hex(n):n.replace(/"/g,""),s=this.utils.isRgb(s)?this.utils.rgb2hex(s):s.replace(/"/g,""),n=this.utils.hex2long(n),s=this.utils.hex2long(s);var r="string"==typeof s?s.toLowerCase():s,o="string"==typeof n?n.toLowerCase():n;r===o?e.css(i,""):e.css(i,s)}this._convertStyleQuotes(e),this.utils.removeEmptyAttr(t,"style")?e.removeAttr("data-redactor-style-cache"):e.attr("data-redactor-style-cache",e.attr("style"))}.bind(this))),t.attr&&(a=t.attr,n.each(function(t){var e=$R.dom(t);for(var i in a)e.attr(i)?e.removeAttr(i):e.attr(i,a[i])})),!1!==s&&this.selection.restore(),n.getAll()},add:function(t,e,i,s){!1!==s&&this.selection.save();var a=i?$R.dom(i):this.getElements(e);if(t["class"]&&a.addClass(t["class"]),t.style){var n=t.style;a.each(function(t){var e=$R.dom(t);e.css(n),e.attr("data-redactor-style-cache",e.attr("style")),this._convertStyleQuotes(e)}.bind(this))}return t.attr&&a.attr(t.attr),!1!==s&&this.selection.restore(),a.getAll()},remove:function(t,e,i,s){!1!==s&&this.selection.save();var a=i?$R.dom(i):this.getElements(e);if(t["class"]&&(a.removeClass(t["class"]),a.each(function(t){""===t.className&&t.removeAttribute("class")})),t.style){var n=t.style;a.each(function(t){var e=$R.dom(t);e.css(n,""),this.utils.removeEmptyAttr(t,"style")?e.removeAttr("data-redactor-style-cache"):e.attr("data-redactor-style-cache",e.attr("style"))}.bind(this))}return t.attr&&a.removeAttr(t.attr),i=this._unwrapSpanWithoutAttr(a.getAll()),!1!==s&&this.selection.restore(),i},_removeAllAttr:function(t){t.each(function(t){for(var e=t.attributes.length;e-- >0;){var i=t.attributes[e],s=i.name;"style"!==s&&"class"!==s&&t.removeAttributeNode(i)}})},_convertStyleQuotes:function(t){var e=t.attr("style");e&&t.attr("style",e.replace(/"/g,"'"))},_clearAll:function(t,e){!1!==e&&this.selection.save();for(var i=0;i<t.length;i++)for(var s=t[i];s.attributes.length>0;)s.removeAttribute(s.attributes[0].name);return t=this._unwrapSpanWithoutAttr(t),!1!==e&&this.selection.restore(),t},_unwrapSpanWithoutAttr:function(t){for(var e=[],i=0;i<t.length;i++){var s=t[i],a=s.attributes.length;0>=a&&3!==s.nodeType&&"SPAN"===s.tagName?$R.dom(s).unwrap():e.push(s)}return e}}),$R.add("mixin","dom",$R.Dom.prototype),$R.add("mixin","component",{get cmnt(){return!0}}),$R.add("service","options",{init:function(t,e){var i=$R.dom(e),s=$R.extend({},$R.opts,e?i.data():{},$R.options);return $R.extend(!0,s,t)}}),$R.add("service","lang",{init:function(t){this.app=t,this.opts=t.opts,this.vars=this._build(this.opts.lang)},rebuild:function(t){this.opts.lang=t,this.vars=this._build(t)},extend:function(t){this.vars=$R.extend(this.vars,t)},parse:function(t){if(void 0===t)return"";var e=t.match(/## (.*?) ##/g);if(e)for(var i=0;i<e.length;i++){var s=e[i].replace(/^##\s/g,"").replace(/\s##$/g,"");t=t.replace(e[i],this.get(s))}return t},get:function(t){var e="";return"undefined"!=typeof this.vars[t]?e=this.vars[t]:"en"!==this.opts.lang&&"undefined"!=typeof $R.lang.en[t]&&(e=$R.lang.en[t]),e},_build:function(t){var e=$R.lang.en;return"en"!==t&&(e=void 0!==$R.lang[t]?$R.lang[t]:e),e}}),$R.add("service","callback",{init:function(t){this.app=t,this.opts=t.opts,this.callbacks={},this.opts.callbacks&&this._set(this.opts.callbacks,"")},stop:function(){this.callbacks={}},add:function(t,e){this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e)},remove:function(t,e){if(void 0===e)delete this.callbacks[t];else{for(var i=0;i<this.callbacks[t].length;i++)this.callbacks[t].splice(i,1);0===_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_object_keys__WEBPACK_IMPORTED_MODULE_16___default()(this.callbacks[t]).length&&delete this.callbacks[t]}},trigger:function(t,e){var i=this._loop(t,e,this.callbacks);return"undefined"==typeof i&&e&&!1!==e[0]?e[0]:i},_set:function(t,e){for(var i in t){var s=""===e?i:e+"."+i;"object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(t[i])?this._set(t[i],s):(this.callbacks[s]=[],this.callbacks[s].push(t[i]))}},_loop:function(t,e,i){var s;for(var a in i)if(t===a)for(var n=0;n<i[a].length;n++)s=i[a][n].apply(this.app,e);return s}}),$R.add("service","animate",{init:function(t){this.animationOpt=t.opts.animation},start:function(t,e,i,s){var a={duration:!1,iterate:!1,delay:!1,timing:!1,prefix:"redactor-"};return a="function"==typeof i?a:$R.extend(a,i),s="function"==typeof i?i:s,new $R.AnimatePlay(t,e,a,s,this.animationOpt)},stop:function(t){this.$el=$R.dom(t),this.$el.removeClass("redactor-animated");var e=this.$el.attr("redactor-animate-effect");this.$el.removeClass(e),this.$el.removeAttr("redactor-animate-effect");var i=this.$el.attr("redactor-animate-hide");i&&this.$el.addClass(i).removeAttr("redactor-animate-hide"),this.$el.off("animationend webkitAnimationEnd")}}),$R.AnimatePlay=function(t,e,i,s,a){return this.hidableEffects=["fadeOut","flipOut","slideUp","zoomOut","slideOutUp","slideOutRight","slideOutLeft"],this.prefixes=["","-webkit-"],this.$el=$R.dom(t),this.$body=$R.dom("body"),this.callback=s,this.animation=a?e:this.buildAnimationOff(e),this.defaults=i,"slideUp"===this.animation&&this.$el.height(this.$el.height()),this.isInanimate()?this.inanimate():this.animate()},$R.AnimatePlay.prototype={buildAnimationOff:function(t){return this.isHidable(t)?"hide":"show"},buildHideClass:function(){return"redactor-animate-hide"},isInanimate:function(){return"show"===this.animation||"hide"===this.animation},isAnimated:function(){return this.$el.hasClass("redactor-animated")},isHidable:function(t){return-1!==this.hidableEffects.indexOf(t)},inanimate:function(){var t;return this.defaults.timing="linear","show"===this.animation?(t=this.buildHideClass(),this.$el.attr("redactor-animate-hide",t),this.$el.removeClass(t)):(t=this.$el.attr("redactor-animate-hide"),this.$el.addClass(t).removeAttr("redactor-animate-hide")),"function"==typeof this.callback&&this.callback(this),this},animate:function(){var t=this.defaults.delay?this.defaults.delay:0;return setTimeout(function(){if(this.$body.addClass("no-scroll-x"),this.$el.addClass("redactor-animated"),!this.$el.attr("redactor-animate-hide")){var t=this.buildHideClass();this.$el.attr("redactor-animate-hide",t),this.$el.removeClass(t)}this.$el.addClass(this.defaults.prefix+this.animation),this.$el.attr("redactor-animate-effect",this.defaults.prefix+this.animation),this.set(this.defaults.duration+"s",this.defaults.iterate,this.defaults.timing),this.complete()}.bind(this),1e3*t),this},set:function(t,e,i){for(var s=this.prefixes.length;s--;)!1===t&&""!==t||this.$el.css(this.prefixes[s]+"animation-duration",t),!1===e&&""!==e||this.$el.css(this.prefixes[s]+"animation-iteration-count",e),!1===i&&""!==i||this.$el.css(this.prefixes[s]+"animation-timing-function",i)},clean:function(){this.$body.removeClass("no-scroll-x"),this.$el.removeClass("redactor-animated"),this.$el.removeClass(this.defaults.prefix+this.animation),this.$el.removeAttr("redactor-animate-effect"),this.set("","","")},complete:function(){this.$el.one("animationend webkitAnimationEnd",function(){if(this.$el.hasClass(this.defaults.prefix+this.animation)&&this.clean(),this.isHidable(this.animation)){var t=this.$el.attr("redactor-animate-hide");this.$el.addClass(t).removeAttr("redactor-animate-hide")}"slideUp"===this.animation&&this.$el.height(""),"function"==typeof this.callback&&this.callback(this.$el)}.bind(this))}},$R.add("service","caret",{init:function(t){this.app=t},setStart:function(t){this._setCaret("Start",t)},setEnd:function(t){this._setCaret("End",t)},setBefore:function(t){this._setCaret("Before",t)},setAfter:function(t){this._setCaret("After",t)},isStart:function(t){return this._isStartOrEnd(t,"First")},isEnd:function(t){return this._isStartOrEnd(t,"Last")},setAtEnd:function(t){var e=this.inspector.parse(t),i=e.getTag(),s=document.createRange();if(this._isInPage(t)){if("a"===i){var a=this.utils.createInvisibleChar();t.appendChild(a),s.setStartBefore(a),s.collapse(!0)}else s.selectNodeContents(t),s.collapse(!1);this.selection.setRange(s)}},setAtStart:function(t){var e=document.createRange(),i=this.inspector.parse(t);if(this._isInPage(t)){if(e.setStart(t,0),e.collapse(!0),i.isInline()||this.utils.isEmpty(t)){var s=this.utils.createInvisibleChar();e.insertNode(s),e.selectNodeContents(s),e.collapse(!1)}this.selection.setRange(e)}},setAtBefore:function(t){var e=this.inspector.parse(t),i=document.createRange();if(this._isInPage(t)){if(i.setStartBefore(t),i.collapse(!0),e.isInline()){var s=this.utils.createInvisibleChar();t.parentNode.insertBefore(s,t),i.selectNodeContents(s),i.collapse(!1)}this.selection.setRange(i)}},setAtAfter:function(t){var e=document.createRange();if(this._isInPage(t)){e.setStartAfter(t),e.collapse(!0);var i=this.utils.createInvisibleChar();e.insertNode(i),e.selectNodeContents(i),e.collapse(!1),this.selection.setRange(e)}},setAtPrev:function(t){var e=t.previousSibling;e&&(e=3===e.nodeType&&this._isEmptyTextNode(e)?e.previousElementSibling:e,e&&this.setEnd(e))},setAtNext:function(t){var e=t.nextSibling;e&&(e=3===e.nodeType&&this._isEmptyTextNode(e)?e.nextElementSibling:e,e&&this.setStart(e))},_setCaret:function(t,e){var i=this.inspector.parse(e),s=i.getNode();s&&(this.component.clearActive(),this["_set"+t](s,i,i.getTag()))},_setStart:function(t,e,i){if(e.isText())return this.editor.focus(),this.setAtStart(t);if("ul"===i||"ol"===i){t=e.findFirstNode("li");var s=this.utils.getFirstElement(t),a=this.inspector.parse(s);if(s&&a.isComponent())return this.setStart(a.getComponent())}else if("dl"===i)t=e.findFirstNode("dt");else{if("br"===i||"hr"===i)return this.setBefore(t);if("td"===i||"th"===i){var n=e.getFirstElement(t);if(n)return this.setStart(n)}else{if("table"===i||"tr"===i)return this.setStart(e.findFirstNode("th, td"));if(e.isComponentType("code")&&!e.isFigcaption()){var r=e.findLastNode("pre, code");return this.editor.focus(),this.setAtStart(r)}if("figure"===i&&e.isComponentType("table")){var o=e.getTable(),l=this.inspector.parse(o);return this.setStart(l.findFirstNode("th, td"))}if(!e.isComponentType("table")&&e.isComponent()&&!e.isFigcaption())return this.component.setActive(t)}}this.editor.focus(),this._setInline(t,"Start")||this.setAtStart(t)},_setEnd:function(t,e,i){if(e.isText())return this.editor.focus(),this.setAtEnd(t);if("ul"===i||"ol"===i){t=e.findLastNode("li");var s=this.utils.getLastElement(t),a=this.inspector.parse(s);if(s&&a.isComponent())return this.setEnd(a.getComponent())}else if("dl"===i)t=e.findLastNode("dd");else{if("br"===i||"hr"===i)return this.setAfter(t);if("td"===i||"th"===i){var n=e.getLastElement();if(n)return this.setEnd(n)}else{if("table"===i||"tr"===i)return this.setEnd(e.findLastNode("th, td"));if(e.isComponentType("code")&&!e.isFigcaption()){var r=e.findLastNode("pre, code");return this.editor.focus(),this.setAtEnd(r)}if("figure"===i&&e.isComponentType("table")){var o=e.getTable(),l=this.inspector.parse(o);return this.setEnd(l.findLastNode("th, td"))}if(!e.isComponentType("table")&&e.isComponent()&&!e.isFigcaption())return this.component.setActive(t)}}if(this.editor.focus(),!this._setInline(t,"End")){if(this.utils.isEmpty(t))return this.setStart(t);this.setAtEnd(t)}},_setBefore:function(t,e,i){return 3===t.nodeType?this.setAtBefore(t):e.isInline()?this.setAtBefore(t):e.isFirstTableCell()?this.setAtPrev(e.getComponent()):"td"===i||"th"===i?this.setAtPrev(t):e.isFirstListItem()?this.setAtPrev(e.getList()):e.isFigcaption()?this.setStart(e.getComponent()):!e.isComponentType("table")&&e.isComponent()?this.setAtPrev(e.getComponent()):e.isBlock()?this.setAtPrev(t):(this.editor.focus(),void this.setAtBefore(t))},_setAfter:function(t,e,i){return 3===t.nodeType?this.setAtAfter(t):e.isInline()?this.setAtAfter(t):e.isLastTableCell()?this.setAtNext(e.getComponent()):"td"===i||"th"===i?this.setAtNext(t):e.isFirstListItem()?this.setAtNext(e.getList()):!e.isComponentType("table")&&e.isComponent()?this.setAtNext(e.getComponent()):e.isBlock()?this.setAtNext(t):(this.editor.focus(),void this.setAtAfter(t))},_setInline:function(t,e){var i=this._hasInlineChild(t,"Start"===e?"first":"last");return i?("Start"===e?this.setStart(i):this.setEnd(i),!0):void 0},_isStartOrEnd:function(t,e){var i=this.utils.getNode(t);if(!i)return!1;var s=this.inspector.parse(i);if(i=this._getStartEndNode(i,s,e),i&&3!==i.nodeType&&"LI"!==i.tagName){var a=3===i.nodeType?i.textContent:i.innerHTML;if(a=this.utils.trimSpaces(a),""===a)return!0}if(!s.isFigcaption()&&s.isComponent()&&!s.isComponentEditable())return!0;var n=this.offset.get(i,!0);return!!n&&("First"===e?0===n.start:n.end===this.offset.size(i,!0))},_isInPage:function(t){return!(!t||!t.nodeType)&&(t!==document.body&&document.body.contains(t))},_hasInlineChild:function(t,e){var i=this.inspector.parse(t),s="first"===e?i.getFirstNode():i.getLastNode(),a=$R.dom(s);return s&&3!==s.nodeType&&this.inspector.isInlineTag(s.tagName)&&!a.hasClass("redactor-component")&&!a.hasClass("non-editable")?s:void 0},_isEmptyTextNode:function(t){var e=t.textContent.trim().replace(/\n/,"");return e=this.utils.removeInvisibleChars(e),""===e},_getStartEndNode:function(t,e,i){return e.isFigcaption()?t=e.getFigcaption():e.isTable()?t=e["find"+i+"Node"]("th, td"):e.isList()?t=e["find"+i+"Node"]("li"):e.isComponentType("code")&&(t=e.findLastNode("pre, code")),t}}),$R.add("service","selection",{init:function(t){this.app=t},is:function(){var t=this.get();if(t){var e=t.anchorNode,i=this.inspector.parse(e);return i.isInEditor()||i.isEditor()}return!1},isCollapsed:function(){var t=this.get(),e=this.getRange();return!(!t||!t.isCollapsed)||!(!e||0!==e.toString().length)},isBackwards:function(){var t=!1,e=this.get();if(e&&!e.isCollapsed){var i=document.createRange();i.setStart(e.anchorNode,e.anchorOffset),i.setEnd(e.focusNode,e.focusOffset),t=i.collapsed,i.detach()}return t},isIn:function(t){var e=$R.dom(t).get(),i=this.getCurrent();return!(!i||!e)&&e.contains(i)},isText:function(){var t=this.get();if(t){var e=t.anchorNode,i=this.getBlock(e),s=this.getBlocks();if(i&&this.inspector.isTableCellTag(i.tagName)||!1===i&&0===s.length)return!0}return!1},isAll:function(t){var e=this.utils.getNode(t);if(!e)return!1;var i=this.editor.isEditor(e),s=this.inspector.parse(e);if(!s.isFigcaption()&&this.component.isNonEditable(e)&&this.component.isActive(e))return!0;if(i){var a=this.editor.getElement(),n=a.html().replace(/<p><\/p>$/i,""),r=this.getHtml(!1).length,o=n.length;if(r!==o)return!1}if(i&&this.editor.isEmpty()||this.isCollapsed())return!1;var l=this.offset.get(e,!0),c=this.offset.size(e,!0);return!i&&s.isComponentType("code")&&(c=this.getText().trim().length),!(!l||0!==l.start||l.end!==c)},hasNonEditable:function(){var t=this.getHtml(),e=$R.dom("<div>").html(t);return!this.isCollapsed()&&0!==e.find(".non-editable").length},setRange:function(t){var e=window.getSelection();e.removeAllRanges(),e.addRange(t)},setAll:function(t){var e=this.utils.getNode(t);if(e){var i=this.inspector.parse(e);if(this.component.clearActive(),this.editor.focus(),this.editor.saveScroll(),this.editor.disableNonEditables(),e&&"TABLE"===e.tagName){var s=i.findFirstNode("td, th"),a=i.findLastNode("td, th");$R.dom(s).prepend(this.marker.build("start")),$R.dom(a).append(this.marker.build("end")),this.restoreMarkers()}else if(!i.isFigcaption()&&this.component.isNonEditable(e))this.component.setActive(e);else{i.isComponentType("code")&&(e=i.getComponentCodeElement(),e.focus());var n=document.createRange();n.selectNodeContents(e),this.setRange(n)}this.editor.enableNonEditables(),this.editor.restoreScroll()}},get:function(){var t=window.getSelection();return t.rangeCount>0?t:null},getRange:function(){var t=this.get();return t&&t.getRangeAt(0)?t.getRangeAt(0):null},getTextBeforeCaret:function(t){t="undefined"==typeof t?1:t;var e=this.editor.getElement().get(),i=this.getRange(),s=!1;return i&&(i=i.cloneRange(),i.collapse(!0),i.setStart(e,0),s=i.toString().slice(-t)),s},getTextAfterCaret:function(t){t="undefined"==typeof t?1:t;var e=this.editor.getElement().get(),i=this.getRange(),s=!1;if(i){var a=i.cloneRange();a.selectNodeContents(e),a.setStart(i.endContainer,i.endOffset),s=a.toString().slice(0,t)}return s},getPosition:function(){var t=this.getRange(),e={top:0,left:0,width:0,height:0};if(window.getSelection&&t.getBoundingClientRect){t=t.cloneRange();var i=t.startOffset-1;t.setStart(t.startContainer,0>i?0:i);var s=t.getBoundingClientRect();e={top:s.top,left:s.left,width:s.right-s.left,height:s.bottom-s.top}}return e},getCurrent:function(){var t=!1,e=this.get(),i=this.component.getActive();if(i)t=i;else if(e&&this.is()){var s=this.inspector.parse(e.anchorNode);t=!s.isEditor()&&e.anchorNode}return t},getParent:function(){var t=!1,e=this.getCurrent();if(e){var i=e.parentNode,s=this.inspector.parse(i);t=!s.isEditor()&&i}return t},getElement:function(t){for(var e=t||this.getCurrent();e;){var i=this.inspector.parse(e);if(i.isElement()&&i.isInEditor())return e;e=e.parentNode}return!1},getInline:function(t){for(var e=t||this.getCurrent(),i=!1;e;)this._isInlineNode(e)&&(i=e),e=e.parentNode;return i},getInlineFirst:function(t){for(var e=t||this.getCurrent();e;){if(this._isInlineNode(e))return e;e=e.parentNode}return!1},getInlineAll:function(t){for(var e=t||this.getCurrent(),i=[];e;)this._isInlineNode(e)&&i.push(e),e=e.parentNode;return i},getBlock:function(t){for(var e=t||this.getCurrent();e;){var i=this.inspector.parse(e),s=this.inspector.isBlockTag(e.tagName);if(s&&i.isInEditor(e))return e;e=e.parentNode}return!1},getInlinesAllSelected:function(t){if(this.isAll())return[];var e=this.getInlines({all:!0}),i=this.getNodes({textnodes:!0,inline:!1}),s=this.getText().replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),a=[];if(0!==i.length)return a;if(""===s)a=e;else if(e.length>1)for(var n=0;n<e.length;n++)this._isTextSelected(e[n],s)&&a.push(e[n]);else 1===e.length&&this._isTextSelected(e[0],s)&&(a=e);return t&&t.tags?this._filterNodesByTags(a,t.tags):a},getInlines:function(t){for(var e=this.getNodes(),i=[],s=0;s<e.length;s++){var a;if(t&&t.all)for(a=e[s];a;)this._isInlineNode(a)&&!this._isInNodesArray(i,a)&&i.push(a),a=a.parentNode;else a=this.getInline(e[s]),a&&!this._isInNodesArray(i,a)&&i.push(a)}return i=t&&t.tags?this._filterNodesByTags(i,t.tags):i,t&&t.inside?this._filterInlinesInside(i,t):i},getBlocks:function(t){var e=this.getNodes(),i=this.getBlock();e=0===e.length&&i?[i]:e;for(var s=[],a=0;a<e.length;a++){var n=this.getBlock(e[a]);n&&!this._isInNodesArray(s,n)&&s.push(n)}return s=t&&t.tags?this._filterNodesByTags(s,t.tags):s,t&&t.first?this._filterBlocksFirst(s,t):s},getElements:function(t){var e=this.getNodes({textnodes:!1}),i=this.getBlock();e=0===e.length&&i?[i]:e;for(var s=[],a=0;a<e.length;a++)this._isInNodesArray(s,e[a])||s.push(e[a]);return t&&t.tags?this._filterNodesByTags(s,t.tags):s},getNodes:function(t){var e=[],i=this.component.getActive();if(i)e=this._getNodesComponent(i);else if(this.isCollapsed()){var s=this.getCurrent();e=s?[s]:[]}else this.is()&&!i&&(e=this._getRangeSelectedNodes());return e=this._filterServicesNodes(e),e=this._filterEditor(e),e=t&&t.tags?this._filterNodesByTags(e,t.tags):e,e=t&&t.textnodes?this._filterNodesTexts(e,t):e,t&&!t.textnodes?this._filterNodesElements(e):e},getText:function(){var t=this.get();return t?this.utils.removeInvisibleChars(t.toString()):""},getHtml:function(t){var e="",i=this.get();if(i){for(var s=document.createElement("div"),a=i.rangeCount,n=0;a>n;++n)s.appendChild(i.getRangeAt(n).cloneContents());e=s.innerHTML,e=!1!==t?this.cleaner.output(e):e,e=e.replace(/<p><\/p>$/i,"")}return e},clear:function(){this.component.clearActive(),this.get().removeAllRanges()},collapseToStart:function(){var t=this.get();t&&!t.isCollapsed&&t.collapseToStart()},collapseToEnd:function(){var t=this.get();t&&!t.isCollapsed&&t.collapseToEnd()},saveActiveComponent:function(){var t=this.component.getActive();return!!t&&(this.savedComponent=t,!0)},restoreActiveComponent:function(){return!!this.savedComponent&&(this.component.setActive(this.savedComponent),!0)},save:function(){this._clearSaved();var t=this.getElement(),e=["TD","TH","P","DIV","PRE","H1","H2","H3","H4","H5","H6","LI","BLOCKQUOTE"];!t||-1===e.indexOf(t.tagName)||""!==t.innerHTML&&"<br>"!==t.innerHTML?this.saveActiveComponent()||(this.saved=this.offset.get()):this.savedElement=t},restore:function(){(this.saved||this.savedComponent||this.savedElement)&&(this.editor.saveScroll(),this.savedElement?this.caret.setStart(this.savedElement):this.restoreActiveComponent()||this.offset.set(this.saved),this._clearSaved(),this.editor.restoreScroll())},saveMarkers:function(){this._clearSaved(),this.saveActiveComponent()||this.marker.insert()},restoreMarkers:function(){this.editor.saveScroll(),this.restoreActiveComponent()||this.marker.restore(),this._clearSaved(),this.editor.restoreScroll()},_getNextNode:function(t){if(t.hasChildNodes())return t.firstChild;for(;t&&!t.nextSibling;)t=t.parentNode;return t?t.nextSibling:null},_getNodesComponent:function(t){var e=this.getCurrent(),i=this.inspector.parse(e);return i.isFigcaption()?[i.getFigcaption()]:[t]},_getRangeSelectedNodes:function(){var t=[],e=this.getRange(),i=e.startContainer,s=e.startContainer,a=e.endContainer,n=this.editor.getElement();if(s===n.get()&&this.isAll())t=this.utils.getChildNodes(n);else if(i==a)t=[i];else{for(;i&&i!=a;)t.push(i=this._getNextNode(i));for(i=e.startContainer;i&&i!=e.commonAncestorContainer;)t.unshift(i),i=i.parentNode}return t},_isInNodesArray:function(t,e){return-1!==t.indexOf(e)},_filterEditor:function(t){for(var e=[],i=0;i<t.length;i++){var s=this.inspector.parse(t[i]);s.isInEditor()&&e.push(t[i])}return e},_filterServicesNodes:function(t){for(var e=[],i=0;i<t.length;i++){var s=$R.dom(t[i]),a=!1;t[i]&&3===t[i].nodeType&&this.utils.isEmpty(t[i])&&(a=!0),(s.hasClass("redactor-script-tag")||s.hasClass("redactor-component-caret")||s.hasClass("redactor-selection-marker")||s.hasClass("non-editable"))&&(a=!0),a||e.push(t[i])}return e},_filterNodesTexts:function(t,e){for(var i=[],s=0;s<t.length;s++)if(3===t[s].nodeType||e.keepbr&&"BR"===t[s].tagName){var a=this.getInline(t[s]),n=a&&e&&!1===e.inline;n||i.push(t[s])}return i},_filterNodesElements:function(t){for(var e=[],i=0;i<t.length;i++)3!==t[i].nodeType&&e.push(t[i]);return e},_filterNodesByTags:function(t,e,i){for(var s=[],a=0;a<t.length;a++)if(i&&3===t[a].nodeType)s.push(t[a]);else if(3!==t[a].nodeType){var n=t[a].tagName.toLowerCase();-1!==e.indexOf(n.toLowerCase())&&s.push(t[a])}return s},_filterBlocksFirst:function(t){for(var e=[],i=0;i<t.length;i++){var s=$R.dom(t[i]),a=s.parent().get(),n=s.parent().hasClass("redactor-in"),r=a&&("TD"===a.tagName||"TH"===a.tagName);(n||r)&&e.push(t[i])}return e},_filterInlinesInside:function(t){for(var e=[],i=0;i<t.length;i++)window.getSelection().containsNode(t[i],!0)&&e.push(t[i]);return e},_isTextSelected:function(t,e){var i=this.utils.removeInvisibleChars(t.textContent);return e===i||-1!==i.search(e)||-1!==e.search(new RegExp("^"+i))||-1!==e.search(new RegExp(i+"$"))},_isInlineNode:function(t){var e=this.inspector.parse(t);return this.inspector.isInlineTag(t.tagName)&&e.isInEditor()},_clearSaved:function(){this.saved=!1,this.savedComponent=!1,this.savedElement=!1}}),$R.add("service","element",{init:function(t){this.app=t,this.rootElement=t.rootElement,this.$element={},this.type="inline"},start:function(){this._build(),this._buildType()},isType:function(t){return t===this.type},getType:function(){return this.type},getElement:function(){return this.$element},_build:function(){this.$element=$R.dom(this.rootElement)},_buildType:function(){var t=this.$element.get().tagName;this.type="TEXTAREA"===t?"textarea":this.type,this.type="DIV"===t?"div":this.type,this.type=this.opts.inline?"inline":this.type}}),$R.add("service","editor",{init:function(t){this.app=t,this.scrolltop=!1,this.pasting=!1},start:function(){this._build()},focus:function(){this.isFocus()||this._isContenteditableFocus()||(this.saveScroll(),this.$editor.focus(),this.restoreScroll())},startFocus:function(){this.caret.setStart(this.getFirstNode())},endFocus:function(){this.caret.setEnd(this.getLastNode())},isPasting:function(){return this.pasting},enablePasting:function(){this.pasting=!0},disablePasting:function(){this.pasting=!1},saveScroll:function(){this.scrolltop=this._getScrollTarget().scrollTop()},restoreScroll:function(){!1!==this.scrolltop&&(this._getScrollTarget().scrollTop(this.scrolltop),this.scrolltop=!1)},disableNonEditables:function(){this.$noneditables=this.$editor.find("[contenteditable=false]"),this.$noneditables.attr("contenteditable",!0)},enableNonEditables:function(){this.$noneditables&&setTimeout(function(){this.$noneditables.attr("contenteditable",!1)}.bind(this),1)},getFirstNode:function(){return this.$editor.contents()[0]},getLastNode:function(){var t=this.$editor.contents();return t[t.length-1]},isSourceMode:function(){var t=this.source.getElement();return t.hasClass("redactor-source-open")},isEditor:function(t){var e=$R.dom(t).get();return e===this.$editor.get()},isEmpty:function(t){return this.utils.isEmptyHtml(this.$editor.html(),!1,t)},isFocus:function(){var t=$R.dom(document.activeElement),e=0!==this.$editor.find(".redactor-component-active").length;return e||0!==t.closest(".redactor-in-"+this.uuid).length},setEmpty:function(){this.$editor.html(this.opts.emptyHtml)},getElement:function(){return this.$editor},_build:function(){var t=this.element.getElement(),e=this.element.isType("textarea")?"<div>":t.get();this.$editor=$R.dom(e)},_getScrollTarget:function(){var t=this.$doc;return this.opts.toolbarFixedTarget!==document?$R.dom(this.opts.toolbarFixedTarget):this.opts.scrollTarget?$R.dom(this.opts.scrollTarget):t},_isContenteditableFocus:function(){var t=this.selection.getBlock(),e=t?$R.dom(t).closest("[contenteditable=true]").not(".redactor-in"):[];return 0!==e.length}}),$R.add("service","container",{init:function(t){this.app=t},start:function(){this._build()},getElement:function(){return this.$container},_build:function(){var t=this.element.isType("inline")?"<span>":"<div>";this.$container=$R.dom(t)}}),$R.add("service","source",{init:function(t){this.app=t,this.$source={},this.content=""},start:function(){this._build(),this._buildName(),this._buildStartedContent()},getElement:function(){return this.$source},getCode:function(){return this.$source.val()},getName:function(){return this.$source.attr("name")},getStartedContent:function(){return this.content},setCode:function(t){return this.insertion.set(t,!0,!1)},isNameGenerated:function(){return this.name},rebuildStartedContent:function(){this._buildStartedContent()},_build:function(){var t=this.element.getElement(),e=this.element.isType("textarea"),i=e?t.get():"<textarea>";this.$source=$R.dom(i)},_buildName:function(){var t=this.element.getElement();this.name=t.attr("name"),this.$source.attr("name",this.name?this.name:"content-"+this.uuid)},_buildStartedContent:function(){var t=this.element.getElement(),e=this.element.isType("textarea")?t.val():t.html();this.content=e.trim()}}),$R.add("service","statusbar",{init:function(t){this.app=t,this.$statusbar={},this.items=[]},start:function(){this.$statusbar=$R.dom("<ul>"),this.$statusbar.attr("dir",this.opts.direction)},add:function(t,e){return this.update(t,e)},update:function(t,e){var i;return"undefined"!=typeof this.items[t]?i=this.items[t]:(i=$R.dom("<li>"),this.$statusbar.append(i),this.items[t]=i),i.html(e)},get:function(t){return!!this.items[t]&&this.items[t]},remove:function(t){this.items[t]&&(this.items[t].remove(),delete this.items[t])},getItems:function(){return this.items},removeItems:function(){this.items={},this.$statusbar.html("")},getElement:function(){return this.$statusbar}}),$R.add("service","toolbar",{init:function(t){this.app=t,this.buttons=[],this.dropdownOpened=!1,this.buttonsObservers={}},start:function(){this.is()&&(this.opts.activeButtons=this.opts.activeButtonsAdd?this._extendActiveButtons():this.opts.activeButtons,this.create())},stopObservers:function(){this.buttonsObservers={}},create:function(){this.$wrapper=$R.dom("<div>"),this.$toolbar=$R.dom("<div>")},observe:function(){if(this.is()){var t,e;for(var i in this.setButtonsInactive(),this.buttonsObservers)e=this.buttonsObservers[i],t=this.getButton(i),this.app.broadcast("button."+e+".observe",t);var s=this.opts.activeButtons,a=this.selection.getInlinesAllSelected(),n=this.selection.getInline();this.selection.isCollapsed()&&n&&a.push(n);var r=this._inlinesToTags(a);for(var o in s)-1!==r.indexOf(o)&&(t=this.getButton(s[o]),t.setActive())}},is:function(){return!(!this.opts.toolbar||this.detector.isMobile()&&this.opts.air)},isAir:function(){return!!this.is()&&this.$toolbar.hasClass("redactor-air")},isFixed:function(){return!!this.is()&&this.$toolbar.hasClass("redactor-toolbar-fixed")},isContextBar:function(){var t=this.$body.find("#redactor-context-toolbar-"+this.uuid);return t.hasClass("open")},isTarget:function(){return this.opts.toolbarFixedTarget!==document},getElement:function(){return this.$toolbar},getWrapper:function(){return this.$wrapper},getDropdown:function(){return this.dropdownOpened},getTargetElement:function(){return $R.dom(this.opts.toolbarFixedTarget)},getButton:function(t){var e=this._findButton(".re-"+t);return 0!==e.length&&e.dataget("data-button-instance")},getButtonByIndex:function(t){var e=this.$toolbar.find(".re-button").eq(t);return 0!==e.length&&e.dataget("data-button-instance")},getButtons:function(){var t=[];return this._findButtons().each(function(e){var i=$R.dom(e);t.push(i.dataget("data-button-instance"))}),t},getButtonsKeys:function(){var t=[];return this._findButtons().each(function(e){var i=$R.dom(e);t.push(i.attr("data-re-name"))}),t},addButton:function(t,e,i,s,a){i=i||"end";var n=this._getButtonIndex(t),r=$R.create("toolbar.button",this.app,t,e);if(e.observe&&(this.opts.activeButtonsObservers[t]={observe:e.observe,button:r}),!0!==a)if(0===n)i="first";else if(-1!==n){var o=this.getButtonByIndex(n-1);o&&(i="after",s=o)}return this.is()&&("first"===i?this.$toolbar.prepend(r):"after"===i?s.after(r):"before"===i?s.before(r):this.$toolbar.append(r)),r},addButtonFirst:function(t,e){return this.addButton(t,e,"first")},addButtonAfter:function(t,e,i){var s=this.getButton(t);return s?this.addButton(e,i,"after",s):this.addButton(e,i)},addButtonBefore:function(t,e,i){var s=this.getButton(t);return s?this.addButton(e,i,"before",s):this.addButton(e,i)},addButtonObserver:function(t,e){this.buttonsObservers[t]=e},setButtons:function(t){this.buttons=t},setDropdown:function(t){this.dropdownOpened=t},setButtonsInactive:function(){for(var t=this.getButtons(),e=0;e<t.length;e++)t[e].setInactive()},setButtonsActive:function(){for(var t=this.getButtons(),e=0;e<t.length;e++)t[e].setActive()},disableButtons:function(){for(var t=this.getButtons(),e=0;e<t.length;e++)t[e].disable()},enableButtons:function(){for(var t=this.getButtons(),e=0;e<t.length;e++)t[e].enable()},_getButtonIndex:function(t){var e=this.buttons.indexOf(t);return-1!==e&&e},_findButton:function(t){return this.is()?this.$toolbar.find(t):$R.dom()},_findButtons:function(){return this.is()?this.$toolbar.find(".re-button"):$R.dom()},_extendActiveButtons:function(){return $R.extend({},this.opts.activeButtons,this.opts.activeButtonsAdd)},_inlinesToTags:function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].tagName.toLowerCase());return e}}),$R.add("class","toolbar.button",{mixins:["dom"],init:function(t,e,i){this.app=t,this.opts=t.opts,this.lang=t.lang,this.$body=t.$body,this.toolbar=t.toolbar,this.detector=t.detector,this.obj=i,this.name=e,this.dropdown=!1,this.tooltip=!1,this._init()},isActive:function(){return this.hasClass("redactor-button-active")},isDisabled:function(){return this.hasClass("redactor-button-disabled")},hasIcon:function(){return this.obj.icon&&!this.opts.buttonsTextLabeled},setDropdown:function(t){this.obj.dropdown=t,this.obj.message=!1,this.dropdown=$R.create("toolbar.dropdown",this.app,this.name,this.obj.dropdown),this.attr("data-dropdown",!0)},setMessage:function(t,e){this.obj.message=t,this.obj.args=e,this.obj.dropdown=!1},setApi:function(t,e){this.obj.api=t,this.obj.args=e,this.obj.dropdown=!1},setTitle:function(t){this.obj.title=this.lang.parse(t),this.obj.tooltip=this.obj.title,this.attr({alt:this.obj.tooltip,"aria-label":this.obj.tooltip}),this.attr("data-re-icon")||this.html(this.obj.title)},setTooltip:function(t){this.obj.tooltip=this.lang.parse(t),this.attr({alt:this.obj.tooltip,"aria-label":this.obj.tooltip})},setIcon:function(t){this.opts.buttonsTextLabeled||(this.obj.icon=!0,this.$icon=$R.dom(t),this.html(""),this.append(this.$icon),this.attr("data-re-icon",!0),this.addClass("re-button-icon"),this.setTooltip(this.obj.title),this._buildTooltip())},setActive:function(){this.addClass("redactor-button-active")},setInactive:function(){this.removeClass("redactor-button-active")},hideTooltip:function(){this.$body.find(".re-button-tooltip").remove()},getDropdown:function(){return this.dropdown},disable:function(){this.addClass("redactor-button-disabled")},enable:function(){this.removeClass("redactor-button-disabled")},toggle:function(t){t&&t.preventDefault(),this.isDisabled()||(this.obj.dropdown?this.dropdown.toggle(t):this.obj.api?this.app.api(this.obj.api,this.obj.args,this.name):this.obj.message&&this.app.broadcast(this.obj.message,this.obj.args,this.name),this.hideTooltip())},_init:function(){this._parseTitle(),this._parseTooltip(),this._build(),this._buildCallback(),this._buildAttributes(),this._buildObserver(),this.hasIcon()?(this._buildIcon(),this._buildTooltip()):this.html(this.obj.title)},_parseTooltip:function(){this.obj.tooltip=this.obj.tooltip?this.lang.parse(this.obj.tooltip):this.obj.title},_parseTitle:function(){this.obj.title=this.lang.parse(this.obj.title)},_build:function(){this.parse("<a>"),this.addClass("re-button re-"+this.name),this.attr("data-re-name",this.name),this.dataset("data-button-instance",this),this.obj.dropdown&&this.setDropdown(this.obj.dropdown)},_buildCallback:function(){this.on("click",this.toggle.bind(this))},_buildAttributes:function(){var t={href:"#",alt:this.obj.tooltip,rel:this.name,role:"button","aria-label":this.obj.tooltip,tabindex:"-1"};this.attr(t)},_buildObserver:function(){"undefined"!=typeof this.obj.observe&&this.toolbar.addButtonObserver(this.name,this.obj.observe)},_buildIcon:function(){var t=this.obj.icon,e=/(<([^>]+)>)/gi.test(t);this.$icon=e?$R.dom(t):$R.dom("<i>"),e||this.$icon.addClass("re-icon-"+this.name),this.append(this.$icon),this.attr("data-re-icon",!0),this.addClass("re-button-icon")},_buildTooltip:function(){this.detector.isDesktop()&&(this.tooltip=$R.create("toolbar.button.tooltip",this.app,this))}}),$R.add("class","toolbar.button.tooltip",{mixins:["dom"],init:function(t,e){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.$body=t.$body,this.toolbar=t.toolbar,this.$button=e,this.created=!1,this._init()},open:function(){if(!this.$button.hasClass("redactor-button-disabled")&&!this.$button.hasClass("redactor-button-active")){this.created=!0,this.parse("<span>"),this.addClass("re-button-tooltip re-button-tooltip-"+this.uuid),this.$body.append(this),this.html(this.$button.attr("alt"));var t=this.$button.offset(),e="absolute",i=this.$button.height(),s=this.$button.width(),a=4;this.css({top:t.top+i+a+"px",left:t.left+s/2-this.width()/2+"px",position:e}),this.show()}},close:function(){this.created&&!this.$button.hasClass("redactor-button-disabled")&&(this.remove(),this.created=!1)},_init:function(){this.$button.on("mouseover",this.open.bind(this)),this.$button.on("mouseout",this.close.bind(this))}}),$R.add("class","toolbar.dropdown",{mixins:["dom"],init:function(t,e,i){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.$win=t.$win,this.$doc=t.$doc,this.$body=t.$body,this.animate=t.animate,this.toolbar=t.toolbar,this.name=e,this.started=!1,this.items=i,this.$items=[]},toggle:function(t){this.started||this._build(),this.isOpened()&&this.isActive()?this.close(!1):this.open(t)},isOpened:function(){var t=this.$body.find(".redactor-dropdown-"+this.uuid+".open");return 0!==t.length&&t.attr("data-re-name")===this.name},isActive:function(){var t=this.$body.find("#redactor-dropdown-"+this.uuid+"-"+this.name+".open");return 0!==t.length},getName:function(){return this.attr("data-re-name")},getItem:function(t){return this.$items[t]},getItemsByClass:function(t){var e=[];for(var i in this.$items)"object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(this.$items[i])&&this.$items[i].hasClass(t)&&e.push(this.$items[i]);return e},open:function(t){this._closeAll(),this.$btn=this.toolbar.getButton(this.name),this.app.broadcast("dropdown.open",t,this,this.$btn),this.toolbar.setDropdown(this),this.show(),this.removeClass("redactor-animate-hide"),this.addClass("open"),this._observe(),this.$btn.hideTooltip(),this.$btn.setActive(),this.$doc.on("keyup.redactor.dropdown-"+this.uuid,this._handleKeyboard.bind(this)),this.$doc.on("click.redactor.dropdown-"+this.uuid+" touchstart.redactor.dropdown-"+this.uuid,this.close.bind(this)),this.updatePosition(),this.app.broadcast("dropdown.opened",t,this,this.$btn)},close:function(t,e){if(t){var i=$R.dom(t.target);if(this._isButton(t)||i.hasClass("redactor-dropdown-not-close")||i.hasClass("redactor-dropdown-item-disabled"))return void t.preventDefault()}this.app.broadcast("dropdown.close",this,this.$btn),this.toolbar.setDropdown(!1),this.$btn.setInactive(),!1===e?this._close():this.animate.start(this,"fadeOut",this._close.bind(this))},updatePosition:function(){var t=this.toolbar.isFixed(),e=this.$btn.offset();e.top=t?this.$btn.position().top:e.top;var i=this.$btn.height(),s=this.$btn.width(),a=t?"fixed":"absolute",n=2,r=0,o=e.left+r,l=_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default()(this.css("width")),c=this.$win.width(),d=o+l>c?l-s:0,u=o-d;u=0>u?4:u,this.css({position:a,top:e.top+i+n+"px",left:u+"px"})},_build:function(){this.parse("<div>"),this.attr("dir",this.opts.direction),this.attr("id","redactor-dropdown-"+this.uuid+"-"+this.name),this.attr("data-re-name",this.name),this.addClass("redactor-dropdown redactor-dropdown-"+this.uuid+" redactor-dropdown-"+this.name),this.dataset("data-dropdown-instance",this);var t=this.items.dom||"string"==typeof this.items;t?this._buildDom():this._buildItems(),this.$body.append(this),this.started=!0},_buildDom:function(){this.html("").append($R.dom(this.items))},_buildItems:function(){for(var t in this.items="format"===this.name?this._buildFormattingItems():this.items,this.items){var e=this.items[t];if("observe"===t)this.attr("data-observe",this.items[t]);else{var i=$R.create("toolbar.dropdown.item",this.app,t,e,this);this.$items[t]=i,this.append(i)}}},_buildFormattingItems:function(){for(var t in this.items)-1===this.opts.formatting.indexOf(t)&&delete this.items[t];if(this.opts.formattingHide)for(var t in this.items)-1!==this.opts.formattingHide.indexOf(t)&&delete this.items[t];if(this.opts.formattingAdd)for(var t in this.opts.formattingAdd)this.items[t]=this.opts.formattingAdd[t];return this.items},_handleKeyboard:function(t){27===t.which&&this.close()},_isButton:function(t){var e=$R.dom(t.target),i=e.closest(".re-button");return i.get()===this.$btn.get()},_close:function(){this.$btn.setInactive(),this.$doc.off(".redactor.dropdown-"+this.uuid),this.removeClass("open"),this.addClass("redactor-animate-hide"),this.app.broadcast("dropdown.closed",this,this.$btn)},_closeAll:function(){this.$body.find(".redactor-dropdown-"+this.uuid+".open").each(function(t){var e=$R.dom(t),i=e.dataget("data-dropdown-instance");i._close()})},_observe:function(){var t=this.attr("data-observe");t&&this.app.broadcast("dropdown."+t+".observe",this)}}),$R.add("class","toolbar.dropdown.item",{mixins:["dom"],init:function(t,e,i,s){this.app=t,this.lang=t.lang,this.dropdown=s,this.name=e,this.obj=i,this._init()},setTitle:function(t){this.$span.html(t)},getTitle:function(){return this.$span.html()},enable:function(){this.removeClass("redactor-dropdown-item-disabled")},disable:function(){this.addClass("redactor-dropdown-item-disabled")},toggle:function(t){t&&t.preventDefault(),this.hasClass("redactor-dropdown-item-disabled")||(this.obj.message?this.app.broadcast(this.obj.message,this.obj.args,this.name):this.obj.api&&this.app.api(this.obj.api,this.obj.args,this.name))},_init:function(){this.parse("<a>"),this.attr("href","#"),this.addClass("redactor-dropdown-item-"+this.name),this.obj.classname&&this.addClass(this.obj.classname),this.attr("data-re-name",this.name),this.on("click",this.toggle.bind(this)),this.$span=$R.dom("<span>"),this.append(this.$span),this.setTitle(this.lang.parse(this.obj.title))}}),$R.add("service","cleaner",{init:function(t){this.app=t,this.opts=t.opts,this.storedComponents=[],this.storedImages=[],this.storedLinks=[],this.deniedTags=["font","html","head","link","title","body","meta","applet"],this.convertRules={},this.unconvertRules={},this.reComments=/<!--[\s\S]*?-->/g,this.reSpacedEmpty=/^(||\s||<br\s?\/?>||&nbsp;)$/i,this.reScriptTag=/<script(.*?[^>]?)>([\w\W]*?)<\/script>/gi},addConvertRules:function(t,e){this.convertRules[t]=e},addUnconvertRules:function(t,e){this.unconvertRules[t]=e},input:function(t,e,i){t=this.encodePreCode(t),t=t.replace(/\$/g,"&#36;"),t=t.replace(/&amp;/g,"&");var s=$R.create("cleaner.figure",this.app);return t=s.convert(t,this.convertRules),t=this.storeComponents(t),t=this.replaceTags(t,this.opts.replaceTags),t=this._setSpanAttr(t),t=this._setStyleCache(t),t=this.removeTags(t,this.deniedTags),t=this.opts.removeScript?this._removeScriptTag(t):this._replaceScriptTag(t),t=this.opts.removeComments?this.removeComments(t):t,t=this._isSpacedEmpty(t)?this.opts.emptyHtml:t,t=this.restoreComponents(t),t=this._cleanWrapped(t),e?this.paragraphize(t):t},output:function(t,e){if(t=this.removeInvisibleSpaces(t),this._isSpacedEmpty(t))return"";if(this._isParagraphEmpty(t))return"";t=this.removeServiceTagsAndAttrs(t,e),t=this.storeComponents(t),t=this.removeSpanWithoutAttributes(t),t=this.removeFirstBlockBreaklineInHtml(t),t=this.opts.removeScript?t:this._unreplaceScriptTag(t),t=this.opts.preClass?this._setPreClass(t):t,t=this.opts.linkNofollow?this._setLinkNofollow(t):t,t=this.opts.removeNewLines?this.cleanNewLines(t):t,t=this.restoreComponents(t);var i=$R.create("cleaner.figure",this.app);return t=i.unconvert(t,this.unconvertRules),t=this.removeEmptyAttributes(t,["style","class","rel","alt","title"]),t=this.cleanSpacesInPre(t),t=this.tidy(t),t=t.replace(/&amp;/g,"&"),""===t.replace(/\n/g,"")?"":t},paste:function(t){t=this.storeComponents(t);var e=this.deniedTags.concat(["iframe"]);t=this.removeTags(t,e),t=t.replace(new RegExp("<!doctype([\\s\\S]+?)>","gi"),""),t=t.replace(new RegExp("<style([\\s\\S]+?)</style>","gi"),""),t=t.replace(new RegExp("</p><br /><p","gi"),"</p><p");var i=this._isHtmlMsWord(t);if(t=this._cleanGDocs(t),t=i?this._cleanMsWord(t):t,!this.opts.pasteClean)return this.restoreComponents(t);if(this.opts.pastePlainText)return t=this.restoreComponents(t),this.pastePlainText(t);var s=this.opts.pasteBlockTags.concat(this.opts.pasteInlineTags);t=this.removeTagsExcept(t,s),t=this.opts.pasteLinks?t:this.removeTags(t,["a"]),t=this.opts.pasteImages?t:this.removeTags(t,["img"]);var a=this.utils.buildWrapper(t),n=a.find("*"),r=0!==this.opts.pasteKeepStyle.length?","+this.opts.pasteKeepStyle.join(","):"";n.not("[data-redactor-style-cache]"+r).removeAttr("style");var o=0!==this.opts.pasteKeepClass.length?","+this.opts.pasteKeepClass.join(","):"";n.not("[data-redactor-style-cache]"+o).removeAttr("class");var l=0!==this.opts.pasteKeepAttrs.length?","+this.opts.pasteKeepAttrs.join(","):"";return n.not("img, a, [data-redactor-style-cache]"+l).each(function(t){for(;t.attributes.length>0;)t.removeAttribute(t.attributes[0].name)}),this.opts.pasteLinks&&!1!==this.opts.pasteLinkTarget&&a.find("a").attr("target",this.opts.pasteLinkTarget),a.find("[data-redactor-style-cache]").each(function(t){var e=t.getAttribute("data-redactor-style-cache");t.setAttribute("style",e)}),a.find("span").each(function(t){0===t.attributes.length&&$R.dom(t).unwrap()}),a.find(this.opts.inlineTags.join(",")).each(function(t){0===t.attributes.length&&this.utils.isEmptyHtml(t.innerHTML)&&$R.dom(t).unwrap()}.bind(this)),a.find("ul, ol").each(function(t){var e=t.previousSibling;if(e&&"LI"===e.tagName){var i=$R.dom(e);i.find("p").unwrap(),i.append(t)}}),t=this.utils.getWrapperHtml(a),t=t.replace(/<li><p>/gi,"<li>"),t=t.replace(/<\/p><\/li>/gi,"</li>"),t=t.replace(/<p>&nbsp;<\/p>/gi,"<p></p>"),t=t.replace(/<p><br\s?\/?><\/p>/gi,"<p></p>"),i&&(t=t.replace(/<p><\/p>/gi,""),t=t.replace(/<p>\s<\/p>/gi,"")),this.restoreComponents(t)},pastePlainText:function(t){return t=this.opts.pasteLinks?this.storeLinks(t):t,t=this.opts.pasteImages?this.storeImages(t):t,t=this.getPlainText(t),t=this._replaceNlToBr(t),t=this.opts.pasteLinks?this.restoreLinks(t):t,this.opts.pasteImages?this.restoreImages(t):t},tidy:function(t){return t},paragraphize:function(t){var e=$R.create("cleaner.paragraphize",this.app);return e.convert(t)},getFlatText:function(t){var e=$R.dom("<div>");return t.nodeType||t.dom?e.append(t):(t=t.toString(),t=t.trim(),e.html(t)),t=e.get().textContent||e.get().innerText||"",void 0===t?"":t},getPlainText:function(t){t=t.replace(/<!--[\s\S]*?-->/gi,""),t=t.replace(/<style[\s\S]*?style>/gi,""),t=t.replace(/<p><\/p>/g,""),t=t.replace(/<\/div>|<\/li>|<\/td>/gi,"\n"),t=t.replace(/<\/p>/gi,"\n\n"),t=t.replace(/<\/H[1-6]>/gi,"\n\n");var e=document.createElement("div");return e.innerHTML=t,t=e.textContent||e.innerText,t.trim()},replaceTags:function(t,e){if(e){var i=this,s=_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_object_keys__WEBPACK_IMPORTED_MODULE_16___default()(e),a=this.utils.buildWrapper(t);a.find(s.join(",")).each(function(t){i.utils.replaceToTag(t,e[t.tagName.toLowerCase()])}),t=this.utils.getWrapperHtml(a)}return t},replaceNbspToSpaces:function(t){return t.replace("&nbsp;"," ")},replaceBlocksToBr:function(t){return t.replace(/<\/div>|<\/li>|<\/td>|<\/p>|<\/H[1-6]>/gi,"<br>")},cleanNewLines:function(t){return t.replace(/\r?\n/g,"")},cleanSpacesInPre:function(t){return t.replace("&nbsp;&nbsp;&nbsp;&nbsp;","    ")},removeInvisibleSpaces:function(t){return t=this.utils.removeInvisibleChars(t),t.replace(/&#65279;/gi,"")},removeNl:function(t){return t=t.replace(/\n/g," "),t.replace(/\s+/g,"s")},removeBrAtEnd:function(t){return t=t.replace(/<br\s?\/?>$/gi," "),t.replace(/<br\s?\/?><li/gi,"<li")},removeTags:function(t,e){var i=e?/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi:/(<([^>]+)>)/gi,s=e?function(t,i){return-1===e.indexOf(i.toLowerCase())?t:""}:"";return t.replace(i,s)},removeTagsExcept:function(t,e){if(void 0===e)return t.replace(/(<([^>]+)>)/gi,"");var i=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;return t.replace(i,function(t,i){return-1===e.indexOf(i.toLowerCase())?"":t})},removeComments:function(t){return t.replace(this.reComments,"")},removeServiceTagsAndAttrs:function(t,e){var i=this.utils.buildWrapper(t),s=this;return!1!==e&&i.find(".redactor-selection-marker").each(function(t){var e=$R.dom(t),i=s.utils.removeInvisibleChars(e.text());return""===i?e.remove():e.unwrap()}),i.find("[data-redactor-style-cache]").removeAttr("data-redactor-style-cache"),this.utils.getWrapperHtml(i)},removeSpanWithoutAttributes:function(t){var e=this.utils.buildWrapper(t);return e.find("span").removeAttr("data-redactor-span data-redactor-style-cache").each(function(t){0===t.attributes.length&&$R.dom(t).unwrap()}),this.utils.getWrapperHtml(e)},removeFirstBlockBreaklineInHtml:function(t){return t.replace(new RegExp("</li><br\\s?/?>","gi"),"</li>")},removeEmptyAttributes:function(t,e){for(var i=this.utils.buildWrapper(t),s=0;s<e.length;s++)i.find("["+e[s]+'=""]').removeAttr(e[s]);return this.utils.getWrapperHtml(i)},encodeHtml:function(t){return t=t.replace(/<br\s?\/?>/g,"\n"),t=t.replace(/&nbsp;/g," "),t=t.replace(/”/g,'"'),t=t.replace(/“/g,'"'),t=t.replace(/‘/g,"'"),t=t.replace(/’/g,"'"),t=this.encodeEntities(t),t=t.replace(/\$/g,"&#36;"),this.opts.preSpaces&&(t=t.replace(/\t/g,new Array(this.opts.preSpaces+1).join(" "))),t},encodePreCode:function(t){var e=t.match(new RegExp("<code(.*?)>(.*?)<pre(.*?)>(.*?)</pre>(.*?)</code>","gi"));if(null!==e)for(var i=0;i<e.length;i++){var s=e[i].match(new RegExp("<pre(.*?)>([\\w\\W]*?)</pre>","i"));t=t.replace(s[0],this.encodeEntities(s[0]))}var a=this.utils.buildWrapper(t);return a.find("code code").replaceWith(this._encodeOuter.bind(this)),a.find("code pre").replaceWith(this._encodeOuter.bind(this)),a.find("pre pre").replaceWith(this._encodeOuter.bind(this)),a.find("code, pre").each(this._encodePreCodeLine.bind(this)),t=this.utils.getWrapperHtml(a),this._decodeMarkers(t)},encodeEntities:function(t){return t=this.decodeEntities(t),t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},encodePhpCode:function(t){return t=t.replace("<?php","&lt;?php"),t=t.replace("<?","&lt;?"),t.replace("?>","?&gt;")},decodeEntities:function(t){return String(t).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},storeComponents:function(t){var e=this.utils.getElementsFromHtml(t,"figure","table");return this._storeMatched(t,e,"Components","figure")},restoreComponents:function(t){return this._restoreMatched(t,"Components","figure")},storeLinks:function(t){var e=this.utils.getElementsFromHtml(t,"a");return this._storeMatched(t,e,"Links","a")},storeImages:function(t){var e=this.utils.getElementsFromHtml(t,"img");return this._storeMatched(t,e,"Images","img")},restoreLinks:function(t){return this._restoreMatched(t,"Links","a")},restoreImages:function(t){return this._restoreMatched(t,"Images","img")},_cleanWrapped:function(t){return t.replace(new RegExp("<p><figure([\\w\\W]*?)</figure></p>","gi"),"<figure$1</figure>")},_cleanGDocs:function(t){return t=t.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2"),t=t.replace(/<b(.*?)id="docs-internal-guid(.*?)">([\w\W]*?)<\/b>/gi,"$3"),t=t.replace(/<span[^>]*(font-style: italic; font-weight: bold|font-weight: bold; font-style: italic)[^>]*>([\w\W]*?)<\/span>/gi,"<b><i>$2</i></b>"),t=t.replace(/<span[^>]*(font-style: italic; font-weight: 700|font-weight: 700; font-style: italic)[^>]*>([\w\W]*?)<\/span>/gi,"<b><i>$2</i></b>"),t=t.replace(/<span[^>]*font-style: italic[^>]*>([\w\W]*?)<\/span>/gi,"<i>$1</i>"),t=t.replace(/<span[^>]*font-weight: bold[^>]*>([\w\W]*?)<\/span>/gi,"<b>$1</b>"),t.replace(/<span[^>]*font-weight: 700[^>]*>([\w\W]*?)<\/span>/gi,"<b>$1</b>")},_cleanMsWord:function(t){t=t.replace(/<!--[\s\S]+?-->/gi,""),t=t.replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,""),t=t.replace(/<(\/?)s>/gi,"<$1strike>"),t=t.replace(/&nbsp;/gi," "),t=t.replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(t,e){return e.length>0?e.replace(/./," ").slice(Math.floor(e.length/2)).split("").join(" "):""});var e=this.utils.buildWrapper(t);e.find("p").each(function(t){var e=$R.dom(t),i=e.attr("style"),s=/mso-list:\w+ \w+([0-9]+)/.exec(i);s&&e.data("_listLevel",_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_2___default()(s[1],10))}),this._parseWordLists(e),e.find("[style]").removeAttr("style"),e.find("[align]").removeAttr("align"),e.find("[name]").removeAttr("name"),e.find("span").unwrap(),e.find("[class^='Mso']").removeAttr("class"),e.find("a").filter(function(t){return!t.hasAttribute("href")}).unwrap(),t=this.utils.getWrapperHtml(e),t=t.replace(/<p[^>]*><\/p>/gi,""),t=t.replace(/<li>·/gi,"<li>"),t=t.trim(),t=t.replace(/\/(p|ul|ol|h1|h2|h3|h4|h5|h6|blockquote)>\s+<(p|ul|ol|h1|h2|h3|h4|h5|h6|blockquote)/gi,"/$1>\n<$2");for(var i="",s=t.split(/\n/),a=0;a<s.length;a++){var n=""!==s[a]&&-1===s[a].search(/>$/)?" ":"\n";i+=s[a]+n}return i},_parseWordLists:function(t){var e=0,i=null;t.find("p").each(function(t){var s=$R.dom(t),a=s.data("_listLevel");if(null!==a){var n=s.text(),r="<ul></ul>";if(/^\s*\w+\./.test(n)){var o=/([0-9])\./.exec(n);if(o){var l=_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_2___default()(o[1],10);r=l>1?'<ol start="'+l+'"></ol>':"<ol></ol>"}else r="<ol></ol>"}if(a>e)if(0===e)s.before(r),i=s.prev();else{var c=$R.dom(r);i.append(c)}if(e>a)for(var d=0;e-a>d;d++)i=i.parent();s.find("span").first().unwrap(),i.append("<li>"+s.html()+"</li>"),s.remove(),e=a}else e=0})},_isSpacedEmpty:function(t){return-1!==t.search(this.reSpacedEmpty)},_isParagraphEmpty:function(t){return-1!==t.search(/^<p><\/p>$/i)},_isHtmlMsWord:function(t){return t.match(/class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i)},_setSpanAttr:function(t){var e=this.utils.buildWrapper(t);return e.find("span").attr("data-redactor-span",!0),this.utils.getWrapperHtml(e)},_setStyleCache:function(t){var e=this.utils.buildWrapper(t);return e.find("[style]").each(function(t){var e=$R.dom(t);e.attr("data-redactor-style-cache",e.attr("style"))}),this.utils.getWrapperHtml(e)},_setPreClass:function(t){var e=this.utils.buildWrapper(t);return e.find("pre").addClass(this.opts.preClass),this.utils.getWrapperHtml(e)},_setLinkNofollow:function(t){var e=this.utils.buildWrapper(t);return e.find("a").attr("rel","nofollow"),this.utils.getWrapperHtml(e)},_replaceScriptTag:function(t){return t.replace(this.reScriptTag,'<pre class="redactor-script-tag" $1>$2</pre>')},_unreplaceScriptTag:function(t){return t.replace(/<pre class="redactor-script-tag"(.*?[^>]?)>([\w\W]*?)<\/pre>/gi,"<script$1>$2<\/script>")},_replaceNlToBr:function(t){return t.replace(/\n/g,"<br />")},_removeScriptTag:function(t){return t.replace(this.reScriptTag,"")},_storeMatched:function(t,e,i,s){if(this["stored"+i]=[],e)for(var a=0;a<e.length;a++)this["stored"+i][a]=e[a],t=t.replace(e[a],"####"+s+a+"####");return t},_restoreMatched:function(t,e,i){if(this["stored"+e])for(var s=0;s<this["stored"+e].length;s++)t=t.replace("####"+i+s+"####",this["stored"+e][s]);return t},_decodeMarkers:function(t){var e='<span id="selection-marker-$1" class="redactor-selection-marker">​</span>';return t.replace(/&lt;span\sid="selection-marker-(start|end)"\sclass="redactor-selection-marker"&gt;(.*?[^>]?)&lt;\/span&gt;/g,e)},_encodeOuter:function(t){return this.encodeEntities(t.outerHTML)},_encodePreCodeLine:function(t){var e=t.firstChild;if("PRE"!=t.tagName||!e||"CODE"!==e.tagName){var i=this.decodeEntities(t.innerHTML);i=i.replace(/&nbsp;/g," ").replace(/<br\s?\/?>/g,"\n"),i=this.opts.preSpaces?i.replace(/\t/g,new Array(this.opts.preSpaces+1).join(" ")):i,t.textContent=i}}}),$R.add("class","cleaner.figure",{init:function(t){this.app=t,this.opts=t.opts,this.utils=t.utils},convert:function(t,e){var i=this.utils.buildWrapper(t);return i.find("img").each(this._convertImage.bind(this)),i.find("hr").each(this._convertLine.bind(this)),i.find("iframe").each(this._convertIframe.bind(this)),i.find("table").each(this._convertTable.bind(this)),i.find("form").each(this._convertForm.bind(this)),i.find("figure pre").each(this._convertCode.bind(this)),i.find("[data-redactor-type=variable]").addClass("redactor-component"),i.find("figure").not(".redactor-component, .redactor-figure-code").each(this._convertWidget.bind(this)),i.find("figure pre").each(this._setContenteditableCode.bind(this)),i.find(".redactor-component, .non-editable").attr("contenteditable",!1),i.find("figcaption, td, th").attr("contenteditable",!0),i.find(".redactor-component, figcaption").attr("tabindex","-1"),this._acceptExtraRules(i,e),this.utils.getWrapperHtml(i)},unconvert:function(t,e){var i=this.utils.buildWrapper(t);return i.find("th, td, figcaption, figure, pre, code, .redactor-component").removeAttr("contenteditable tabindex"),i.find("figure").removeClass("redactor-component redactor-component-active redactor-uploaded-figure"),i.find("[data-redactor-type=variable]").removeClass("redactor-component"),i.find("figure[data-redactor-type=line]").unwrap(),i.find("figure[data-redactor-type=widget]").each(this._unconvertWidget.bind(this)),i.find("figure[data-redactor-type=form]").each(this._unconvertForm.bind(this)),i.find("figure[data-redactor-type=table]").each(this._unconvertTable.bind(this)),i.find("figure[data-redactor-type=image]").removeAttr("rel").each(this._unconvertImages.bind(this)),i.find("img").removeAttr("data-redactor-type").removeClass("redactor-component"),i.find(".non-editable").removeAttr("contenteditable"),i.find("figure").each(this._removeTypes.bind(this)),i.find("span.redactor-component-caret").remove(),this.opts.breakline&&i.find('[data-redactor-tag="br"]').each(function(t){t.lastChild&&"BR"!==t.lastChild.tagName&&t.appendChild(document.createElement("br"))}).unwrap(),this._acceptExtraRules(i,e),t=this.utils.getWrapperHtml(i),t.replace(/<br\s?\/?>$/,"")},_convertImage:function(t){var e=$R.dom(t);if(!this._isNonEditable(e)){e.attr("data-image")||e.attr("data-image",this.utils.getRandomId());var i=e.closest("a"),s=e.closest("figure"),a=0===s.children().not("a, img, br, figcaption").length;a&&(0===s.length?s=0!==i.length?i.wrap("<figure>"):e.wrap("<figure>"):s.hasClass("redactor-uploaded-figure")?s.removeClass("redactor-uploaded-figure"):s.addClass("redactor-keep-figure"),this._setFigure(s,"image"))}},_convertTable:function(t){if(!this._isNonEditable(t)){var e=this._wrapFigure(t);this._setFigure(e,"table")}},_convertLine:function(t){if(!this._isNonEditable(t)){var e=this._wrapFigure(t);this._setFigure(e,"line")}},_convertForm:function(t){if(!this._isNonEditable(t)){var e=this.utils.replaceToTag(t,"figure");this._setFigure(e,"form")}},_convertIframe:function(t){if(!this._isNonEditable(t)){var e=t.getAttribute("src"),i=e&&(e.match(this.opts.regex.youtube)||e.match(this.opts.regex.vimeo)),s=this._wrapFigure(t);i&&this._setFigure(s,"video")}},_convertCode:function(t){if(!this._isNonEditable(t)){var e=this._wrapFigure(t);this._setFigure(e,"code")}},_convertWidget:function(t){if(!this._isNonEditable(t)){var e=$R.dom(t);e.addClass("redactor-component"),e.attr("data-redactor-type","widget"),e.attr("data-widget-code",encodeURI(t.innerHTML.trim()))}},_unconvertForm:function(t){this.utils.replaceToTag(t,"form")},_unconvertTable:function(t){var e=$R.dom(t);e.unwrap()},_unconvertWidget:function(t){var e=$R.dom(t);e.html(decodeURI(e.attr("data-widget-code"))),e.removeAttr("data-widget-code")},_unconvertImages:function(t){var e=$R.dom(t);e.removeClass("redactor-component");var i=0!==e.closest("li").length,s=0!==e.closest("table").length,a=0!==e.find("figcaption").length,n=e.attr("style"),r=!(null===n||""===n),o=""!==e.attr("class");(i||s&&!a&&!r&&!o)&&e.unwrap()},_removeTypes:function(t){var e=$R.dom(t),i=e.attr("data-redactor-type"),s=["image","widget","line","video","code","form","table"];if(i&&-1!==s.indexOf(i)&&e.removeAttr("data-redactor-type"),e.hasClass("redactor-keep-figure"))e.removeClass("redactor-keep-figure");else if(!1===this.opts.imageFigure){var a=0!==e.find("figcaption").length;a||e.unwrap()}},_wrapFigure:function(t){var e=$R.dom(t),i=e.closest("figure");return 0===i.length?e.wrap("<figure>"):i},_setFigure:function(t,e){t.addClass("redactor-component"),t.attr("data-redactor-type",e)},_setContenteditableCode:function(t){if(!this._isNonEditable(t)){var e=$R.dom(t),i=e.children("code").first(),s=0!==i.length?i:e;s.attr("contenteditable",!0).attr("tabindex","-1")}},_acceptExtraRules:function(t,e){for(var i in e)"function"==typeof e[i]&&e[i](t)},_isNonEditable:function(t){return 0!==$R.dom(t).closest(".non-editable").length}}),$R.add("class","cleaner.paragraphize",{init:function(t){this.app=t,this.opts=t.opts,this.utils=t.utils,this.element=t.element,this.stored=[],this.remStart="#####replace",this.remEnd="#####",this.paragraphizeTags=["table","div","pre","form","ul","ol","h1","h2","h3","h4","h5","h6","dl","blockquote","figcaption","address","section","header","footer","aside","article","object","style","script","iframe","select","input","textarea","button","option","map","area","math","hr","fieldset","legend","hgroup","nav","figure","details","menu","summary","p"]},convert:function(t){var e=this._isConverted(t);return!0===e?this._convert(t):e},_convert:function(t){var e=this.opts.breakline?"sdivtag":this.opts.markup;return t=this._storeTags(t),t=t.trim(),this.opts.breakline?(t=t.replace(new RegExp("\\n#####","gi"),"xnonbreakmarkerz#####"),t=t.replace(new RegExp("#####\\n\\n","gi"),"#####\nxnonbreakmarkerz"),t=t.replace(new RegExp("#####\\n","gi"),"#####xnonbreakmarkerz"),t=t.replace(/<br\s?\/?>\n/gi,"<br>"),t=t.replace(/\n/g,"<br>"),t=t.replace(/xnonbreakmarkerz/gi,"\n")):t=t.replace(/[\n]+/g,"\n"),t=this._trimEmptyLines(t),t=this.opts.breakline?t:t.replace(/<br\s?\/?>\n/gi,"xbreakmarkerz\n"),t=t.replace(/(?:\r\n|\r|\n)/g,"xparagraphmarkerz"),t=t.replace(/xparagraphmarkerz/gi,"</"+e+">\n<"+e+">"),t=this.opts.breakline?t:t.replace(/xbreakmarkerz/gi,"<br>"),t="<"+e+">"+t+"</"+e+">",t=t.replace(new RegExp("<"+e+">#####","gi"),"#####"),t=t.replace(new RegExp("#####</"+e+">","gi"),"#####"),t=this._restoreTags(t),t=this.opts.breakline?t:t.replace(new RegExp("<"+e+"><br\\s?/?></"+e+">","gi"),"<"+e+"></"+e+">"),t=t.replace(new RegExp("<sdivtag>","gi"),'<div data-redactor-tag="br">'),t.replace(new RegExp("sdivtag","gi"),"div")},_storeTags:function(t){var e=this,i=this.utils.buildWrapper(t);return this.opts.breakline&&i.find("p").each(function(t){var e=$R.dom(t),i=0===e.closest("figure[data-redactor-type=widget],figure[data-redactor-type=form],.non-editable").length;i&&(e.append("<br><br>"),e.unwrap())}),i.find(this.paragraphizeTags.join(", ")).each(function(t,i){var s=document.createTextNode("\n"+e.remStart+i+e.remEnd+"\n");e.stored.push(t.outerHTML),t.parentNode.replaceChild(s,t)}),this.utils.getWrapperHtml(i)},_restoreTags:function(t){for(var e=0;e<this.stored.length;e++)this.stored[e]=this.stored[e].replace(/\$/g,"&#36;"),t=t.replace(this.remStart+e+this.remEnd,this.stored[e]);return t},_trimEmptyLines:function(t){for(var e="",i=t.split("\n"),s=0;s<i.length;s++)""!==i[s].trim()&&(e+=i[s]+"\n");return e.replace(/\n$/,"")},_isConverted:function(t){return this._isDisabled(t)?t:!this._isEmptyHtml(t)||this.opts.emptyHtml},_isDisabled:function(){return!1===this.opts.paragraphize||this.element.isType("inline")},_isEmptyHtml:function(t){return""===t||"<p></p>"===t||"<div></div>"===t}}),$R.add("service","detector",{init:function(t){this.app=t,this.userAgent=navigator.userAgent.toLowerCase()},isWebkit:function(){return/webkit/.test(this.userAgent)},isFirefox:function(){return this.userAgent.indexOf("firefox")>-1},isIe:function(t){return document.documentMode||/Edge/.test(navigator.userAgent)?"edge":(e=RegExp("msie"+(isNaN(t)?"":"\\s"+t),"i").test(navigator.userAgent),e||(e=!!navigator.userAgent.match(/Trident.*rv[ :]*11\./)),e);var e},isMobile:function(){return/(iPhone|iPod|Android)/.test(navigator.userAgent)},isDesktop:function(){return!/(iPhone|iPod|iPad|Android)/.test(navigator.userAgent)},isIpad:function(){return/iPad/.test(navigator.userAgent)}}),$R.add("service","offset",{init:function(t){this.app=t},get:function(t,e){var i={start:0,end:0},s=this.utils.getNode(t);if(!s)return!1;var a=this.editor.isEditor(s),n=!!a||this.selection.isIn(s),r=this.selection.getRange();if(a||n){if(this.selection.is()&&n){var o=$R.dom(r.startContainer),l=o.hasClass("redactor-component")?r.startOffset:0,c=r.cloneRange();c.selectNodeContents(s),c.setEnd(r.startContainer,r.startOffset);var d=this._getString(r,e);i.start=this._getString(c,e).length-l,i.end=i.start+d.length+l}}else i=!1;return i},set:function(t,e){if(!this._setComponentOffset(e)){this.component.clearActive();var i=this.utils.getNode(e);if(i){var s=this.size(i),a=0,n=document.createRange();t.end=t.end>s?s:t.end,n.setStart(i,0),n.collapse(!0);for(var r=[i],o=!1,l=!1;!l&&(i=r.pop());)if(3==i.nodeType){var c=a+i.length;!o&&!this._isFigcaptionNext(i)&&t.start>=a&&t.start<=c&&(n.setStart(i,t.start-a),o=!0),o&&t.end>=a&&t.end<=c&&(n.setEnd(i,t.end-a),l=!0),a=c}else for(var d=i.childNodes.length;d--;)r.push(i.childNodes[d]);this.selection.setRange(n)}}},size:function(t,e){var i=this.utils.getNode(t);if(i){var s=document.createRange(),a=s.cloneRange();return a.selectNodeContents(i),this._getString(a,e).length}return 0},_getString:function(t,e){var i=t.toString();return i=this.editor.isEmpty()?i.replace(/\uFEFF/g,""):i,e?i.trim():i},_setComponentOffset:function(t){return!!this.component.isNonEditable(t)&&this.component.setActive(t)},_isFigcaptionNext:function(t){var e=t.nextSibling;return""===t.nodeValue.trim()&&e&&"FIGCAPTION"===e.tagName}}),$R.add("service","inspector",{init:function(t){this.app=t},parse:function(t){return $R.create("inspector.parser",this.app,this,t)},isText:function(t){if("string"==typeof t&&!/^\s*<(\w+|!)[^>]*>/.test(t))return!0;var e=$R.dom(t).get();return e&&3===e.nodeType},isInlineTag:function(t,e){var i=this._extendTags(this.opts.inlineTags,e);return this._isTag(t)&&-1!==i.indexOf(t.toLowerCase())},isBlockTag:function(t,e){var i=this._extendTags(this.opts.blockTags,e);return this._isTag(t)&&-1!==i.indexOf(t.toLowerCase())},isTableCellTag:function(t){return-1!==["td","th"].indexOf(t.toLowerCase())},isHeadingTag:function(t){return-1!==["h1","h2","h3","h4","h5","h6"].indexOf(t.toLowerCase())},_isTag:function(t){return void 0!==t&&t},_extendTags:function(t,e){if(t=t.concat(t),e)for(var i=0;i<e.length;i++)t.push(e[i]);return t}}),$R.add("class","inspector.parser",{init:function(t,e,i){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.utils=t.utils,this.editor=t.editor,this.selection=t.selection,this.inspector=e,this.el=i,this.$el=$R.dom(this.el),this.node=this.$el.get(),this.$component=this.$el.closest(".redactor-component",".redactor-in")},isEditor:function(){return this.node===this.editor.getElement().get()},isInEditor:function(){return 0!==this.$el.parents(".redactor-in-"+this.uuid).length},isComponent:function(){return 0!==this.$component.length},isComponentType:function(t){return this.getComponentType()===t},isComponentActive:function(){return this.isComponent()&&this.$component.hasClass("redactor-component-active")},isComponentEditable:function(){var t=["code","table"],e=this.getComponentType();return this.isComponent()&&-1!==t.indexOf(e)},isFigcaption:function(){return this.getFigcaption()},isPre:function(){return this.getPre()},isCode:function(){var t=this.$el.closest("code"),e=t.parent("pre");return 0!==t.length&&0===e.length},isList:function(){return this.getList()},isFirstListItem:function(){return this._getLastOrFirstListItem("first")},isLastListItem:function(){return this._getLastOrFirstListItem("last")},isFirstTableCell:function(){return this._getLastOrFirstTableCell("first")},isLastTableCell:function(){return this._getLastOrFirstTableCell("last")},isTable:function(){return this.isComponentType("table")||this.getTable()},isHeading:function(){return this.getHeading()},isBlockquote:function(){return this.getBlockquote()},isDl:function(){return this.getDl()},isParagraph:function(){return this.getParagraph()},isLink:function(){return this.getLink()},isFile:function(){return this.getFile()},isText:function(){return this.inspector.isText(this.el)},isInline:function(){var t=this.opts.inlineTags;return!!this.isElement()&&-1!==t.indexOf(this.node.tagName.toLowerCase())},isBlock:function(){var t=this.opts.blockTags;return!!this.isElement()&&-1!==t.indexOf(this.node.tagName.toLowerCase())},isElement:function(){return this.node&&this.node.nodeType&&3!==this.node.nodeType},hasParent:function(t){return 0!==this.$el.closest(t.join(",")).length},getNode:function(){return this.node},getTag:function(){return!!this.isElement()&&this.node.tagName.toLowerCase()},getComponent:function(){return!!this.isComponent()&&this.$component.get()},getComponentType:function(){return!!this.isComponent()&&this.$component.attr("data-redactor-type")},getFirstNode:function(){return this.utils.getFirstNode(this.node)},getLastNode:function(){return this.utils.getLastNode(this.node)},getFirstElement:function(){return this.utils.getFirstElement(this.node)},getLastElement:function(){return this.utils.getLastElement(this.node)},getFigcaption:function(){return this._getClosestNode("figcaption")},getPre:function(){return this._getClosestNode("pre")},getCode:function(){return this._getClosestNode("code")},getList:function(){return this._getClosestNode("ul, ol")},getParentList:function(){return this._getClosestUpNode("ul, ol")},getListItem:function(){return this._getClosestNode("li")},getTable:function(){return this.getComponentType("table")?this.$component.find("table").get():this._getClosestNode("table")},getTableCell:function(){var t=this.$el.closest("td, th");return 0!==t.length&&t.get()},getComponentCodeElement:function(){return!!this.isComponentType("code")&&this.$component.find("pre code, pre").last().get()},getImageElement:function(){return!!this.isComponentType("image")&&this.$component.find("img").get()},getParagraph:function(){return this._getClosestNode("p")},getHeading:function(){return this._getClosestNode("h1, h2, h3, h4, h5, h6")},getDl:function(){return this._getClosestNode("dl")},getBlockquote:function(){return this._getClosestNode("blockquote")},getLink:function(){var t=this.isComponent()&&!this.isFigcaption(),e=this.isComponentType("table");if(e||!t){var i=this._getClosestElement("a");return!(!i||i.attr("data-file"))&&i.get()}return!1},getFile:function(){var t=this.isComponent(),e=this.isComponentType("table");if(e||!t){var i=this._getClosestElement("a");return!(!i||!i.attr("data-file"))&&i.get()}return!1},findFirstNode:function(t){return this.$el.find(t).first().get()},findLastNode:function(t){return this.$el.find(t).last().get()},_getLastOrFirstListItem:function(t){var e=this.getList(),i=this.getTag();if(e&&"li"===i){var s=$R.dom(e).find("li")[t]().get();if(s&&this.node===s)return!0}return!1},_getLastOrFirstTableCell:function(t){var e=this.getTable(),i=this.getTag();if(e&&("td"===i||"th"===i)){var s=$R.dom(e).find("td, th")[t]().get();if(s&&this.node===s)return!0}return!1},_getClosestUpNode:function(t){var e=this.$el.parents(t,".redactor-in").last();return 0!==e.length&&e.get()},_getClosestNode:function(t){var e=this.$el.closest(t,".redactor-in");return 0!==e.length&&e.get()},_getClosestElement:function(t){var e=this.$el.closest(t,".redactor-in");return 0!==e.length&&e}}),$R.add("service","marker",{init:function(t){this.app=t},build:function(t,e){var i=document.createElement("span");return i.id="selection-marker-"+this._getPos(t),i.className="redactor-selection-marker",i.innerHTML=this.opts.markerChar,e?i.outerHTML:i},buildHtml:function(t){return this.build(t,!0)},insert:function(t){this.remove();var e="both"!==t&&("start"===t||this.selection.isCollapsed());this.selection.is()||this.editor.focus();var i=this.selection.getRange();if(i){var s=this.build("start"),a=this.build("end"),n=i.cloneRange();return e||(n.collapse(!1),n.insertNode(a)),n.setStart(i.startContainer,i.startOffset),n.collapse(!0),n.insertNode(s),i.setStartAfter(s),e||i.setEndBefore(a),this.selection.setRange(i),s}},find:function(t,e){var i=this.editor.getElement(),s=(e||i).find("span#selection-marker-"+this._getPos(t));return 0!==s.length&&s.get()},restore:function(){var t=this.find("start"),e=this.find("end"),i=this.selection.getRange();if(i&&this.selection.is()||(this.editor.focus(),i=document.createRange()),t){var s=!!e&&e.previousSibling,a=t.nextSibling;a=(!a||3!==a.nodeType||""!==a.textContent.replace(/[\n\t]/g,""))&&a,e?a&&"selection-marker-end"===a.id?this._restoreInject(i,t):s&&a?(i.selectNodeContents(s),i.collapse(!1),i.setStart(a,0)):s&&!a?(i.selectNodeContents(s),i.collapse(!1),i.setStartAfter(t)):(i.setStartAfter(t),i.setEndBefore(e)):a?(i.selectNodeContents(a),i.collapse(!0)):this._restoreInject(i,t),this.selection.setRange(i),t&&t.parentNode.removeChild(t),e&&e.parentNode.removeChild(e)}},remove:function(){var t=this.find("start"),e=this.find("end");t&&t.parentNode.removeChild(t),e&&e.parentNode.removeChild(e)},_getPos:function(t){return void 0===t?"start":t},_restoreInject:function(t,e){var i=this.utils.createInvisibleChar();$R.dom(e).after(i),t.selectNodeContents(i),t.collapse(!1)}}),$R.add("service","component",{init:function(t){this.app=t,this.activeClass="redactor-component-active"},create:function(t,e){return $R.create(t+".component",this.app,e)},build:function(t){var e,i=$R.dom(t),s=i.attr("data-redactor-type");return s&&(e=this.create(s,t)),e||t},remove:function(t,e){var i=$R.dom(t).closest(".redactor-component"),s=i.attr("data-redactor-type"),a=i.parent(),n=this.inspector.parse(a),r=this.utils.findSiblings(i,"prev"),o=this.utils.findSiblings(i,"next"),l=this.app.broadcast(s+".delete",i);if(!1!==l){if(i.remove(),this.app.broadcast(s+".deleted",i),this.app.broadcast("contextbar.close"),this.app.broadcast("imageresizer.stop"),!1!==e){var c=n.getTableCell();c&&this.utils.isEmptyHtml(c.innerHTML)?this.caret.setStart(c):o?this.caret.setStart(o):r?this.caret.setEnd(r):this.editor.startFocus()}this.editor.isEmpty()&&(this.editor.setEmpty(),this.editor.startFocus(),this.app.broadcast("empty"))}},isNonEditable:function(t){var e=this.inspector.parse(t);return e.isComponent()&&!e.isComponentEditable()},isActive:function(t){var e;if(t){var i=this.inspector.parse(t);return e=$R.dom(i.getComponent()),e.hasClass(this.activeClass)}return e=this._find(),0!==e.length},getActive:function(t){var e=this._find();return 0!==e.length&&(t?e:e.get())},setActive:function(t){this.clearActive(),this.editor.focus();var e=this.inspector.parse(t),i=e.getComponent(),s=$R.dom(i);if(!e.isFigcaption()){var a=s.find(".redactor-component-caret");0===a.length&&(a=this._buildCaret(),s.prepend(a)),this.caret.setAtStart(a.get())}s.addClass(this.activeClass)},clearActive:function(){var t=this._find();t.removeClass(this.activeClass),t.find(".redactor-component-caret").remove(),this.app.broadcast("imageresizer.stop")},setOnEvent:function(t,e){this.clearActive();var i=this.inspector.parse(t.target);i.isFigcaption()||i.isComponentEditable()||i.isComponent()&&(this.setActive(t.target),!0!==e&&t.preventDefault())},executeScripts:function executeScripts(){for(var $editor=this.editor.getElement(),scripts=$editor.find("[data-redactor-type]").find("script").getAll(),i=0;i<scripts.length;i++)if(""!==scripts[i].src){var src=scripts[i].src;this.$doc.find('head script[src="'+src+'"]').remove();var $script=$R.dom("<script>");$script.attr("src",src),$script.attr("async defer"),-1!==src.search("instagram")&&$script.attr("onload","window.instgrm.Embeds.process()");var head=document.getElementsByTagName("head")[0];head&&head.appendChild($script.get())}else eval(scripts[i].innerHTML)},_find:function(){return this.editor.getElement().find("."+this.activeClass)},_buildCaret:function(){var t=$R.dom("<span>");return t.addClass("redactor-component-caret"),t.attr("contenteditable",!0),t}}),$R.add("service","insertion",{init:function(t){this.app=t},set:function(t,e,i){t=!1!==e?this.cleaner.input(t):t,t=!1!==e?this.cleaner.paragraphize(t):t;var s=this.editor.getElement();return s.html(t),!1!==i&&this.editor.endFocus(),t},insertNode:function(t,e){this.editor.focus();var i=this.utils.isFragment(t)?t:this.utils.createFragment(t);return this._collapseSelection(),this._insertFragment(i),this._setCaret(e,i),this._sendNodes(i.nodes)},insertBreakLine:function(){return this.insertNode(document.createElement("br"),"after")},insertNewline:function(){return this.insertNode(document.createTextNode("\n"),"after")},insertText:function(t){return this.insertHtml(this.cleaner.getFlatText(t))},insertChar:function(t){return this.insertNode(t,"after")},insertRaw:function(t){return this.insertHtml(t,!1)},insertToEnd:function(t,e){if(t){3===t.nodeType&&-1!==t.nodeValue.search(/^\n/)&&(t=t.previousElementSibling);var i=$R.dom(t);if(i.attr("data-redactor-type")===e){var s=this.opts.breakline?"<br>":"<p>",a=$R.dom(s);i.after(a),this.caret.setStart(a)}}},insertPoint:function(t){var e,i,s=this.marker.build("start"),a=!1,n=t.clientX,r=t.clientY;if(document.caretPositionFromPoint){var o=document.caretPositionFromPoint(n,r),l=document.getSelection();i=this.inspector.parse(o.offsetNode),i.isInEditor()&&(e=l.getRangeAt(0),e.setStart(o.offsetNode,o.offset),e.collapse(!0),e.insertNode(s),a=!0)}else document.caretRangeFromPoint&&(e=document.caretRangeFromPoint(n,r),i=this.inspector.parse(e.startContainer),i.isInEditor()&&(e.insertNode(s),a=!0));return a},insertToPoint:function(t,e,i){var s=!0===i||this.insertPoint(t);if(!s){var a=this.editor.getLastNode();$R.dom(a).after(this.marker.build("start"))}return this.component.clearActive(),this.selection.restoreMarkers(),this.insertHtml(e)},insertToOffset:function(t,e){return this.offset.set({start:t,end:t}),this.insertHtml(e)},insertHtml:function(t,e){if(this.opts.input){var i=this.utils.parseHtml(t);if(this.selection.isAll())return this._insertToAllSelected(i);if(!this.selection.is()){var s=$R.dom("<p>"),a=this.editor.getElement();a.append(s),this.caret.setStart(s)}var n=this.selection.isCollapsed(),r=this.selection.isText(),o=this.selection.getCurrent(),l=this.inspector.parse(o);this._collapseSelection(),i=this._getCleanedInput(i,l,e);var c,d,u=this._isFigure(i.html),h=this._isComponentSpan(i.html),m=this.inspector.isText(i.html);if(this.editor.isEmpty())return this._insertToEmptyEditor(i.html);if(l.isComponent()&&!l.isComponentEditable())return this._insertToWidget(o,l,i.html);if(h)return this.insertNode(i.nodes,"end");if(u&&!r&&!l.isList())return l.isInline()?this._insertToInline(o,i):(c=this.utils.createFragment(i.html),this.utils.splitNode(o,c),this.caret.setEnd(c.last),this._sendNodes(c.nodes));if(l.isCode())return this._insertToCode(i,o,e);if(l.isPre())return this._insertToPre(i,e);if(l.isHeading()||l.isFigcaption())return i.html=!1!==e?this.cleaner.removeTagsExcept(i.html,["a"]):i.html,i.html=!1!==e?this.cleaner.replaceNbspToSpaces(i.html):i.html,c=this.utils.createFragment(i.html),this.insertNode(c,"end");if(m)return!r&&"br"!==this.opts.markup&&this._hasBlocksAndImages(i.nodes)?(i.html=!1!==e?this.cleaner.paragraphize(i.html):i.html,c=this.utils.createFragment(i.html),this.utils.splitNode(o,c),this.caret.setEnd(c.last),this._sendNodes(c.nodes)):(i.html=!1!==e?i.html.replace(/\n/g,"<br>"):i.html,c=this.utils.createFragment(i.html),this.insertNode(c.nodes,"end"));if(!n&&!u)return i.html=!1!==e?this.cleaner.paragraphize(i.html):i.html,c=this.utils.createFragment(i.html),this.insertNode(c,"end");if(l.isInline()&&!this._isPlainHtml(i.html))return this._insertToInline(o,i);if(l.isBlockquote()||l.isDl())return d=this.opts.inlineTags,d.concat(["br"]),i.html=!1!==e?this.cleaner.replaceBlocksToBr(i.html):i.html,i.html=!1!==e?this.cleaner.removeTagsExcept(i.html,d):i.html,c=this.utils.createFragment(i.html),this.insertNode(c,"end");if(l.isParagraph())return this._isPlainHtml(i.html)?this.insertNode(i.nodes,"end"):(i.html=!1!==e?this.cleaner.paragraphize(i.html):i.html,c=this.utils.createFragment(i.html),this.utils.splitNode(o,c),this.caret.setEnd(c.last),this._sendNodes(c.nodes));if(l.isList()&&(d=this.opts.inlineTags,d=d.concat(["br","li","ul","ol","img"]),i.html=!1!==e?this.cleaner.replaceBlocksToBr(i.html):i.html,i.html=!1!==e?this.cleaner.removeTagsExcept(i.html,d):i.html,i.html=!1!==e?this.cleaner.removeBrAtEnd(i.html):i.html,c=this.utils.createFragment(i.html),i.nodes=c.nodes,this._containsTags(i.html,["ul","ol","li"]))){var p=this.selection.getElement(o);if(p&&"LI"===p.tagName&&this.caret.isStart(p)){i.nodes=$R.dom(c.nodes).unwrap("ul, ol").getAll(),$R.dom(p).before(i.nodes);var f=i.nodes[i.nodes.length-1];return this.caret.setEnd(f),this._sendNodes(i.nodes)}return this._isPlainHtml(i.html)?this.insertNode(c,"end"):(c=this._buildList(i,p,c),this.utils.splitNode(o,c,!0),this.caret.setEnd(c.last),this._sendNodes(c.nodes))}return this.insertNode(i.nodes,"end")}},_insertToAllSelected:function(t){var e=this.set(t.html),i=this.utils.parseHtml(e);return this._sendNodes(i.nodes)},_insertToEmptyEditor:function(t){t=this.cleaner.paragraphize(t);var e=this.utils.createFragment(t),i=this.editor.getElement();return i.html(""),i.append(e.frag),this.caret.setEnd(i),this._sendNodes(e.nodes)},_insertToInline:function(t,e){var i=this.utils.createFragment(e.html);return this.utils.splitNode(t,i,!1,!0),this.caret.setEnd(i.last),this._sendNodes(i.nodes)},_insertToCode:function(t,e,i){t.html=!1!==i?this.cleaner.encodeHtml(t.html):t.html,t.html=!1!==i?this.cleaner.removeNl(t.html):t.html;var s=this.utils.createFragment(t.html),a=this.insertNode(s,"end");return this.utils.normalizeTextNodes(e),a},_insertToPre:function(t,e){t.html=!1!==e?this.cleaner.encodeHtml(t.html):t.html;var i=this.utils.createFragment(t.html);return this.insertNode(i,"end")},_insertToWidget:function(t,e,i){i=this._isComponentSpan(i)?i:this.cleaner.paragraphize(i);var s=this.utils.createFragment(i),a=e.getComponent(),n=$R.dom(a);return n.after(s.frag),n.remove(),this.caret.setEnd(s.last),this._sendNodes(s.nodes)},_insertFragment:function(t){var e=this.selection.getRange();if(e){if(this.selection.isCollapsed()){var i=e.startContainer;3!==i.nodeType&&"BR"===i.tagName&&(this.caret.setAfter(i),i.parentNode.removeChild(i))}else e.deleteContents();e.insertNode(t.frag)}},_sendNodes:function(t){for(var e=0;e<t.length;e++){var i=t[e],s=3!==i.nodeType&&"function"==typeof i.getAttribute&&i.getAttribute("data-redactor-type");s&&this.app.broadcast(s+".inserted",this.component.build(i))}return this.app.broadcast("inserted",t),this.component.executeScripts(),t},_setCaret:function(t,e){var i=this._isLastInline(e);t?(t=i&&"end"===t?"after":t,this.caret["set"+this.utils.ucfirst(t)](e.last)):!1!==t&&i&&this.caret.setAfter(e.last)},_isLastInline:function(t){if(t.last){var e=this.inspector.parse(t.last);return e.isInline()}return!1},_getCleanedInput:function(t,e,i){var s=e.isCode()||e.isPre();return t.html=s||!1===i?t.html:this.cleaner.input(t.html),s||!1===i?t:this.utils.parseHtml(t.html)},_getContainer:function(t){return $R.dom(this.utils.createTmpContainer(t))},_buildList:function(t,e,i){var s=t.nodes,a=s[0];if(a&&3!==a.nodeType&&"li"===a.tagName){var n=$R.dom(e),r=n.get().tagName.toLowerCase(),o=$R.dom("<"+r+" />");return o.append(i.nodes),this.utils.createFragment(o.get().outerHTML)}return i},_containsTags:function(t,e){return 0!==this._getContainer(t).find(e.join(",")).length},_collapseSelection:function(){},_hasFigureOrTable:function(t){return 0!==this._getContainer(t).find("figure, table").length},_hasBlocks:function(t){return 0!==this._getContainer(t).find(this.opts.blockTags.join(",")).length},_hasBlocksAndImages:function(t){return 0!==this._getContainer(t).find(this.opts.blockTags.join(",")+",img").length},_isPlainHtml:function(t){return 0===this._getContainer(t).find(this.opts.blockTags.join(",")+", img").length},_isFigure:function(t){return this._isHtmlString(t)?0!==$R.dom(t).closest("figure").length:void 0},_isComponentSpan:function(t){return this._isHtmlString(t)?0!==$R.dom(t).closest("span.redactor-component").length:void 0},_isHtmlString:function(t){return!("string"==typeof t&&!/^\s*<(\w+|!)[^>]*>/.test(t))}}),$R.add("service","block",{mixins:["formatter"],init:function(t){this.app=t},format:function(t){return this.type=t.type?t.type:"set",this.tag="string"==typeof t?t:t.tag,this.tag=this._prepareTag(this.tag),this.tag=this.tag.toLowerCase(),"string"==typeof t?this.args=!1:this.buildArgs(t),this._format()},getBlocks:function(t){return this.selection.getBlocks({tags:t||this._getTags(),first:!0})},getElements:function(t){var e=this.selection.getBlock();return this.selection.isCollapsed()||!e||"TD"!==e.tagName&&"TH"!==e.tagName?$R.dom(this.getBlocks(t)):this._wrapInsideTable("div")},clearFormat:function(t){this.selection.save();var e=this.getElements(t||this._getTags());return e.each(function(t){for(;t.attributes.length>0;)t.removeAttribute(t.attributes[0].name)}),this.selection.restore(),e.getAll()},_format:function(){this.selection.save();var t,e,i=this.getBlocks(),s=this.selection.getBlock(),a=[];if(1===i.length&&"DIV"===i[0].tagName){if(t=this._getTextNodesData(),!t||0===t.nodes.length)return a=this._replaceBlocks(i),a=this._sendNodes(a),setTimeout(function(){this.selection.restore()}.bind(this),0),a;e=this._getReplacedTag("set"),o=$R.dom("<"+e+">"),l=t.last.nextSibling,l&&"BR"===l.tagName&&$R.dom(l).remove();for(var n=0;n<t.nodes.length;n++)o.append(t.nodes[n]);return this.utils.splitNode(i[0],[o.get()]),a=this._sendNodes([o.get()]),this.utils.isEmptyHtml(o.html())?this.caret.setStart(o):setTimeout(function(){this.selection.restore()}.bind(this),0),a}if(i.length>0)return a=this._replaceBlocks(i),a=this._sendNodes(a),setTimeout(function(){this.selection.restore()}.bind(this),0),a;if(!this.selection.isCollapsed()&&s&&("TD"===s.tagName||"TH"===s.tagName))return e=this._getReplacedTag("set"),o=this._wrapInsideTable(e),this.selection.setAll(o),this._sendNodes([o.get()]);if(this.selection.isCollapsed()&&s&&("TD"===s.tagName||"TH"===s.tagName)){var r=this._getChildTextNodes(s);e=this._getReplacedTag("set");var o=$R.dom("<"+e+">");$R.dom(r.first).before(o);for(n=0;n<r.nodes.length;n++)o.append(r.nodes[n]);var l=o.get().nextSibling;return l&&"BR"===l.tagName&&$R.dom(l).remove(),this._sendNodes([o.get()])}return a},_wrapInsideTable:function(t){var e=this._getTextNodesData(),i=$R.dom("<"+t+">");$R.dom(e.first).before(i);for(var s=0;s<e.nodes.length;s++)i.append(e.nodes[s]);var a=i.get().nextSibling;return a&&"BR"===a.tagName&&$R.dom(a).remove(),i},_prepareTag:function(t){return"undefined"==typeof t?this.opts.markup:t},_sendNodes:function(t){return t.length>0&&(t=this.applyArgs(t,!1),t=this._combinePre(t),t=this._cleanBlocks(t)),t},_getTags:function(){return["div","p","blockquote","pre","h1","h2","h3","h4","h5","h6"]},_replaceBlocks:function(t){for(var e=[],i=this._isToggleFormatType(t)?"toggle":"set",s=this._getReplacedTag(i),a=0;a<t.length;a++){var n=this.utils.replaceToTag(t[a],s);e.push(n.get())}return e},_getReplacedTag:function(t){var e="toggle"===t?this.opts.markup:this.tag;return this.opts.breakline&&"p"===e?"div":e},_getChildTextNodes:function(t){for(var e=t.childNodes,i=e[0],s=[],a=0;a<=e.length;a++){var n=e[a];if(n&&3!==n.nodeType&&this.inspector.isBlockTag(n.tagName))break;s.push(n)}return{nodes:s,first:i}},_getTextNodesData:function(){var t=this.selection.getNodes({textnodes:!0,keepbr:!0});if(0===t.length)return!1;for(var e=t[0],i=t[t.length-1],s=i,a=!1;!a;){var n=this.selection.getInline(s);s=n?n.nextSibling:s.nextSibling,s&&(3===s.nodeType||"BR"!==s.tagName&&!this.inspector.isBlockTag(s.tagName))?t.push(s):a=!0}return{nodes:t,first:e,last:i}},_isToggleFormatType:function(t){for(var e=0,i=t.length,s=0;i>s;s++)t[s]&&this.tag===t[s].tagName.toLowerCase()&&e++;return e===i},_combinePre:function(t){for(var e=[],i=0;i<t.length;i++){var s=t[i].nextElementSibling;if(s&&"PRE"===t[i].tagName&&"PRE"===s.tagName){var a=$R.dom(t[i]),n=$R.dom(s),r=document.createTextNode("\n");a.append(r),a.append(n),n.unwrap("pre")}e.push(t[i])}return e},_cleanBlocks:function(t){for(var e=["h1","h2","h3","h4","h5","h6"],i=this.opts.inlineTags,s=0;s<t.length;s++){var a=t[s].tagName.toLowerCase(),n=$R.dom(t[s]);-1!==e.indexOf(a)?n.find("span").not(".redactor-component, .non-editable, .redactor-selection-marker").unwrap():"pre"===a&&n.find(i.join(",")).not(".redactor-selection-marker").unwrap(),this.opts.breakline&&"div"===a?n.attr("data-redactor-tag","br"):n.removeAttr("data-redactor-tag"),this.utils.normalizeTextNodes(t[s])}return t}}),$R.add("service","inline",{mixins:["formatter"],init:function(t){this.app=t,this.count=0},format:function(t){if(!this._isFormat())return[];this.type=t.type?t.type:"set",this.tag="string"==typeof t?t:t.tag,this.tag=this.tag.toLowerCase(),this.tag=this.arrangeTag(this.tag),"string"==typeof t?this.args=!1:this.buildArgs(t);var e=this.selection.isCollapsed()?this.formatCollapsed():this.formatUncollapsed();return e},_isFormat:function(){var t=this.selection.getCurrent(),e=this.inspector.parse(t),i=e.isComponent()&&!e.isComponentType("table")&&!e.isFigcaption();return!(!1!==t||!this.selection.isAll())||t&&!e.isPre()&&!e.isCode()&&!i},arrangeTag:function(t){var e=this.opts.replaceTags;for(var i in e)t===i&&(t=e[i]);return t},formatCollapsed:function(){var t,e,i,s,a=[],n=this.selection.getInlineFirst(),r=this.selection.getInlines({all:!0}),o=$R.dom(n);if(n){var l=this.inspector.parse(n),c=this.utils.isEmptyHtml(n.innerHTML);if(c)if(n.tagName.toLowerCase()===this.tag)if(this.hasSameArgs(n)){this.caret.setAfter(n),o.remove();var d=this.selection.getElement();this.utils.normalizeTextNodes(d)}else"span"===this.tag?(a=this.applyArgs([n],!1),this.caret.setStart(n)):a=this.insertInline(a);else l.hasParent([this.tag])?(t=o.closest(this.tag),e=t.get(),this.hasSameArgs(e)?(t.unwrap(),this.caret.setStart(n)):a=this.insertInline(a)):a=this.insertInline(a);else if(n.tagName.toLowerCase()===this.tag)this.hasSameArgs(n)?(s=this.utils.extractHtmlFromCaret(n),i=$R.dom("<"+this.tag+" />"),i=this.utils.cloneAttributes(n,i),o.after(i.append(s)),this.caret.setAfter(n)):a=this.insertInline(a);else if(l.hasParent([this.tag]))if(t=o.closest(this.tag),e=t.get(),this.hasSameArgs(e)){s=this.utils.extractHtmlFromCaret(e,e),i=$R.dom("<"+this.tag+" />"),i=this.utils.cloneAttributes(e,i);var u,h,m=0;r=r.reverse();for(var p=0;p<r.length;p++)r[p]!==e&&(h=$R.dom("<"+r[p].tagName.toLowerCase()+">"),0===m?u=h:u.append(h),m++);t.after(i.append(s)),t.after(u),this.caret.setStart(h)}else a=this.insertInline(a);else a=this.insertInline(a)}else a=this.insertInline(a);return a},insertInline:function(t){var e=document.createElement(this.tag);return t=this.insertion.insertNode(e,"start"),this.applyArgs(t,!1)},hasSameArgs:function(t){if(0===t.attributes.length&&!1===this.args)return!0;var e=!0;if(this.args){var i=0;for(var s in this.args){var a=$R.dom(t),n=this.args[s],r=this.utils.toParams(n),o=a.attr(s);if(n)if("style"===s){r=r.trim().replace(/;$/,"");for(var l=this.utils.styleToObj(a.attr("style")),c=r.split(";"),d=0,u=0;u<c.length;u++){var h=c[u].split(":"),m=h[0].trim(),p=h[1].trim();if(-1!==m.search(/color/)){var f=a.css(m);!f||f!==p&&this.utils.rgb2hex(f)!==p||d++}else a.css(m)===p&&d++}d===c.length&&_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_object_keys__WEBPACK_IMPORTED_MODULE_16___default()(l).length===c.length&&i++}else o===r&&i++;else o&&""!==o||i++}e=i===_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_object_keys__WEBPACK_IMPORTED_MODULE_16___default()(this.args).length}return e},formatUncollapsed:function(){var t=this.selection.getInlines({all:!0,inside:!0});this.selection.save(),this._convertTags("u"),this._convertTags("del"),this._convertToStrike(t),this.selection.restore(),document.execCommand("strikethrough"),this._clearDecoration(),this.selection.save();var e=this._revertToInlines();e=this.applyArgs(e,!1);for(var i=0;i<e.length;i++){var s=e[i],a=s.tagName.toLowerCase(),n=s.attributes.length;a===this.tag&&0===n&&this.args&&($R.dom(s).unwrap(),e.splice(i,1))}return this.selection.restore(),this._clearEmptyStyle(),this._normalizeBlocks(e)},_convertTags:function(t){if(this.tag!==t){var e=this.editor.getElement();e.find(t).each(function(e){var i=this.utils.replaceToTag(e,"span");i.addClass("redactor-convertable-"+t)}.bind(this))}},_revertTags:function(t){var e=this.editor.getElement();e.find("span.redactor-convertable-"+t).each(function(e){var i=this.utils.replaceToTag(e,t);i.removeClass("redactor-convertable-"+t),this.utils.removeEmptyAttr(i,"class")&&i.removeAttr("class")}.bind(this))},_convertToStrike:function(t){for(var e=this.selection.getText().replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),i=0;i<t.length;i++){var s=this.arrangeTag(t[i].tagName.toLowerCase()),a=t[i],n=$R.dom(a),r=this.hasSameArgs(a);s===this.tag&&("span"===this.tag&&this._isTextSelected(a,e)?n.addClass("redactor-convertable-apply"):r&&"a"!==this.tag?this._replaceToStrike(n):"span"===this.tag?n.addClass("redactor-unconvertable-apply"):r||n.addClass("redactor-convertable-apply"))}},_replaceToStrike:function(t){t.replaceWith(function(){return $R.dom("<strike>").append(t.contents())})},_revertToInlines:function(){var t=[],e=this.editor.getElement();return"u"!==this.tag&&e.find("u").unwrap(),e.find(".redactor-convertable-apply").each(function(e){var i=$R.dom(e);i.find("strike").unwrap(),this._forceRemoveClass(i,"redactor-convertable-apply"),t.push(e)}.bind(this)),e.find("span.redactor-unconvertable-apply").each(function(t){var e=$R.dom(t);this._forceRemoveClass(e,"redactor-unconvertable-apply")}.bind(this)),e.find("strike").each(function(e){var i=this.utils.replaceToTag(e,this.tag);t.push(i.get())}.bind(this)),this._revertTags("u"),this._revertTags("del"),t},_normalizeBlocks:function(t){var e=this.opts.inlineTags,i=this.selection.getBlocks();if(i)for(var s=0;s<i.length;s++)if("PRE"===i[s].tagName){var a=$R.dom(i[s]);a.find(e.join(",")).not(".redactor-selection-marker").each(function(e){-1!==t.indexOf(e)&&(t=this.utils.removeFromArrayByValue(t,e)),$R.dom(e).unwrap()}.bind(this))}return t},_clearDecoration:function(){var t=this.editor.getElement();t.find(this.opts.inlineTags.join(",")).each(function(t){if("line-through"===t.style.textDecoration||"line-through"===t.style.textDecorationLine){var e=$R.dom(t);e.css("textDecorationLine",""),e.css("textDecoration",""),e.wrap("<strike>")}})},_clearEmptyStyle:function(){for(var t=this.getInlines(),e=0;e<t.length;e++){this._clearEmptyStyleAttr(t[e]);var i=t[e].childNodes;if(i)for(var s=0;s<i.length;s++)this._clearEmptyStyleAttr(i[s])}},_clearEmptyStyleAttr:function(t){3!==t.nodeType&&this.utils.removeEmptyAttr(t,"style")&&(t.removeAttribute("style"),t.removeAttribute("data-redactor-style-cache"))},_forceRemoveClass:function(t,e){t.removeClass(e),this.utils.removeEmptyAttr(t,"class")&&t.removeAttr("class")},_isTextSelected:function(t,e){var i=this.utils.removeInvisibleChars(t.textContent);return e===i||-1!==e.search(new RegExp("^"+this.utils.escapeRegExp(i)+"$"))},getInlines:function(t){return t?this.selection.getInlines({tags:t,all:!0}):this.selection.getInlines({all:!0})},getElements:function(t){return $R.dom(this.getInlines(t))},clearFormat:function(){this.selection.save();for(var t=this.selection.getInlines({all:!0}),e=0;e<t.length;e++){var i=$R.dom(t[e]),s=this.selection.getInline(t[e]);s&&i.unwrap()}this.selection.restore()}}),$R.add("service","autoparser",{init:function(t){this.app=t},observe:function(){var t=this.editor.getElement(),e=t.find(".redactor-autoparser-object").each(function(t){var e=$R.dom(t);e.removeClass("redactor-autoparser-object"),""===e.attr("class")&&e.removeAttr("class")});e.length>0&&e.each(function(t){var e,i=!1,s=t.tagName;"A"===s?e="link":"IMG"===s?e="image":"IFRAME"===s&&(e="video"),e&&(i=$R.create(e+".component",this.app,t),this.app.broadcast(e+".inserted",i),this.app.broadcast("autoparse",e,i))}.bind(this))},format:function(t,e){this._isKey(e)&&this._format(e===this.keycodes.ENTER)},parse:function(t){var e=["figure","pre","iframe","code","a","img"],i=[],s=0;t=this.cleaner.encodePreCode(t);for(var a=0;a<e.length;a++){var n="img"===e[a]?"<"+e[a]+"[^>]*>":"<"+e[a]+"([\\w\\W]*?)</"+e[a]+">",r=t.match(new RegExp(n,"gi"));if(null!==r)for(var o=0;o<r.length;o++)t=t.replace(r[o],"#####replaceparse"+s+"#####"),i.push(r[o]),s++}if(this.opts.autoparseImages&&t.match(this.opts.regex.imageurl)){var l=t.match(this.opts.regex.imageurl);for(a=0;a<l.length;a++)t=t.replace(l[a],'<img class="redactor-autoparser-object" src="'+l[a]+'">')}if(this.opts.autoparseVideo&&(t.match(this.opts.regex.youtube)||t.match(this.opts.regex.vimeo))){var c,d,u='<iframe width="500" height="281" src="',h='" frameborder="0" allowfullscreen></iframe>';t.match(this.opts.regex.youtube)?(c="//www.youtube.com/embed/$1",d=this.opts.regex.youtube):t.match(this.opts.regex.vimeo)&&(c="//player.vimeo.com/video/$2",d=this.opts.regex.vimeo);var m=this.component.create("video",u+c+h);t=t.replace(d,m.get().outerHTML)}return this.opts.autoparseLinks&&t.match(this.opts.regex.url)&&(t=this._formatLinks(t)),t=this._restoreReplaced(i,t),this._restoreReplaced(i,t)},_isKey:function(t){return t===this.keycodes.ENTER||t===this.keycodes.SPACE},_format:function(t){var e=this.selection.getParent(),i=$R.dom(e),s=e&&0!==i.closest("figure, pre, code, img, a, iframe").length;if(!s&&this.selection.isCollapsed()){var a=this.utils.createInvisibleChar(),n=this.selection.getRange();n.insertNode(a);var r=this.selection.getCurrent(),o=this.inspector.parse(r),l=$R.dom(r);if(a.parentNode.removeChild(a),r&&3===r.nodeType){var c,d=r.textContent;if(this.opts.autoparseImages&&d.match(this._convertToRegExp(this.opts.regex.imageurl))){var u=o.isList(),h=d.match(this.opts.regex.imageurl),m=u?void 0:"<figure><img></figure>",p=this.component.create("image",m);p.setSrc(h[0]),p.addClass("redactor-autoparser-object"),d=d.replace(h[0],p.get().outerHTML),c="image"}else if(this.opts.autoparseVideo&&(d.match(this._convertToRegExp(this.opts.regex.youtube))||d.match(this._convertToRegExp(this.opts.regex.vimeo)))){var f,_,g='<iframe width="500" height="281" src="',b='" frameborder="0" allowfullscreen></iframe>';d.match(this.opts.regex.youtube)?(f="//www.youtube.com/embed/$1",_=this.opts.regex.youtube):d.match(this.opts.regex.vimeo)&&(f="//player.vimeo.com/video/$2",_=this.opts.regex.vimeo);var v=this.component.create("video",g+f+b);v.addClass("redactor-autoparser-object"),d=d.replace(_,v.get().outerHTML),c="video"}else this.opts.autoparseLinks&&d.match(this._convertToRegExp(this.opts.regex.url))&&(d=this._formatLinks(d,t),c="link");if(c){t?(this.selection.save(),l.replaceWith(d),this.selection.restore()):l.replaceWith(d);var y=this.editor.getElement(),C=y.find(".redactor-autoparser-object").removeClass("redactor-autoparser-object");if(C="link"===c?$R.create("link.component",this.app,C):C,"link"===c)t||this.caret.setAfter(C),this.app.broadcast("link.inserted",C);else{this.caret.setAfter(C);var D=C.clone();C.remove(),C=this.insertion.insertHtml(D),C=this.component.build(C)}this.app.broadcast("autoparse",c,C)}}}},_formatLinks:function(t,e){for(var i=t.match(this.opts.regex.url),s={},a=0;a<i.length;a++){e&&-1!==i[a].search(/\.$/)&&(i[a]=i[a].replace(/\.$/,""));var n=i[a],r=n,o=null!==n.match(/(https?|ftp):\/\//i)?"":"http://",l=-1!==["/","&","="].indexOf(n.slice(-1))?"":"\\b",c=!1!==this.opts.pasteLinkTarget?' target="'+this.opts.pasteLinkTarget+'"':"";r=r.length>this.opts.linkSize?r.substring(0,this.opts.linkSize)+"...":r,r=-1===r.search("%")?decodeURIComponent(r):r;var d="("+n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+l+")",u=' class="redactor-autoparser-object"';s[d]='<a href="'+o+n.trim()+'"'+c+u+">"+r.trim()+"</a>"}for(var h in s)t=t.replace(new RegExp(h,"g"),s[h]);return t},_restoreReplaced:function(t,e){for(var i=0;i<t.length;i++)e=e.replace("#####replaceparse"+i+"#####",t[i]);return e},_convertToRegExp:function(t){return new RegExp(String(t).replace(/^\//,"").replace(/\/ig$/,"").replace(/\/gi$/,"")+"$","gi")}}),$R.add("service","storage",{init:function(t){this.app=t,this.data=[]},observeImages:function(){var t=this.editor.getElement(),e=t.find("[data-image]");e.each(this._addImage.bind(this))},observeFiles:function(){var t=this.editor.getElement(),e=t.find("[data-file]");e.each(this._addFile.bind(this))},setStatus:function(t,e){this.data[t].status=e},getChanges:function(){var t=this.editor.getElement();for(var e in this.data){var i=this.data[e],s=t.find("[data-"+i.type+'="'+i.id+'"]');this.setStatus(i.id,0!==s.length)}return this.data},add:function(t,e){var i=$R.dom(e),s=i.attr("data-"+t);this.data[s]={type:t,status:!0,node:i.get(),id:i.attr("data-"+t)}},_addImage:function(t){this.add("image",t)},_addFile:function(t){this.add("file",t)}}),$R.add("service","utils",{init:function(t){this.app=t},isEmpty:function(t){var e=!1;return t=$R.dom(t).get(),t&&(e=3===t.nodeType?""===t.textContent.trim().replace(/\n/,""):""===t.innerHTML),e},isEmptyHtml:function(t,e,i){return t=this.removeInvisibleChars(t),t=t.replace(/&nbsp;/gi,""),t=t.replace(/<\/?br\s?\/?>/g,e?"br":""),t=t.replace(/\s/g,""),t=t.replace(/^<p>[^\W\w\D\d]*?<\/p>$/i,""),t=t.replace(/^<div>[^\W\w\D\d]*?<\/div>$/i,""),i&&(t=t.replace(/<ul(.*?[^>])>$/i,"ul"),t=t.replace(/<ol(.*?[^>])>$/i,"ol")),t=t.replace(/<hr(.*?[^>])>$/i,"hr"),t=t.replace(/<iframe(.*?[^>])>$/i,"iframe"),t=t.replace(/<source(.*?[^>])>$/i,"source"),t=t.replace(/<[^\/>][^>]*><\/[^>]+>/gi,""),t=t.replace(/<[^\/>][^>]*><\/[^>]+>/gi,""),t=t.trim(),""===t},trimSpaces:function(t){return this.removeInvisibleChars(t.trim())},createInvisibleChar:function(){return document.createTextNode(this.opts.markerChar)},searchInvisibleChars:function(t){return t.search(/^\uFEFF$/g)},removeInvisibleChars:function(t){return t.replace(/\uFEFF/g,"")},trimInvisibleChars:function(t){if(this.selection.isCollapsed()){var e=this.selection.getCurrent(),i="left"===t?this.selection.getTextBeforeCaret():this.selection.getTextAfterCaret(),s=e&&3===e.nodeType&&0===this.searchInvisibleChars(i);if(s)if("left"===t)$R.dom(e).replaceWith(e.textContent.trim());else{var a=this.offset.get();this.offset.set({start:a.start+1,end:a.end+1})}}},buildWrapper:function(t){return $R.dom("<div>").html(t)},getWrapperHtml:function(t){var e=t.html();return t.remove(),e},createTmpContainer:function(t){var e=$R.dom("<div>");return"string"==typeof t?e.html(t):e.append($R.dom(t).clone(!0)),e.get()},createFragment:function(t){for(var e,i,s,a=this.createTmpContainer(t),n=document.createDocumentFragment(),r=[],o=0;e=a.firstChild;){o++;var l=n.appendChild(e);1===o&&(i=l),r.push(l),s=l}return{frag:n,first:i,last:s,nodes:r}},isFragment:function(t){return"object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(t)&&t.frag},parseHtml:function(t){var e=this.createTmpContainer(t);return{html:e.innerHTML,nodes:e.childNodes}},splitNode:function(t,e,i,s){var a;e=this.isFragment(e)?e.frag:e,a=s?this.inspector.isInlineTag(t.tagName)?t:this.selection.getInline(t):this.inspector.isBlockTag(t.tagName)?t:this.selection.getBlock(t);var n=$R.dom(a);if(!s&&this.isEmptyHtml(a.innerHTML,!0))return n.after(e),n.remove(),e;var r=n.get().tagName.toLowerCase(),o=this.caret.isEnd(a),l=this.caret.isStart(a);if(!o&&!l){var c=this.extractHtmlFromCaret(s),d=$R.dom("<"+r+" />");d=this.cloneAttributes(a,d),n.after(d.append(c))}if(l)return n.before(e);if(i)return n.append(e);e=n.after(e);var u=n.html();return u=this.removeInvisibleChars(u),u=u.replace(/&nbsp;/gi,""),""===u&&n.remove(),e},extractHtmlFromCaret:function(t,e){var i=this.selection.getRange();if(i&&(e=e||(t?this.selection.getInline():this.selection.getBlock()))){var s=i.cloneRange();return s.selectNodeContents(e),s.setStart(i.endContainer,i.endOffset),s.extractContents()}},createMarkup:function(t){var e=document.createElement(this.opts.markup);this.opts.breakline&&e.setAttribute("data-redactor-tag","br");var i=$R.dom(t);i.after(e),this.caret.setStart(e)},getNode:function(t){var e=$R.dom(t).get(),i=this.editor.getElement().get();return"undefined"==typeof t?i:e||!1},findSiblings:function(t,e){for(t=$R.dom(t).get(),e="next"===e?"nextSibling":"previousSibling";t=t[e];)if((3!==t.nodeType||""!==t.textContent.trim())&&"BR"!==t.tagName)return t;return!1},getElementsFromHtml:function(t,e,i){var s=document.createElement("div");s.innerHTML=t;var a=s.querySelectorAll(e),n=function(t,e){if("number"==typeof this.length&&"function"==typeof t){var i=[];if("object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(this))for(var s=0;s<this.length;s++){if(!(s in this))return;i[s]=t.call(e||this,this[s],s,this)}return i}};return n.call(a,function(t){var e=t.getAttribute("data-redactor-type");return i&&e&&e===i?void 0:t.outerHTML})},getChildNodes:function(t,e,i){t=t&&t.nodeType&&11===t.nodeType?t:$R.dom(t).get();var s=t.childNodes,a=[];if(s)for(var n=0;n<s.length;n++)if(!(!0===i&&3===s[n].nodeType||3===s[n].nodeType&&this.isEmpty(s[n])||(a.push(s[n]),!1===e))){var r=this.getChildNodes(s[n],i);r.length>0&&(a=a.concat(r))}return a},getChildElements:function(t){return this.getChildNodes(t,!0,!0)},getFirstNode:function(t){return this._getFirst(this.getChildNodes(t,!1))},getLastNode:function(t){return this._getLast(this.getChildNodes(t,!1))},getFirstElement:function(t){return this._getFirst(this.getChildNodes(t,!1,!0))},getLastElement:function(t){return this._getLast(this.getChildNodes(t,!1,!0))},replaceToTag:function(t,e){var i=$R.dom(t);return i.replaceWith(function(t){var i=$R.dom("<"+e+">").append($R.dom(t).contents());if(t.attributes)for(var s=t.attributes,a=0;a<s.length;a++)i.attr(s[a].nodeName,s[a].value);return i})},ucfirst:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},removeFromArrayByValue:function(t,e){for(var i,s=arguments,a=s.length;a>1&&t.length;)for(e=s[--a];-1!==(i=t.indexOf(e));)t.splice(i,1);return t},removeEmptyAttr:function(t,e){var i=$R.dom(t);return"undefined"==typeof i.attr(e)||null===i.attr(e)||""===i.attr(e)&&(i.removeAttr(e),!0)},cloneAttributes:function(t,e){t=$R.dom(t).get(),e=$R.dom(e);for(var i=t.attributes,s=i.length;s--;){var a=i[s];e.attr(a.name,a.value)}return e},toParams:function(t){if("object"!=Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(t))return t;var e=_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_object_keys__WEBPACK_IMPORTED_MODULE_16___default()(t);if(!e.length)return"";for(var i="",s=0;s<e.length;s++){var a=e[s];i+=a+":"+t[a]+";"}return i},styleToObj:function(t){var e={};if(t)for(var i=t.replace(/;$/,"").split(";"),s=0;s<i.length;s++){var a=i[s].split(":");e[a[0].trim()]=a[1].trim()}return e},checkProperty:function(t){for(var e=arguments[1]&&_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_array_is_array__WEBPACK_IMPORTED_MODULE_6___default()(arguments[1])?arguments[1]:[].slice.call(arguments,1),i=0;i<e.length;i++){if(!t||"undefined"==typeof t[e[i]])return!1;t=t[e[i]]}return t},extendData:function(t,e){for(var i in e)if("elements"===i){var s=$R.dom(e[i]);s.each(function(e){var i=$R.dom(e);if("FORM"===e.tagName){var s=i.serialize(!0);for(var a in s)t=this._setData(t,a,s[a])}else{var n=i.attr("name")?i.attr("name"):i.attr("id");t=this._setData(t,n,i.val())}}.bind(this))}else t=this._setData(t,i,e[i]);return t},_setData:function(t,e,i){return t instanceof FormData?t.append(e,i):t[e]=i,t},normalizeTextNodes:function(t){t=$R.dom(t).get(),t&&t.normalize()},isRgb:function(t){return 0===t.search(/^rgb/i)},rgb2hex:function(t){return t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),t&&4===t.length?"#"+("0"+_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_2___default()(t[1],10).toString(16)).slice(-2)+("0"+_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_2___default()(t[2],10).toString(16)).slice(-2)+("0"+_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_2___default()(t[3],10).toString(16)).slice(-2):""},hex2long:function(t){return-1!==t.search(/^#/)&&4===t.length&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]),t},escapeRegExp:function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},getRandomId:function(){for(var t="",e="abcdefghijklmnopqrstuvwxyz0123456789",i=0;12>i;i++)t+=e.charAt(Math.floor(Math.random()*e.length));return t},_getFirst:function(t){return 0!==t.length&&t[0]},_getLast:function(t){return 0!==t.length&&t[t.length-1]}}),$R.add("service","progress",{init:function(t){this.app=t,this.$box=null,this.$bar=null},show:function(){this._is()||this._build(),this.$box.show()},hide:function(){this._is()&&this.animate.start(this.$box,"fadeOut",this._destroy.bind(this))},update:function(t){this.show(),this.$bar.css("width",t+"%")},_is:function(){return null!==this.$box},_build:function(){this.$bar=$R.dom("<span />"),this.$box=$R.dom('<div id="redactor-progress" />'),this.$box.append(this.$bar),this.$body.append(this.$box)},_destroy:function(){this._is()&&this.$box.remove(),this.$box=null,this.$bar=null}}),$R.add("module","starter",{init:function(t){this.app=t,this.opts=t.opts,this.plugin=t.plugin,this.module=t.module},onstart:function(){var t=["element","container","source","editor","statusbar","toolbar"],e=["element","container","source","editor","statusbar","contextbar","input"];this._startStop("start",this.app,t),this._startStop("start",this.module,e)},onstop:function(){var t=["observer","element","container","source","editor","contextbar"];this._startStop("stop",this.module,t)},onenable:function(){var t=["observer","toolbar"],e=this.opts.plugins;this._startStop("start",this.module,t),this._startStop("start",this.plugin,e)},ondisable:function(){var t=["observer","toolbar"],e=this.opts.plugins;this._startStop("stop",this.module,t),this._startStop("stop",this.plugin,e)},_startStop:function(t,e,i){for(var s=0;s<i.length;s++)"undefined"!=typeof e[i[s]]&&this.app.callInstanceMethod(e[i[s]],t)}}),$R.add("module","element",{init:function(t){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.namespace=t.namespace,this.element=t.element,this.rootOpts=$R.extend({},!0,$R.options,t.rootOpts)},start:function(){this._build(),this._buildModes(),this._buildMarkup()},stop:function(){var t=this.element.getElement();t.removeData(this.namespace+"-uuid")},_build:function(){var t=this.element.getElement();t.data(this.namespace+"-uuid",this.uuid)},_buildModes:function(){var t=this.element.getType();"inline"===t&&this._redefineOptions(this.opts.modes.inline),"div"===t&&this._redefineOptions(this.opts.modes.original),"inline"!==t&&(this._isRootOption("styles")&&this.rootOpts.styles&&(this.opts.styles=!0),this._isRootOption("source")&&!this.rootOpts.source&&(this.opts.showSource=!1))},_buildMarkup:function(){var t=this.element.getType();"inline"===t?this.opts.emptyHtml="":this.opts.breakline?(this.opts.markup="div",this.opts.emptyHtml='<div data-redactor-tag="br">'+this.opts.markerChar+"</div>"):this.opts.emptyHtml="<"+this.opts.markup+"></"+this.opts.markup+">"},_redefineOptions:function(t){for(var e in t)this.opts[e]=t[e]},_isRootOption:function(){return"undefined"!=typeof this.rootOpts.styles}}),$R.add("module","editor",{init:function(t){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.editor=t.editor,this.source=t.source,this.element=t.element,this.component=t.component,this.container=t.container,this.inspector=t.inspector,this.autoparser=t.autoparser,this.placeholder=!1,this.events=!1},onenable:function(){this.enable()},ondisable:function(){this.disable()},onenablefocus:function(){this._enableFocus()},oncontextmenu:function(t){this.component.setOnEvent(t,!0)},onclick:function(t){this.component.setOnEvent(t)},onkeyup:function(t){var e=this.inspector.parse(t.target);e.isComponent()||this.component.clearActive()},onenablereadonly:function(){this._enableReadOnly()},ondisablereadonly:function(){this._disableReadOnly()},onautoparseobserve:function(){this.autoparser.observe()},onplaceholder:{build:function(){this._buildPlaceholder()},toggle:function(){this._togglePlacehodler()}},start:function(){this._build(),this._buildEvents(),this._buildOptions(),this._buildAccesibility()},stop:function(){var t=this.editor.getElement(),e=this.container.getElement(),i=["redactor-in","redactor-in-"+this.uuid,"redactor-structure","redactor-placeholder",this.opts.stylesClass],s=["redactor-focus","redactor-blur","redactor-over","redactor-styles-on","redactor-styles-off","redactor-toolbar-on","redactor-text-labeled-on","redactor-source-view"];t.removeAttr("spellcheck"),t.removeAttr("dir"),t.removeAttr("contenteditable"),t.removeAttr("placeholder"),t.removeAttr("data-gramm_editor"),t.removeClass(i.join(" ")),e.removeClass(s.join(" ")),this._destroyEvents(),0===t.get().classList.length&&t.removeAttr("class")},enable:function(){var t=this.editor.getElement(),e=this.container.getElement();t.addClass("redactor-in redactor-in-"+this.uuid),t.attr({contenteditable:!0}),this.opts.structure&&t.addClass("redactor-structure"),!this.opts.toolbar||this.opts.air||this.opts.toolbarExternal||e.addClass("redactor-toolbar-on"),this._disableBrowsersEditing()},disable:function(){var t=this.editor.getElement(),e=this.container.getElement();t.removeClass("redactor-in redactor-in-"+this.uuid),t.removeClass("redactor-structure"),t.removeAttr("contenteditable"),e.addClass("redactor-toolbar-on")},_build:function(){var t=this.editor.getElement(),e=this.element.getElement(),i=this.container.getElement();i.addClass("redactor-blur"),this.opts.grammarly||t.attr("data-gramm_editor",!1),this.opts.styles?(t.addClass(this.opts.stylesClass),i.addClass("redactor-styles-on")):i.addClass("redactor-styles-off"),this.opts.buttonsTextLabeled&&i.addClass("redactor-text-labeled-on"),this.element.isType("textarea")&&e.before(t)},_buildEvents:function(){this.events=$R.create("editor.events",this.app)},_buildOptions:function(){var t=this.editor.getElement();t.attr("dir",this.opts.direction),this.opts.tabindex&&t.attr("tabindex",this.opts.tabindex),this.opts.minHeight&&t.css("min-height",this.opts.minHeight),this.opts.maxHeight&&t.css("max-height",this.opts.maxHeight),this.opts.maxWidth&&t.css({"max-width":this.opts.maxWidth,margin:"auto"})},_buildAccesibility:function(){var t=this.editor.getElement();t.attr({"aria-labelledby":"redactor-voice-"+this.uuid,role:"presentation"})},_buildPlaceholder:function(){this.placeholder=$R.create("editor.placeholder",this.app)},_enableFocus:function(){this.opts.showSource?this._enableFocusSource():this._enableFocusEditor()},_enableFocusSource:function(){var t=this.source.getElement();this.opts.focus?(t.focus(),t.get().setSelectionRange(0,0)):this.opts.focusEnd&&t.focus()},_enableFocusEditor:function(){this.opts.focus?setTimeout(this.editor.startFocus.bind(this.editor),100):this.opts.focusEnd&&setTimeout(this.editor.endFocus.bind(this.editor),100)},_togglePlacehodler:function(){this.placeholder&&this.placeholder.toggle()},_disableBrowsersEditing:function(){try{document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1),document.execCommand("AutoUrlDetect",!1,!1);var t=this.editor.getElement(),e=t.get();e.addEventListener?e.addEventListener("mscontrolselect",function(t){t.preventDefault()}):e.attachEvent("oncontrolselect",function(t){t.returnValue=!1})}catch(i){}},_destroyEvents:function(){this.events&&this.events.destroy()},_enableReadOnly:function(){var t=this.editor.getElement();this._getEditables(t).removeAttr("contenteditable"),t.removeAttr("contenteditable"),t.addClass("redactor-read-only"),this.events&&this.events.destroy()},_disableReadOnly:function(){var t=this.editor.getElement();this._getEditables(t).attr({contenteditable:!0}),t.removeClass("redactor-read-only"),t.attr({contenteditable:!0}),this._buildEvents()},_getEditables:function(t){return t.find("figcaption, td, th")}}),$R.add("class","editor.placeholder",{init:function(t){this.app=t,this.opts=t.opts,this.editor=t.editor,this.element=t.element,this.build()},build:function(){var t=this.element.getElement(),e=this.editor.getElement();if(!1!==this.opts.placeholder||t.attr("placeholder")){var i=!1!==this.opts.placeholder?this.opts.placeholder:t.attr("placeholder");e.attr("placeholder",i),this.toggle()}},toggle:function(){return this.editor.isEmpty(!0)?this.show():this.hide()},show:function(){var t=this.editor.getElement();t.addClass("redactor-placeholder")},hide:function(){var t=this.editor.getElement();t.removeClass("redactor-placeholder")}}),$R.add("class","editor.events",{init:function(t){this.app=t,this.opts=t.opts,this.$doc=t.$doc,this.uuid=t.uuid,this.source=t.source,this.editor=t.editor,this.cleaner=t.cleaner,this.container=t.container,this.insertion=t.insertion,this.inspector=t.inspector,this.selection=t.selection,this.component=t.component,this.blurNamespace=".redactor-blur."+this.uuid,this.eventsList=["paste","click","contextmenu","keydown","keyup","mouseup","touchstart","cut","copy","dragenter","dragstart","drop","dragover","dragleave"],this._init()},destroy:function(){var t=this.editor.getElement();t.off(".redactor-focus"),this.$doc.off("keyup"+this.blurNamespace+" mousedown"+this.blurNamespace),this._loop("off")},focus:function(t){var e=this.container.getElement();this.editor.isPasting()||e.hasClass("redactor-focus")||(e.addClass("redactor-focus"),e.removeClass("redactor-blur"),this.app.broadcast("observe",t),this.app.broadcast("focus",t),this.isFocused=!0,this.isBlured=!1)},blur:function(t){var e=this.container.getElement(),i=$R.dom(t.target),s=[".redactor-in-"+this.uuid,".redactor-toolbar",".redactor-dropdown",".redactor-context-toolbar","#redactor-modal","#redactor-image-resizer"];this.app.broadcast("originalblur",t),this.app.stopBlur||this.app.isStarted()&&!this.editor.isPasting()&&0===i.closest(s.join(",")).length&&(this.isBlured||e.hasClass("redactor-blur")||(e.removeClass("redactor-focus"),e.addClass("redactor-blur"),this.app.broadcast("blur",t),this.isFocused=!1,this.isBlured=!0))},cut:function(t){var e=this.selection.getCurrent(),i=this.inspector.parse(e);this.app.broadcast("state",t),this.component.isNonEditable(e)&&(this._passSelectionToClipboard(t,i,!0),t.preventDefault())},copy:function(t){var e=this.selection.getCurrent(),i=this.inspector.parse(e);this.app.broadcast("state",t),this.component.isNonEditable(e)&&(this._passSelectionToClipboard(t,i,!1),t.preventDefault())},drop:function(t){if(t=t.originalEvent||t,t.stopPropagation(),this._removeOverClass(),!1!==this.opts.dragUpload){if(this.app.isDragComponentInside()){var e=$R.dom(this.app.getDragComponentInside()),i=e.clone(!0);return this.insertion.insertToPoint(t,i),e.remove(),this.app.setDragComponentInside(!1),this.app.broadcast("state",t),this.app.broadcast("drop",t),this.app.broadcast("image.observe",t),void t.preventDefault()}if(this.app.isDragInside()&&this.opts.input){this.insertion.insertPoint(t);var s=t.dataTransfer,a=s.getData("text/html"),n=this.selection.getRange();if(n){var r=this.selection.getBlocks();n.deleteContents();for(var o=0;o<r.length;o++)""===r[o].innerHTML&&$R.dom(r[o]).remove()}return $R.create("input.paste",this.app,t,!0,a,!0),this.app.broadcast("state",t),this.app.broadcast("drop",t),this.app.setDragInside(!1),void t.preventDefault()}this.app.broadcast("state",t),this.app.broadcast("paste",t,t.dataTransfer),this.app.broadcast("drop",t)}else t.preventDefault()},dragenter:function(t){t.preventDefault()},dragstart:function(t){this.app.setDragComponentInside(!1),this.app.setDragInside(!1);var e=this.inspector.parse(t.target);!e.isComponent()||e.isComponentEditable()||e.isFigcaption()?this.selection.is()&&!this.selection.isCollapsed()&&(this.app.setDragInside(!0),this._setDragData(t)):this.app.setDragComponentInside(e.getComponent()),this.app.broadcast("dragstart",t)},dragover:function(t){this.app.broadcast("dragover",t)},dragleave:function(t){this.app.broadcast("dragleave",t)},paste:function(t){this.app.broadcast("paste",t)},contextmenu:function(t){this.editor.disableNonEditables(),setTimeout(function(){this.editor.enableNonEditables(),this.app.broadcast("contextmenu",t)}.bind(this),0)},click:function(t){if(3===t.detail){t.preventDefault();var e=this.selection.getBlock(),i=document.createRange();i.selectNodeContents(e),this.selection.setRange(i)}var s=$R.dom(t.target);if(s.hasClass("redactor-in")){var a=s.offset().top,n=_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_float__WEBPACK_IMPORTED_MODULE_12___default()(s.css("padding-bottom")),r=s.height(),o=a+r-2*n;o<t.pageY&&this.app.broadcast("bottomclick",t)}this.app.broadcast("state",t),this.app.broadcast("click",t)},keydown:function(t){this.app.broadcast("state",t);var e=this.app.broadcast("keydown",t);return!1===e?t.preventDefault():void 0},keyup:function(t){this.app.broadcast("keyup",t)},mouseup:function(t){this.app.broadcast("observe",t),this.app.broadcast("state",t)},touchstart:function(t){this.app.broadcast("observe",t),this.app.broadcast("state",t)},_init:function(){var t=this.editor.getElement();t.on("focus.redactor-focus click.redactor-focus",this.focus.bind(this)),this.$doc.on("keyup"+this.blurNamespace+" mousedown"+this.blurNamespace,this.blur.bind(this)),this._loop("on")},_removeOverClass:function(){var t=this.editor.getElement();t.removeClass("over")},_loop:function(t){for(var e=this.editor.getElement(),i=0;i<this.eventsList.length;i++){var s=this.eventsList[i]+".redactor-events",a=this.eventsList[i];e[t](s,this[a].bind(this))}},_passAllToClipboard:function(t){var e=t.clipboardData,i=this.source.getCode();e.setData("text/html",i),e.setData("text/plain",i.toString().replace(/\n$/,""))},_passSelectionToClipboard:function(t,e,i){var s=t.clipboardData,a=e.getComponent(),n=$R.dom(a),r=n.clone();r.find(".redactor-component-caret").remove(),r.removeClass("redactor-component-active"),r.removeAttr("contenteditable"),r.removeAttr("tabindex");var o=r.get().outerHTML;i&&this.component.remove(a),s.setData("text/html",o),s.setData("text/plain",o.toString().replace(/\n$/,""))},_setDragData:function(t){t=t.originalEvent||t;var e=t.dataTransfer;e.effectAllowed="move",e.setData("text/Html",this.selection.getHtml())}}),$R.add("module","container",{init:function(t){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.lang=t.lang,this.element=t.element,this.container=t.container},start:function(){this._build(),this._buildAccesibility()},stop:function(){var t=this.element.getElement(),e=this.container.getElement();e.after(t),e.remove(),t.show()},_build:function(){var t=this.element.getElement(),e=this.container.getElement();e.addClass("redactor-box"),e.attr("dir",this.opts.direction),this.element.isType("inline")&&e.addClass("redactor-inline"),t.after(e),e.append(t)},_buildAccesibility:function(){var t=this.container.getElement(),e=$R.dom("<span />");e.addClass("redactor-voice-label"),e.attr({id:"redactor-voice-"+this.uuid,"aria-hidden":!1}),e.html(this.lang.get("accessibility-help-label")),t.prepend(e)}}),$R.add("module","source",{init:function(t){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.utils=t.utils,this.element=t.element,this.source=t.source,this.editor=t.editor,this.toolbar=t.toolbar,this.cleaner=t.cleaner,this.component=t.component,this.container=t.container,this.autoparser=t.autoparser,this.selection=t.selection,this.syncedHtml=""},onstartcode:function(){var t=this.source.getStartedContent(),e=this.editor.getElement(),i=this.source.getElement();this.opts.autoparse&&this.opts.autoparseStart&&(t=this.autoparser.parse(t));var s=this.cleaner.input(t,!0,!0),a=this.cleaner.output(s);e.html(s),i.val(a),this.syncedHtml=a,this.app.broadcast("placeholder.build"),this.app.broadcast("autoparseobserve"),this.component.executeScripts()},onstartcodeshow:function(){this.show()},ontrytosync:function(){this.sync()},onhardsync:function(){var t=this.editor.getElement(),e=t.html();e=this.app.broadcast("syncBefore",e),e=this.cleaner.output(e),this._syncing(e)},start:function(){this._build(),this._buildClasses()},stop:function(){var t=this.element.getElement(),e=this.source.getElement();t.removeClass("redactor-source redactor-source-open"),e.off("input.redactor-source"),e.removeAttr("data-gramm_editor"),0===e.get().classList.length&&e.removeAttr("class"),this.source.isNameGenerated()||t.removeAttr("name"),this.element.isType("textarea")||e.remove()},getCode:function(){return this.source.getCode()},toggle:function(){if(this.opts.source){var t=this.source.getElement();return t.hasClass("redactor-source-open")?this.hide():this.show()}},show:function(){if(this.opts.source){var t=this.editor.getElement(),e=this.source.getElement(),i=this.container.getElement(),s=e.val();this.app.isStarted()&&(s=this.app.broadcast("source.open",s));var a=$R.create("source.selection",this.app),n=a.insertMarkersToEditor();n=this.cleaner.output(n,!1),n=n.trim();var r=t.height();t.hide(),e.height(r),e.val(s.trim()),e.show(),e.addClass("redactor-source-open"),e.on("input.redactor-source-events",this._onChangedSource.bind(this)),e.on("keydown.redactor-source-events",this._onTabKey.bind(this)),e.on("focus.redactor-source-events",this._onFocus.bind(this)),i.addClass("redactor-source-view"),a.setSelectionOffsetSource(n),setTimeout(function(){this._disableButtons(),this._setActiveSourceButton()}.bind(this),100),this.app.isStarted()&&this.app.broadcast("source.opened")}},hide:function(){if(this.opts.source){var t=this.editor.getElement(),e=this.source.getElement(),i=this.container.getElement(),s=e.val(),a=$R.create("source.selection",this.app);s=a.insertMarkersToSource(s),s=this.cleaner.input(s,!0),s=this.utils.isEmptyHtml(s)?this.opts.emptyHtml:s,s=this.app.broadcast("source.close",s),this._enableButtons(),this._setInactiveSourceButton(),e.hide(),e.removeClass("redactor-source-open"),e.off(".redactor-source-events"),t.show(),t.html(s),i.removeClass("redactor-source-view"),setTimeout(function(){a.isOffset()?this.selection.restoreMarkers():a.isOffsetEnd()?this.editor.endFocus():this.editor.startFocus(),this.component.executeScripts()}.bind(this),0),this.app.broadcast("source.closed")}},sync:function(){var t=this,e=this.editor.getElement(),i=e.html();i=this.app.broadcast("syncBefore",i),i=this.cleaner.output(i),this._isSync(i)&&(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){t._syncing(i)},200))},_build:function(){var t=this.source.getElement(),e=this.element.getElement();t.hide(),this.opts.grammarly||t.attr("data-gramm_editor",!1),this.element.isType("textarea")||e.after(t)},_buildClasses:function(){var t=this.source.getElement();t.addClass("redactor-source")},_syncing:function(t){t=this.app.broadcast("syncing",t);var e=this.source.getElement();e.val(t),this.app.broadcast("synced",t),this.app.broadcast("changed",t)},_isSync:function(t){return this.syncedHtml!==t&&(this.syncedHtml=t,!0)},_onChangedSource:function(){var t=this.source.getElement(),e=t.val();this.app.broadcast("changed",e),this.app.broadcast("source.changed",e)},_onTabKey:function(t){if(9!==t.keyCode)return!0;t.preventDefault();var e=this.source.getElement(),i=e.get(),s=i.selectionStart;e.val(e.val().substring(0,s)+"    "+e.val().substring(i.selectionEnd)),i.selectionStart=i.selectionEnd=s+4},_onFocus:function(){this.app.broadcast("sourcefocus")},_disableButtons:function(){this.toolbar.disableButtons()},_enableButtons:function(){this.toolbar.enableButtons()},_setActiveSourceButton:function(){var t=this.toolbar.getButton("html");t.enable(),t.setActive()},_setInactiveSourceButton:function(){var t=this.toolbar.getButton("html");t.setInactive()}}),$R.add("class","source.selection",{init:function(t){this.app=t,this.utils=t.utils,this.source=t.source,this.editor=t.editor,this.marker=t.marker,this.component=t.component,this.selection=t.selection,this.markersOffset=!1,this.markersOffsetEnd=!1},insertMarkersToEditor:function(){var t=this.editor.getElement(),e=this.marker.build("start"),i=this.marker.build("end"),s=this.component.getActive();if(s){this.marker.remove();var a=$R.dom(s);a.after(i),a.after(e)}else window.getSelection&&this.selection.is()&&this.marker.insert("both");return this._getHtmlAndRemoveMarkers(t)},setSelectionOffsetSource:function(t){var e=0,i=0,s=this.source.getElement();if(""!==t){var a=this.utils.removeInvisibleChars(this.marker.buildHtml("start")),n=this.utils.removeInvisibleChars(this.marker.buildHtml("end"));e=this._strpos(t,a),i=this._strpos(t,n)-n.toString().length-2,!1===e&&(e=0,i=0)}s.get().setSelectionRange(e,i),s.get().scrollTop=0,setTimeout(function(){s.focus()}.bind(this),0)},isOffset:function(){return this.markersOffset},isOffsetEnd:function(){return this.markersOffsetEnd},insertMarkersToSource:function(t){var e=this.source.getElement(),i=this.marker.buildHtml("start"),s=this.marker.buildHtml("end"),a=i.toString().length,n=this._enlargeOffset(t,e.get().selectionStart),r=this._enlargeOffset(t,e.get().selectionEnd),o=t.length;return n===o?this.markersOffsetEnd=!0:0!==n&&0!==r?(this.markersOffset=!0,t=t.substr(0,n)+i+t.substr(n),t=t.substr(0,r+a)+s+t.substr(r+a)):this.markersOffset=!1,t},_getHtmlAndRemoveMarkers:function(t){var e=t.html();return t.find(".redactor-selection-marker").remove(),e},_strpos:function(t,e,i){var s=t.indexOf(e,i);return s>=0&&s},_enlargeOffset:function(t,e){var i=t.length,s=0;if(">"===t[e])s++;else for(var a=e;i>=a&&(s++,">"!==t[a]);a++)if("<"===t[a]||a===i){s=0;break}return e+s}}),$R.add("module","observer",{init:function(t){this.app=t,this.editor=t.editor,this.observerUnit=!1},start:function(){if(window.MutationObserver){var t=this.editor.getElement(),e=t.get();this.observerUnit=this._build(e),this.observerUnit.observe(e,{attributes:!0,subtree:!0,childList:!0,characterData:!0,characterDataOldValue:!0})}},stop:function(){this.observerUnit&&this.observerUnit.disconnect()},_build:function(t){var e=this;return new MutationObserver(function(i){e._observe(i[i.length-1],t)})},_observe:function(t,e){this.app.isReadOnly()||"attributes"===t.type&&t.target===e||(this.app.broadcast("observe"),this.app.broadcast("trytosync"),this.app.broadcast("placeholder.toggle"))}}),$R.add("module","clicktoedit",{init:function(t){this.app=t,this.opts=t.opts,this.source=t.source,this.editor=t.editor,this.container=t.container,this.selection=t.selection},onstartclicktoedit:function(){this.start()},onenablereadonly:function(){this._isEnabled()||this.stop()},ondisablereadonly:function(){this._isEnabled()||this.start()},onstop:function(){this.stop()},start:function(){this._build()},stop:function(){this.buttonSave&&this.buttonSave.stop(),this.buttonCancel&&this.buttonCancel.stop(),this._destroy(),this.app.broadcast("disable")},enable:function(){this.app.broadcast("clickStart");var t=this.editor.isEmpty();t||this.selection.saveMarkers(),this._setFocus(),this._destroy(),this.app.broadcast("enable"),this.buttonSave.enable(),this.buttonCancel.enable(),t||this.selection.restoreMarkers(),t&&this.editor.focus();var e=this.container.getElement();e.addClass("redactor-clicktoedit-enabled"),this.source.rebuildStartedContent(),this.app.broadcast("startcode"),this.app.broadcast("image.observe")},save:function(t){t&&t.preventDefault();var e=this.source.getCode();this.app.broadcast("disable"),this.app.broadcast("clickSave",e),this.app.broadcast("clickStop"),this._build()},cancel:function(t){t&&t.preventDefault();var e=this.saved,i=this.editor.getElement();i.html(e),this.saved="",this.app.broadcast("disable"),this.app.broadcast("clickCancel",e),this.app.broadcast("clickStop"),this._build()},_build:function(){this.buttonSave=$R.create("clicktoedit.button","save",this.app,this),this.buttonCancel=$R.create("clicktoedit.button","cancel",this.app,this),this.buttonSave.stop(),this.buttonCancel.stop();var t=this.editor.getElement(),e=this.container.getElement();t.on("click.redactor-click-to-edit mouseup.redactor-click-to-edit",this.enable.bind(this)),e.addClass("redactor-over"),e.removeClass("redactor-clicktoedit-enabled")},_isEnabled:function(){return this.container.getElement().hasClass("redactor-clicktoedit-enabled")},_destroy:function(){var t=this.editor.getElement(),e=this.container.getElement();t.off(".redactor-click-to-edit"),e.removeClass("redactor-over redactor-clicktoedit-enabled")},_setFocus:function(){this.saved=this.source.getCode(),this.buttonSave.start(),this.buttonCancel.start()}}),$R.add("class","clicktoedit.button",{init:function(t,e,i){this.app=e,this.opts=e.opts,this.toolbar=e.toolbar,this.context=i,this.type=t,this.name="save"===t?"clickToSave":"clickToCancel",this.objected=!1,this.enabled=!1,this.namespace=".redactor-click-to-edit",this._build()},enable:function(){if(this.objected){var t=this.opts[this.name];t.api="module.clicktoedit."+this.type,this.toolbar.addButton(this.type,t),this.enabled=!0}},start:function(){this.objected||(this.$button.off(this.namespace),this.$button.show(),this.$button.on("click"+this.namespace,this.context[this.type].bind(this.context)))},stop:function(){!this.objected&&this.enabled&&this.$button.hide()},_build:function(){this.objected="object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(this.opts[this.name]),this.objected||(this.$button=$R.dom(this.opts[this.name]),this.enabled=!0)}}),$R.add("module","statusbar",{init:function(t){this.app=t,this.opts=t.opts,this.element=t.element,this.statusbar=t.statusbar,this.container=t.container},start:function(){if(!this.element.isType("inline")){var t=this.statusbar.getElement(),e=this.container.getElement();t.addClass("redactor-statusbar"),e.append(t)}}}),$R.add("module","contextbar",{init:function(t){this.app=t,this.opts=t.opts,this.uuid=t.uuid,this.$win=t.$win,this.$doc=t.$doc,this.$body=t.$body,this.editor=t.editor,this.toolbar=t.toolbar,this.detector=t.detector,this.$target=this.toolbar.isTarget()?this.toolbar.getTargetElement():this.$body},onenablereadonly:function(){this.stop()},ondisablereadonly:function(){this.start()},oncontextbar:{close:function(){this.close()}},start:function(){if(this.opts.toolbarContext){var t=this.editor.getElement();this._build(),t.on("click.redactor-context mouseup.redactor-context",this.open.bind(this)),this.opts.scrollTarget&&$R.dom(this.opts.scrollTarget).on("scroll.redactor-context",this.close.bind(this))}},stop:function(){var t=this.editor.getElement();t.off(".redactor-context"),this.$doc.off(".redactor-context"),this.$win.off(".redactor-context"),this.$contextbar&&this.$contextbar.remove(),this.opts.scrollTarget&&$R.dom(this.opts.scrollTarget).off(".redactor-context")},is:function(){return this.$contextbar&&this.$contextbar.hasClass("open")},set:function(t,e,i,s){for(var a in this.$contextbar.html(""),this.$el=$R.dom(e),i){var n=$R.create("contextbar.button",this.app,i[a]);""!==n.html()&&this.$contextbar.append(n)}var r=this._buildPosition(t,this.$el,s);this.$contextbar.css(r),this.$contextbar.show(),this.$contextbar.addClass("open"),this.$doc.on("click.redactor-context mouseup.redactor-context",this.close.bind(this)),this.$win.on("resize.redactor-context",this.close.bind(this))},open:function(t){setTimeout(function(){this.app.broadcast("contextbar",t,this)}.bind(this),0)},close:function(t){if(this.$contextbar){if(t){var e=$R.dom(t.target);if(this.$el&&0!==e.closest(this.$el).length)return}this.$contextbar.hide(),this.$contextbar.removeClass("open"),this.$doc.off(".redactor.context")}},_build:function(){this.$contextbar=$R.dom("<div>"),this.$contextbar.attr("id","redactor-context-toolbar-"+this.uuid),this.$contextbar.attr("dir",this.opts.direction),this.$contextbar.addClass("redactor-context-toolbar"),this.$contextbar.hide(),this.$target.append(this.$contextbar)},_buildPosition:function(t,e,i){var s,a,n=this.toolbar.isTarget(),r=n?e.position():e.offset(),o=e.width(),l=e.height(),c=this.$contextbar.width(),d=this.$contextbar.height(),u=n?this.$target.scrollTop()+this.$doc.scrollTop():this.$doc.scrollTop(),h=this.$target.offset(),m=n?h.left:0,p=n?h.top:0;return i?"top"===i?(s=r.top-d,a=r.left+o/2-c/2):"bottom"===i&&(s=r.top+l,a=r.left+o/2-c/2):(s=t.clientY+u-d,a=t.clientX-c/2),0>a&&(a=0),{top:s-p+"px",left:a-m+"px"}}}),$R.add("class","contextbar.button",{mixins:["dom"],init:function(t,e){this.app=t,this.obj=e,this._init()},_init:function(){this.parse("<a>"),this.attr("href","#"),this._buildTitle(),this._buildMessage()},_buildTitle:function(){this.html(this.obj.title)},_buildMessage:function(){"undefined"==typeof this.obj.message&&"undefined"==typeof this.obj.api||this.on("click",this._toggle.bind(this))},_toggle:function(t){t.preventDefault(),this.obj.message?this.app.broadcast(this.obj.message,this.obj.args):this.obj.api&&this.app.api(this.obj.api,this.obj.args)}}),$R.add("module","toolbar",{init:function(t){this.app=t,this.opts=t.opts,this.utils=t.utils,this.toolbar=t.toolbar,this.buttons=[],this.toolbarModule=!1},onsource:{open:function(){!this.toolbar.isAir()&&this.toolbar.isFixed()&&this.toolbarModule.resetPosition()},opened:function(){this.toolbar.isAir()&&this.toolbarModule&&this.toolbarModule.createSourceHelper()},close:function(){this.toolbar.isAir()&&this.toolbarModule&&this.toolbarModule.destroySourceHelper()},closed:function(){this.toolbar.is()&&this.opts.air&&this.toolbarModule.openSelected()}},onobserve:function(){this.toolbar.is()&&this.toolbar.observe()},onfocus:function(){this._setExternalOnFocus()},onsourcefocus:function(){this._setExternalOnFocus()},onempty:function(){this.toolbar.isFixed()&&this.toolbarModule.resetPosition()},onenablereadonly:function(){this.toolbar.isAir()&&this.toolbarModule.close()},start:function(){this.toolbar.is()&&(this._buildButtons(),this._initToolbar(),this._initButtons())},stop:function(){this.toolbarModule&&this.toolbarModule.stop()},_buildButtons:function(){this.buttons=this.opts.buttons.concat(),this._buildImageButton(),this._buildFileButton(),this._buildSourceButton(),this._buildAdditionalButtons(),this._buildHiddenButtons()},_buildImageButton:function(){this.opts.imageUpload||this.utils.removeFromArrayByValue(this.buttons,"image")},_buildFileButton:function(){this.opts.fileUpload||this.utils.removeFromArrayByValue(this.buttons,"file")},_buildSourceButton:function(){this.opts.source||this.utils.removeFromArrayByValue(this.buttons,"html")},_buildAdditionalButtons:function(){var t,e;if(0!==this.opts.buttonsAdd.length&&(this.opts.buttonsAdd=this._removeExistButtons(this.opts.buttonsAdd),this.buttons=this.buttons.concat(this.opts.buttonsAdd)),0!==this.opts.buttonsAddFirst.length&&(this.opts.buttonsAddFirst=this._removeExistButtons(this.opts.buttonsAddFirst),this.buttons.unshift(this.opts.buttonsAddFirst)),!1!==this.opts.buttonsAddAfter){t=this.buttons.indexOf(this.opts.buttonsAddAfter.after)+1,e=this.opts.buttonsAddAfter.buttons;for(var i=0;i<e.length;i++)this.buttons.splice(t+i,0,e[i])}if(!1!==this.opts.buttonsAddBefore){t=this.buttons.indexOf(this.opts.buttonsAddBefore.before)+1,e=this.opts.buttonsAddBefore.buttons;for(i=0;i<e.length;i++)this.buttons.splice(t-(1-i),0,e[i])}},_buildHiddenButtons:function(){if(0!==this.opts.buttonsHide.length)for(var t=this.opts.buttonsHide,e=0;e<t.length;e++)this.utils.removeFromArrayByValue(this.buttons,t[e])},_removeExistButtons:function(t){for(var e=0;e<t.length;e++)-1!==this.opts.buttons.indexOf(t[e])&&this.utils.removeFromArrayByValue(t,t[e]);return t},_setExternalOnFocus:function(){!this.opts.air&&this.opts.toolbarExternal&&this.toolbarModule.setExternal()},_initToolbar:function(){this.toolbarModule=this.opts.air?$R.create("toolbar.air",this.app):$R.create("toolbar.standard",this.app)},_initButtons:function(){this.toolbar.setButtons(this.buttons);for(var t=0;t<this.buttons.length;t++){var e=this.buttons[t];$R.buttons[e]&&this.toolbar.addButton(e,$R.buttons[e],!1,!1,!0)}}}),$R.add("class","toolbar.air",{init:function(t){this.app=t,this.uuid=t.uuid,this.$doc=t.$doc,this.$win=t.$win,this.utils=t.utils,this.editor=t.editor,this.animate=t.animate,this.toolbar=t.toolbar,this.container=t.container,this.inspector=t.inspector,this.selection=t.selection,this.clicks=0,this._init()},stop:function(){var t=this.toolbar.getWrapper();t.remove();var e=this.editor.getElement();e.off(".redactor-air-trigger-"+this.uuid),this.$doc.off(".redactor-air-"+this.uuid),this.$doc.off(".redactor-air-trigger-"+this.uuid),this.toolbar.stopObservers()},createSourceHelper:function(){this.$airHelper=$R.dom("<span>"),this.$airHelper.addClass("redactor-air-helper"),this.$airHelper.html('<i class="re-icon-html"></i>'),this.$airHelper.on("click",function(t){t.preventDefault(),this.app.api("module.source.hide")}.bind(this));var t=this.container.getElement();t.append(this.$airHelper)},destroySourceHelper:function(){this.$airHelper&&this.$airHelper.remove()},openSelected:function(){setTimeout(function(){this._isSelection()&&this._open(!1)}.bind(this),0)},close:function(){this.$doc.off(".redactor-air-"+this.uuid);var t=this.toolbar.getElement();t.removeClass("open"),t.hide()},_init:function(){this.toolbar.create();var t=this.toolbar.getWrapper(),e=this.toolbar.getElement(),i=this.editor.getElement(),s=this.container.getElement();t.addClass("redactor-toolbar-wrapper-air"),e.addClass("redactor-air"),e.hide(),t.append(e),s.prepend(t),this.openSelected(),this.$doc.on("mouseup.redactor-air-trigger-"+this.uuid,this._open.bind(this)),i.on("keyup.redactor-air-trigger-"+this.uuid,this._openCmd.bind(this))},_isSelection:function(){return this.selection.is()&&!this.selection.isCollapsed()},_isOpened:function(){var t=this.toolbar.getElement();return t.hasClass("open")},_open:function(t){var e=!!t&&t.target,i=!!t&&$R.dom(t.target),s=this.inspector.parse(e),a=s.isComponent()&&!s.isComponentType("table"),n=s.isFigcaption(),r=i&&0!==i.closest(".redactor-modal").length,o=t&&0!==i.closest(".re-button").length,l=t&&0!==i.closest(".redactor-dropdown").length;if(!(l||o||r||n||a||this.toolbar.isContextBar())&&this._isSelection()){var c=this.selection.getPosition();setTimeout(function(){this.app.isReadOnly()||this._isSelection()&&this._doOpen(c)}.bind(this),1)}},_openCmd:function(){if(this.selection.isAll()){var t=this.toolbar.getElement(),e=this.selection.getPosition();e.top=e.top<20?0:e.top-t.height(),e.height=0,this._doOpen(e)}},_doOpen:function(t){var e=this.toolbar.getWrapper(),i=this.toolbar.getElement(),s=this.container.getElement(),a=s.offset(),n=0,r=this.$win.width(),o=i.width();if(r<t.left+o){var l=this.selection.getPosition();n=o-l.width}e.css({left:t.left-a.left-n+"px",top:t.top-a.top+t.height+this.$doc.scrollTop()+"px"}),this.app.broadcast("airOpen"),i.addClass("open"),i.show(),this.$doc.on("click.redactor-air-"+this.uuid,this._close.bind(this)),this.$doc.on("keydown.redactor-air-"+this.uuid,this._close.bind(this)),this.app.broadcast("airOpened")},_close:function(t){var e=!!t&&$R.dom(t.target),i=t&&0!==e.closest("[data-dropdown], .redactor-dropdown-not-close").length,s=!i&&t&&0!==e.closest(".re-button").length;(s||!i&&this._isOpened())&&(this.app.broadcast("airClose"),this.close(),this.app.broadcast("airClosed"))}}),$R.add("class","toolbar.fixed",{init:function(t){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.$doc=t.$doc,this.$win=t.$win,this.editor=t.editor,this.toolbar=t.toolbar,this.detector=t.detector,this.container=t.container,this._init()},stop:function(){this.$fixedTarget.off(".redactor-toolbar-"+this.uuid),this.$win.off(".redactor-toolbar-"+this.uuid)},reset:function(){var t=this.toolbar.getElement(),e=this.toolbar.getWrapper();e.css("height",""),t.removeClass("redactor-toolbar-fixed"),t.css({position:"",top:"",left:"",width:""});var i=this.toolbar.getDropdown();i&&i.updatePosition()},_init:function(){this.$fixedTarget=this.toolbar.isTarget()?this.toolbar.getTargetElement():this.$win,this._doFixed(),this.toolbar.isTarget()&&(this.$win.on("scroll.redactor-toolbar-"+this.uuid,this._doFixed.bind(this)),this.$win.on("resize.redactor-toolbar-"+this.uuid,this._doFixed.bind(this))),this.$fixedTarget.on("scroll.redactor-toolbar-"+this.uuid,this._doFixed.bind(this)),this.$fixedTarget.on("resize.redactor-toolbar-"+this.uuid,this._doFixed.bind(this))},_doFixed:function(){var t=this.editor.getElement(),e=this.container.getElement(),i=this.toolbar.getElement(),s=this.toolbar.getWrapper(),a=e.parents().filter(function(t){return"none"===getComputedStyle(t,null).display&&t});if(0===a.length){var n=t.height()<100,r=this.editor.isEmpty();if(!(n||r||this.editor.isSourceMode())){var o=i.height(),l=60,c=e.offset(),d=c.top,u=d+e.height()-l,h=this.$fixedTarget.scrollTop()+this.opts.toolbarFixedTopOffset,m=this.toolbar.isTarget()?this.$fixedTarget.offset().top-this.$win.scrollTop():0;if(h>d&&u>h){var p=this.detector.isDesktop()?"fixed":"absolute";m=this.detector.isDesktop()?m:h-d+this.opts.toolbarFixedTopOffset,this.detector.isMobile()&&(this.fixedScrollTimeout&&clearTimeout(this.fixedScrollTimeout),i.hide(),this.fixedScrollTimeout=setTimeout(function(){i.show()},250)),s.height(o),i.addClass("redactor-toolbar-fixed"),i.css({position:p,top:m+this.opts.toolbarFixedTopOffset+"px",width:e.width()+"px"});var f=this.toolbar.getDropdown();f&&f.updatePosition(),this.app.broadcast("toolbar.fixed")}else this.reset(),this.app.broadcast("toolbar.unfixed")}}}}),$R.add("class","toolbar.standard",{init:function(t){this.app=t,this.opts=t.opts,this.uuid=t.uuid,this.$body=t.$body,this.toolbar=t.toolbar,this.container=t.container,this.isExternalMultiple=!1,this.toolbarFixed=!1,this._init()},stop:function(){var t=this.toolbar.getWrapper();t.remove(),this.toolbarFixed&&this.toolbarFixed.stop(),this.opts.toolbarExternal&&this._findToolbars(),this.toolbar.stopObservers(),this.$body.find(".re-button-tooltip-"+this.uuid).remove()},setExternal:function(){if(this._findToolbars(),this.isExternalMultiple){this.$toolbars.hide();var t=this.$external.find(".redactor-toolbar-external-"+this.uuid);t.show()}},resetPosition:function(){this.toolbarFixed&&this.toolbarFixed.reset()},_init:function(){if(this._build(),this.opts.toolbarExternal)this._buildExternal();else{this._buildFixed();var t=this.toolbar.getElement();t.show()}},_build:function(){this.toolbar.create();var t=this.toolbar.getWrapper(),e=this.toolbar.getElement();if(t.addClass("redactor-toolbar-wrapper"),e.addClass("redactor-toolbar"),e.hide(),t.append(e),!this.opts.toolbarExternal){var i=this.container.getElement();i.prepend(t)}},_buildExternal:function(){if(this._initExternal(),this._findToolbars(),this.isExternalMultiple)this._hideToolbarsExceptFirst();else{var t=this.toolbar.getElement();t.show()}},_buildFixed:function(){this.opts.toolbarFixed&&(this.toolbarFixed=$R.create("toolbar.fixed",this.app))},_initExternal:function(){var t=this.toolbar.getElement(),e=this.toolbar.getElement();t.addClass("redactor-toolbar-external redactor-toolbar-external-"+this.uuid),this.$external=$R.dom(this.opts.toolbarExternal),this.$external.append(e)},_findToolbars:function(){this.$toolbars=this.$external.find(".redactor-toolbar-external"),this.isExternalMultiple=this.$toolbars.length>1},_hideToolbarsExceptFirst:function(){this.$toolbars.hide();var t=this.$toolbars.first();t.show()}}),$R.add("module","line",{init:function(t){this.app=t,this.lang=t.lang,this.component=t.component,this.inspector=t.inspector,this.insertion=t.insertion},oncontextbar:function(t,e){var i=this.inspector.parse(t.target);if(i.isComponentType("line")){var s=i.getComponent(),a={remove:{title:this.lang.get("delete"),api:"module.line.remove",args:s}};e.set(t,s,a,"bottom")}},insert:function(){var t=this.component.create("line");this.insertion.insertRaw(t)},remove:function(t){this.component.remove(t)}}),$R.add("class","line.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,e&&void 0!==e.cmnt?e:this._init(e)},_init:function(t){var e,i;if("undefined"!=typeof t){var s=$R.dom(t),a=s.get();"HR"===a.tagName?i=a:"FIGURE"===a.tagName&&(e=a,i=s.find("hr").get())}this._buildWrapper(e),this._buildElement(i),this._initWrapper()},_buildElement:function(t){t?this.$element=$R.dom(t):(this.$element=$R.dom("<hr>"),this.append(this.$element))},_buildWrapper:function(t){t=t||"<figure>",this.parse(t)},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"line",tabindex:"-1",contenteditable:!1})}}),$R.add("module","link",{modals:{link:'<form action="">                 <div class="form-item">                     <label for="modal-link-url">URL <span class="req">*</span></label>                     <input type="text" id="modal-link-url" name="url">                 </div>                 <div class="form-item">                     <label for="modal-link-text">## text ##</label>                     <input type="text" id="modal-link-text" name="text">                 </div>                 <div class="form-item form-item-title">                     <label for="modal-link-title">## title ##</label>                     <input type="text" id="modal-link-title" name="title">                 </div>                 <div class="form-item form-item-target">                     <label class="checkbox">                         <input type="checkbox" name="target"> ## link-in-new-tab ##                     </label>                 </div>             </form>'},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.caret=t.caret,this.utils=t.utils,this.inline=t.inline,this.editor=t.editor,this.inspector=t.inspector,this.insertion=t.insertion,this.selection=t.selection,this.isCurrentLink=!1,this.currentText=!1},onmodal:{link:{open:function(t,e){this._setFormData(e,t)},opened:function(t,e){this._setFormFocus(e)},update:function(t,e){var i=e.getData();this._validateData(e,i)&&this._update(i)},insert:function(t,e){var i=e.getData();this._validateData(e,i)&&this._insert(i)},unlink:function(){this._unlink()}}},onbutton:{link:{observe:function(t){this._observeButton(t)}}},ondropdown:{link:{observe:function(t){this._observeUnlink(t),this._observeEdit(t)}}},oncontextbar:function(t,e){var i=this._getCurrent(),s=this.inspector.parse(i);if(s.isLink()){var a=s.getLink(),n=$R.dom(a),r=$R.dom("<a>"),o=n.attr("href");r.text(this._truncateText(o)),r.attr("href",o),r.attr("target","_blank");var l={link:{title:r},edit:{title:this.lang.get("edit"),api:"module.link.open"},unlink:{title:this.lang.get("unlink"),api:"module.link.unlink"}};e.set(t,a,l,"bottom")}},open:function(){this.$link=this._buildCurrent(),this.app.api("module.modal.build",this._getModalData())},insert:function(t){this._insert(t)},update:function(t){this._update(t)},unlink:function(){this._unlink()},_observeButton:function(t){var e=this.selection.getCurrent(),i=this.inspector.parse(e);i.isPre()||i.isCode()?t.disable():t.enable()},_observeUnlink:function(t){var e=t.getItem("unlink"),i=this._getLinks();0===i.length?e.disable():e.enable()},_observeEdit:function(t){var e=this._getCurrent(),i=t.getItem("link"),s=this.inspector.parse(e),a=s.isLink()?this.lang.get("link-edit"):this.lang.get("link-insert");i.setTitle(a)},_unlink:function(){this.app.api("module.modal.close");var t=[],e=this._getLinks();this.selection.save();for(var i=0;i<e.length;i++){var s=$R.create("link.component",this.app,e[i]);t.push(this.selection.getElement(e[i])),s.unwrap(),this.app.broadcast("link.deleted",s)}this.selection.restore();for(i=0;i<t.length;i++){var a=t[i]?t[i]:this.editor.getElement();this.utils.normalizeTextNodes(a)}this._resetCurrent()},_update:function(t){this.app.api("module.modal.close");var e=this._getLinks();this._setLinkData(e,t,"updated"),this._resetCurrent()},_insert:function(t){this.app.api("module.modal.close");var e=this._getLinks();this._insertSingle(e,t)||(this._removeInSelection(e),this._insertMultiple(t)),this._resetCurrent()},_removeInSelection:function(t){this.selection.save();for(var e=0;e<t.length;e++){var i=$R.create("link.component",this.app,t[e]),s=i.clone();i.unwrap(),this.app.broadcast("link.deleted",s)}this.selection.restore()},_insertMultiple:function(t){var e=this.selection.getRange();e&&this._isCurrentTextChanged(t)&&this._deleteContents(e);var i=this.inline.format({tag:"a"});this._setLinkData(i,t,"inserted")},_insertSingle:function(t,e){var i=this.selection.getInline();if(1===t.length&&t[0].textContext===this.selection.getText()||i&&"A"===i.tagName){var s=$R.create("link.component",this.app,t[0]);return s.setData(e),this.caret.setAfter(s),this.app.broadcast("link.inserted",s),!0}return!1},_setLinkData:function(t,e,i){e.text=""===e.text.trim()?this._truncateText(e.url):e.text;var s=!this.currentText||this.currentText!==e.text;this.selection.save();for(var a=0;a<t.length;a++){var n=$R.create("link.component",this.app,t[a]),r={};e.text&&s&&(r.text=e.text),e.url&&(r.url=e.url),void 0!==e.title&&(r.title=e.title),void 0!==e.target&&(r.target=e.target),n.setData(r),this.app.broadcast("link."+i,n)}setTimeout(this.selection.restore.bind(this.selection),0)},_deleteContents:function(t){var e=this.selection.getHtml(),i=this.utils.parseHtml(e),s=i.nodes[0];if(s&&3!==s.nodeType){var a=s.tagName.toLowerCase(),n=document.createElement(a);this.insertion.insertNode(n,"start")}else t.deleteContents()},_getModalData:function(){var t;t=this._isLink()?{update:{title:this.lang.get("save")},unlink:{title:this.lang.get("unlink"),type:"danger"},cancel:{title:this.lang.get("cancel")}}:{insert:{title:this.lang.get("insert")},cancel:{title:this.lang.get("cancel")}};var e={name:"link",title:this._isLink()?this.lang.get("link-edit"):this.lang.get("link-insert"),handle:this._isLink()?"update":"insert",commands:t};return e},_isLink:function(){return this.currentLink},_isCurrentTextChanged:function(t){return this.currentText&&this.currentText!==t.text},_buildCurrent:function(){var t,e=this._getCurrent(),i=this.inspector.parse(e);if(i.isLink())this.currentLink=!0,t=i.getLink(),t=$R.create("link.component",this.app,t);else{this.currentLink=!1,t=$R.create("link.component",this.app);var s={text:this.selection.getText()};t.setData(s)}return t},_getCurrent:function(){return this.selection.getInlinesAllSelected({tags:["a"]})[0]},_getLinks:function(){for(var t=this.selection.getInlines({all:!0,tags:["a"]}),e=[],i=0;i<t.length;i++){var s=this.inspector.parse(t[i]);s.isLink()&&e.push(t[i])}return e},_resetCurrent:function(){this.isCurrentLink=!1,this.currentText=!1},_truncateText:function(t){return t&&t.length>this.opts.linkSize?t.substring(0,this.opts.linkSize)+"...":t},_validateData:function(t,e){return""!==e.url.trim()||t.setError("url")},_setFormFocus:function(t){t.getField("url").focus()},_setFormData:function(t,e){var i=this.$link.getData(),s={url:i.url,text:i.text,title:i.title,target:this.opts.linkTarget||i.target};this.opts.linkNewTab||e.find(".form-item-target").hide(),this.opts.linkTitle||e.find(".form-item-title").hide(),t.setData(s),this.currentText=t.getField("text").val()}}),$R.add("class","link.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,this.opts=t.opts,this.reUrl=/^(?:(?:(?:https?|ftp):)?\/\/)?(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[\/?#]\S*)?$/i,e&&void 0!==e.cmnt?e:this._init(e)},setData:function(t){for(var e in t)this._set(e,t[e])},getData:function(){for(var t=["url","text","target","title"],e={},i=0;i<t.length;i++)e[t[i]]=this._get(t[i]);return e},_init:function(t){var e=$R.dom(t);void 0===t?this.parse("<a>"):this.parse(e)},_set:function(t,e){this["_set_"+t](e)},_get:function(t){return this["_get_"+t]()},_get_target:function(){return!!this.attr("target")&&this.attr("target")},_get_url:function(){return this.attr("href")},_get_title:function(){return this.attr("title")},_get_text:function(){return this._getContext().text()},_getContext:function(){return this._findDeepestChild(this).element},_set_target:function(t){!1===t?this.removeAttr("target"):t&&this.attr("target",!0===t?"_blank":t)},_set_text:function(t){this._getContext().html(t)},_set_title:function(t){t&&""!==t?this.attr("title",t):this.removeAttr("title")},_set_url:function(t){this.opts.linkValidation&&(t=this._cleanUrl(t),this._isMailto(t)?t="mailto:"+t.replace("mailto:",""):this._isUrl(t)&&-1===t.search(/^(ftp|https?)/i)&&(t="http://"+t.replace(/(ftp|https?):\/\//i,""))),this.attr("href",t)},_isMailto:function(t){return-1!==t.search("@")&&!1===/(ftp|https?):\/\//i.test(t)},_isUrl:function(t){return this.reUrl.test(t)},_cleanUrl:function(t){return t.trim().replace(/[^\W\w\D\d+&\'@#\/%?=~_|!:,.;\(\)]/gi,"")},_findDeepestChild:function(t){var e={depth:0,element:t};return t.children().each(function(i){var s=$R.dom(i);if(i.outerHTML===t.html()){var a=this._findDeepestChild(s);a.depth+1>e.depth&&(e={depth:1+a.depth,element:a.element})}}.bind(this)),e}}),$R.add("module","modal",{init:function(t){this.app=t,this.lang=t.lang,this.$doc=t.$doc,this.$win=t.$win,this.$body=t.$body,this.utils=t.utils,this.editor=t.editor,this.animate=t.animate,this.detector=t.detector,this.selection=t.selection,this.$box=!1,this.$modal=!1,this.selectionMarkers=!1,this.defaults={name:!1,url:!1,title:!1,width:"600px",height:!1,handle:!1,commands:!1}},build:function(t){this._open(t)},close:function(){this._close()},stop:function(){this.$box&&(this.$box.remove(),this.$box=!1,this.$modal=!1,this.$doc.off(".redactor.modal"),this.$win.off(".redactor.modal")),this.$overlay&&this.$overlay.remove()},resize:function(){this.$modal.setWidth(this.p.width),this.$modal.updatePosition()},_isOpened:function(){return this.$modal&&this.$modal.hasClass("open")},_open:function(t){this._buildDefaults(t),this.p.url?this._openUrl():this._openTemplate()},_openUrl:function(){$R.ajax.post({url:this.p.url,success:this._doOpen.bind(this)})},_openTemplate:function(){if("undefined"!=typeof $R.modals[this.p.name]){var t=this.lang.parse($R.modals[this.p.name]);this._doOpen(t)}},_doOpen:function(t){this.stop(),this.selection.isCollapsed()?(this.selection.save(),this.selectionMarkers=!1):(this.selection.saveMarkers(),this.selectionMarkers=!0),this.detector.isDesktop()||document.activeElement.blur(),this._createModal(t),this._buildModalBox(),this._buildOverlay(),this._buildModal(),this._buildModalForm(),this._buildModalCommands(),this._broadcast("open"),this.$modal.updatePosition(),this._buildModalTabs(),this.animate.start(this.$box,"fadeIn",this._opened.bind(this)),this.animate.start(this.$overlay,"fadeIn")},_opened:function(){this.$modal.addClass("open"),this.$box.on("mousedown.redactor.modal",this._close.bind(this)),this.$doc.on("keyup.redactor.modal",this._handleEscape.bind(this)),this.$win.on("resize.redactor.modal",this.resize.bind(this)),this.$modal.getBody().find("input[type=text],input[type=url],input[type=email]").on("keydown.redactor.modal",this._handleEnter.bind(this)),window.jQuery&&jQuery(document).off("focusin.modal"),this._broadcast("opened")},_close:function(t){if(this.$box&&this._isOpened()){if(t){if(!this._needToClose(t.target))return;t.stopPropagation(),t.preventDefault()}this.selectionMarkers?this.selection.restoreMarkers():this.selection.restore(),this.selectionMarkers=!1,this._broadcast("close"),this.animate.start(this.$box,"fadeOut",this._closed.bind(this)),this.animate.start(this.$overlay,"fadeOut")}},_closed:function(){this.$modal.removeClass("open"),this.$box.off(".redactor.modal"),this.$doc.off(".redactor.modal"),this.$win.off(".redactor.modal"),this._broadcast("closed")},_createModal:function(t){this.$modal=$R.create("modal.element",this.app,t)},_broadcast:function(t){this.app.broadcast("modal."+t,this.$modal,this.$modalForm),this.app.broadcast("modal."+this.p.name+"."+t,this.$modal,this.$modalForm)},_buildDefaults:function(t){this.p=$R.extend({},this.defaults,t)},_buildModalBox:function(){this.$box=$R.dom("<div>"),this.$box.attr("id","redactor-modal"),this.$box.addClass("redactor-animate-hide"),this.$box.html(""),this.$body.append(this.$box)},_buildOverlay:function(){this.$overlay=$R.dom("#redactor-overlay"),0===this.$overlay.length&&(this.$overlay=$R.dom("<div>"),this.$overlay.attr("id","redactor-overlay"),this.$overlay.addClass("redactor-animate-hide"),this.$body.prepend(this.$overlay))},_buildModal:function(){this.$box.append(this.$modal),this.$modal.setTitle(this.p.title),this.$modal.setHeight(this.p.height),this.$modal.setWidth(this.p.width)},_buildModalCommands:function(){if(this.p.commands){var t=this.p.commands,e=this.$modal.getFooter();for(var i in t){var s=$R.dom("<button>");s.html(t[i].title),s.attr("data-command",i),"cancel"===i&&(s.attr("data-action","close"),s.addClass("redactor-button-unstyled")),"undefined"!=typeof t[i].type&&"danger"===t[i].type&&s.addClass("redactor-button-danger"),s.on("click",this._handleCommand.bind(this)),e.append(s)}}},_buildModalTabs:function(){var t=this.$modal.getBody(),e=t.find(".redactor-modal-tab"),i=t.find(".redactor-modal-tabs");e.length>1&&(i=0===i.length?$R.dom("<div>"):i.html(""),i.addClass("redactor-modal-tabs"),e.each(function(t,e){var s=$R.dom(t),a=$R.dom("<a>");a.attr("href","#"),a.attr("rel",e),a.text(s.attr("data-title")),a.on("click",this._showTab.bind(this)),0===e&&a.addClass("active"),i.append(a)}.bind(this)),t.prepend(i))},_buildModalForm:function(){this.$modalForm=$R.create("modal.form",this.app,this.$modal.getForm())},_showTab:function(t){t.preventDefault();var e=$R.dom(t.target),i=e.attr("rel"),s=this.$modal.getBody(),a=s.find(".redactor-modal-tab");a.hide(),a.eq(i).show(),s.find(".redactor-modal-tabs a").removeClass("active"),e.addClass("active")},_needToClose:function(t){var e=$R.dom(t);return!("close"!==e.attr("data-action")&&!this.$modal.isCloseNode(t)&&0!==e.closest(".redactor-modal").length)},_handleCommand:function(t){var e=$R.dom(t.target).closest("button"),i=e.attr("data-command");"cancel"!==i&&t.preventDefault(),this._broadcast(i)},_handleEnter:function(t){13===t.which&&this.p.handle&&(t.preventDefault(),this._broadcast(this.p.handle))},_handleEscape:function(t){27===t.which&&this._close()}}),$R.add("class","modal.element",{mixins:["dom"],init:function(t,e){this.app=t,this.opts=t.opts,this.$win=t.$win,this._init(e)},getForm:function(){return this.find("form")},getHeader:function(){return this.$modalHeader},getBody:function(){return this.$modalBody},getFooter:function(){return this.$modalFooter},setTitle:function(t){t&&this.$modalHeader.html(t)},setWidth:function(t){t=_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_2___default()(t)>=this.$win.width()?"96%":t,this.css("max-width",t)},setHeight:function(t){!1!==t&&this.$modalBody.css("height",t)},updatePosition:function(){var t=this.width();this.css({left:"50%","margin-left":"-"+t/2+"px"});var e=this.$win.height(),i=this.height(),s=e/2-i/2;e>i&&0!==s&&this.css("margin-top",s+"px")},isCloseNode:function(t){return t===this.$modalClose.get()},_init:function(t){this._build(),this._buildClose(),this._buildHeader(),this._buildBody(),this._buildFooter(),this._buildTemplate(t)},_build:function(){this.parse("<div>"),this.addClass("redactor-modal"),this.attr("dir",this.opts.direction)},_buildClose:function(){this.$modalClose=$R.dom("<span>"),this.$modalClose.addClass("redactor-close"),this.append(this.$modalClose)},_buildHeader:function(){this.$modalHeader=$R.dom("<div>"),this.$modalHeader.addClass("redactor-modal-header"),this.append(this.$modalHeader)},_buildBody:function(){this.$modalBody=$R.dom("<div>"),this.$modalBody.addClass("redactor-modal-body"),this.append(this.$modalBody)},_buildFooter:function(){this.$modalFooter=$R.dom("<div>"),this.$modalFooter.addClass("redactor-modal-footer"),this.append(this.$modalFooter)},_buildTemplate:function(t){this.$modalBody.html(t)}}),$R.add("class","modal.form",{mixins:["dom"],init:function(t,e){this.app=t,this.build(e)},build:function(t){this.parse(t)},getData:function(){var t={};return this.find("[name]").each(function(e){var i=$R.dom(e);t[i.attr("name")]=i.val()}),t},setData:function(t){this.find("[name]").each(function(e){var i=$R.dom(e),s=i.attr("name");t.hasOwnProperty(s)&&(e.type&&"checkbox"===e.type?e.checked=t[s]:i.val(t[s]))})},getField:function(t){return this.find("[name="+t+"]")},setError:function(t){var e=this.getField(t);return e.addClass("error"),e.one(this._getFieldEventName(e.get()),this._clearError),!1},_clearError:function(){return $R.dom(this).removeClass("error")},_getFieldEventName:function(t){return"SELECT"===t.tagName||"checkbox"===t.type||"radio"===t.type?"change":"keyup"}}),$R.add("module","block",{init:function(t){this.app=t,this.block=t.block},format:function(t){var e=this.block.format(t);this.app.broadcast("format","block",e)},clearformat:function(){this.block.clearFormat()},clearstyle:function(){this.block.clearStyle()},clearclass:function(){this.block.clearClass()},clearattr:function(){this.block.clearAttr()},add:function(t,e){this.block.add(t,e)},toggle:function(t,e){this.block.toggle(t,e)},set:function(t,e){this.block.set(t,e)},remove:function(t,e){this.block.remove(t,e)}}),$R.add("module","inline",{init:function(t){this.app=t,this.inline=t.inline},format:function(t){var e=this.inline.format(t);this.app.broadcast("format","inline",e)},clearformat:function(){this.inline.clearFormat()},clearstyle:function(){this.inline.clearStyle()},clearclass:function(){this.inline.clearClass()},clearattr:function(){this.inline.clearAttr()},add:function(t,e){this.inline.add(t,e)},toggle:function(t,e){this.inline.toggle(t,e)},set:function(t,e){this.inline.set(t,e)},remove:function(t,e){this.inline.remove(t,e)}}),$R.add("module","autosave",{init:function(t){this.app=t,this.opts=t.opts,this.utils=t.utils,this.source=t.source},onsynced:function(){this.opts.autosave&&this._send()},_send:function(){var t=this.opts.autosaveName?this.opts.autosaveName:this.source.getName(),e={};e[t]=this.source.getCode(),e=this.utils.extendData(e,this.opts.autosaveData),$R.ajax.post({url:this.opts.autosave,data:e,success:function(i){this._complete(i,t,e)}.bind(this)})},_complete:function(t,e,i){var s=t&&t.error?"autosaveError":"autosave";this.app.broadcast(s,e,i,t)}}),$R.add("module","input",{init:function(t){this.app=t,this.opts=t.opts,this.utils=t.utils,this.editor=t.editor,this.keycodes=t.keycodes,this.element=t.element,this.selection=t.selection,this.insertion=t.insertion,this.inspector=t.inspector,this.autoparser=t.autoparser,this.lastShiftKey=!1},onpaste:function(t,e){return this.opts.input?$R.create("input.paste",this.app,t,e):void 0},onkeydown:function(t){if(this.opts.input){var e=t.which,i=$R.create("input.shortcut",this.app,t);if(!i.is()){if((t.ctrlKey||t.metaKey)&&!t.altKey&&65===e)return t.preventDefault(),this._selectAll();var s=[this.keycodes.ENTER,this.keycodes.SPACE,this.keycodes.BACKSPACE,this.keycodes.DELETE],a=[this.keycodes.UP,this.keycodes.DOWN,this.keycodes.LEFT,this.keycodes.RIGHT],n=-1!==s.indexOf(e),r=-1!==a.indexOf(e),o=(t.ctrlKey||t.metaKey)&&88===e,l=!t.ctrlKey&&!t.metaKey&&(e>=48&&57>=e||e>=65&&90>=e);if(this.selection.isAll()&&r&&(o||!t.ctrlKey&&!t.metaKey&&!t.altKey&&!t.shiftKey)){if(o)return this.editor.disableNonEditables(),void this.app.broadcast("empty");if(this._isArrowKey(e))return!0;if(n&&t.preventDefault(),this.element.isType("inline")){var c=this.editor.getElement();c.html(""),this.editor.startFocus()}else this.insertion.set(this.opts.emptyHtml);if(n)return;this.app.broadcast("empty")}return this.opts.autoparse&&this.autoparser.format(t,e),l&&this.selection.hasNonEditable()?void t.preventDefault():e===this.keycodes.ENTER?$R.create("input.enter",this.app,t,e):t.metaKey&&219===e?(t.preventDefault(),void this.app.api("module.list.outdent")):e===this.keycodes.TAB||t.metaKey&&221===e?$R.create("input.tab",this.app,t,e):e===this.keycodes.SPACE?$R.create("input.space",this.app,t,e,this.lastShiftKey):this._isDeleteKey(e)?$R.create("input.delete",this.app,t,e):this._isArrowKey(e)?$R.create("input.arrow",this.app,t,e):void 0}}},onkeyup:function(t){if(this.opts.input){var e=t.which;this.lastShiftKey=t.shiftKey,this.app.broadcast("contextbar.close");var i=$R.create("input.shortcode",this.app,t,e);if(!i.is()){if(e===this.keycodes.BACKSPACE){var s=this.editor.getElement(),a=this.utils.trimSpaces(s.html());if(a=a.replace(/<br\s?\/?>/g,""),a=a.replace(/<div><\/div>/,""),""===a)return t.preventDefault(),this.editor.setEmpty(),void this.editor.startFocus()}this.editor.isEmpty()&&this.app.broadcast("empty")}}},start:function(){this.opts.shortcutsAdd&&(this.opts.shortcuts=$R.extend({},!0,this.opts.shortcuts,this.opts.shortcutsAdd))},_selectAll:function(){var t,e=this.selection.getCurrent(),i=this.inspector.parse(e);return i.isComponentType("table")?(t=i.getTable(),void this.selection.setAll(t)):i.isComponentType("code")?(t=i.getComponentCodeElement(),void this.selection.setAll(t)):void this.selection.setAll()},_isArrowKey:function(t){return-1!==[this.keycodes.UP,this.keycodes.DOWN,this.keycodes.RIGHT,this.keycodes.LEFT].indexOf(t)},_isDeleteKey:function(t){return t===this.keycodes.BACKSPACE||t===this.keycodes.DELETE}}),$R.add("class","input.arrow",{init:function(t,e,i){this.app=t,this.opts=t.opts,this.utils=t.utils,this.caret=t.caret,this.offset=t.offset,this.marker=t.marker,this.editor=t.editor,this.keycodes=t.keycodes,this.component=t.component,this.inspector=t.inspector,this.selection=t.selection,this.key=i,this._init(e)},_init:function(t){if(!this._isRightLeftKey()||!this._isExitVariable(t)){if(this._isRightDownKey()){if(this._isExitOnDownRight(t))return;if(this._selectComponent(t,"End","next"))return}if(this._isLeftUpKey()){if(this._isExitOnUpLeft(t))return;if(this._selectComponent(t,"Start","prev"))return}this.key===this.keycodes.LEFT?this.utils.trimInvisibleChars("left"):this.key===this.keycodes.RIGHT&&this.utils.trimInvisibleChars("right")}},_isRightDownKey:function(){return-1!==[this.keycodes.DOWN,this.keycodes.RIGHT].indexOf(this.key)},_isLeftUpKey:function(){return-1!==[this.keycodes.UP,this.keycodes.LEFT].indexOf(this.key)},_isRightLeftKey:function(){return-1!==[this.keycodes.RIGHT,this.keycodes.LEFT].indexOf(this.key)},_isExitVariable:function(t){var e=this.selection.getCurrent(),i=this.inspector.parse(e),s=i.getComponent();if(i.isComponentType("variable")&&i.isComponentActive()){t.preventDefault();var a=this.key===this.keycodes.LEFT?"setBefore":"setAfter";this.caret[a](s)}else;},_isExitOnUpLeft:function(t){var e=this.selection.getCurrent(),i=this.selection.getBlock(e),s=this.inspector.parse(e),a=i.previousElementSibling,n=this.caret.isStart(i);if(n&&a&&"TABLE"===a.tagName)return t.preventDefault(),this.caret.setEnd(a),!0;if(s.isFigcaption()){i=s.getFigcaption(),n=this.caret.isStart(i);var r=$R.dom(i).closest(".redactor-component");if(n&&0!==r.length)return t.preventDefault(),this.caret.setEnd(r),!0}else{if(s.isTable()&&n)return t.preventDefault(),this.caret.setEnd(i.previousElementSibling),!0;if(!s.isComponentEditable()&&s.isComponent()&&!s.isComponentType("variable")){var o=s.getComponent();if(o.previousElementSibling)return t.preventDefault(),this.component.clearActive(),this.caret.setEnd(o.previousElementSibling),!0}}},_isExitOnDownRight:function(t){var e,i,s=this.editor.getElement(),a=this.selection.getCurrent(),n=this.inspector.parse(a),r=this.caret.isEnd();if(n.isTable()){if(i||r)return this._exitNextElement(t,n.getComponent())}else if(n.isFigcaption()){if(e=n.getFigcaption(),i=this.caret.isEnd(e),i||r)return this._exitNextElement(t,n.getComponent())}else if(n.isComponentType("code")){var o=n.getComponent(),l=$R.dom(n.getComponentCodeElement()).closest("pre");i=this.caret.isEnd(e);var c=l&&l.get().nextElementSibling;if(i&&!c)return this._exitNextElement(t,o)}else if(n.isPre()||n.isBlockquote()||n.isDl()){if(r){if(n.isPre())return this._exitNextElement(t,n.getPre());if(n.isBlockquote())return this._exitNextElement(t,n.getBlockquote());if(n.isDl())return this._exitNextElement(t,n.getDl())}}else if(n.isList()){var d=$R.dom(a).parents("ul, ol",s).last();if(i=this.caret.isEnd(d),i||r)return this._exitNextElement(t,d.get())}else if(n.isComponent()&&!n.isComponentType("variable")&&"span"!==n.getTag())return this.component.clearActive(),this._exitNextElement(t,n.getComponent())},_exitNextElement:function(t,e){return t.preventDefault(),e.nextElementSibling?this.caret.setStart(e.nextElementSibling):this.utils.createMarkup(e),!0},_selectComponent:function(t,e,i){var s=this.selection.getCurrent(),a=this.selection.getBlock(s),n=this.utils.findSiblings(s,i),r=this.utils.findSiblings(a,i);n&&this.caret["is"+e](s)?this._selectComponentItem(t,n,e):r&&this.caret["is"+e](a)&&this._selectComponentItem(t,r,e)},_selectComponentItem:function(t,e,i){return this.component.isNonEditable(e)?(t.preventDefault(),this.caret["set"+i](e),!0):void 0}}),$R.add("class","input.delete",{init:function(t,e,i){this.app=t,this.opts=t.opts,this.caret=t.caret,this.utils=t.utils,this.editor=t.editor,this.marker=t.marker,this.keycodes=t.keycodes,this.component=t.component,this.inspector=t.inspector,this.selection=t.selection,this.key=i,this._init(e)},_init:function(t){if(!this._removeActiveComponent(t)&&!this._removeAllSelectedTable(t)){if(this.key===this.keycodes.BACKSPACE){var e=this.editor.getElement(),i=this.utils.trimSpaces(e.html());if(i===this.opts.emptyHtml)return void t.preventDefault()}if(this._detectVariableOrNonEditable()||this.selection.hasNonEditable())return void t.preventDefault();this.selection.isCollapsed()&&(this.key===this.keycodes.BACKSPACE?this._traverseBackspace(t):this.key===this.keycodes.DELETE&&this._traverseDelete(t)),this.key===this.keycodes.BACKSPACE&&this.utils.trimInvisibleChars("left"),this._removeUnwantedStyles(),this._removeEmptySpans(),this._removeSpanTagsInHeadings(),this._removeInlineTagsInPre()}},_detectVariableOrNonEditable:function(){var t,e=this.selection.getBlock(),i=this.caret.isStart(e),s=this.caret.isEnd(e);if(this.key===this.keycodes.BACKSPACE&&i){if(t=e.previousSibling,this._isNonEditable(t))return!0}else if(this.key===this.keycodes.DELETE&&s&&(t=e.nextSibling,this._isNonEditable(t)))return!0;var a=this.selection.getCurrent(),n=this.caret.isStart(a),r=this.caret.isEnd(a),o=""===this.selection.getTextBeforeCaret().trim(),l=""===this.selection.getTextAfterCaret().trim();if(this.key===this.keycodes.BACKSPACE&&n&&!o){if(t=a.previousSibling,this._isVariable(t))return this.caret.setEnd(t),!0;if(this._isNonEditable(t))return!0}else if(this.key===this.keycodes.DELETE&&r&&!l){if(t=a.nextSibling,this._isVariable(t))return this.caret.setStart(t),!0;if(this._isNonEditable(t))return!0}},_isVariable:function(t){return 0!==$R.dom(t).closest('[data-redactor-type="variable"]').length},_isNonEditable:function(t){return 0!==$R.dom(t).closest(".non-editable").length},_getBlock:function(){var t=this.editor.getElement(),e=this.selection.getBlock(),i=this.inspector.parse(e);return e=i.isList()?$R.dom(e).parents("ul, ol",t).last().get():e,e=i.isDl()?i.getDl():e,i.isTable()?i.getTable():e},_traverseDelete:function(t){var e,i,s,a=this.selection.getCurrent(),n=this.inspector.parse(a);if(n.isFigcaption()){if(e=n.getFigcaption(),i=this.caret.isEnd(e))return void t.preventDefault()}else if(n.isComponentType("code")&&(e=n.getComponent(),i=this.caret.isEnd(e)))return void t.preventDefault();e=this._getBlock();var r=this.utils.findSiblings(e,"next");if(r){i=this.caret.isEnd(e);var o=this.inspector.parse(r),l="P"===r.tagName||"DIV"===r.tagName;if(i&&o.isComponentEditable())return t.preventDefault(),void this.component.remove(r,!1);if(i&&o.isComponent())return t.preventDefault(),this.caret.setStart(r),void(this.utils.isEmptyHtml(e.innerHTML)&&$R.dom(e).remove());if(i&&o.isList()){var c=$R.dom(e);if(s=$R.dom(r),n.isList())return t.preventDefault(),c.append(s),void s.unwrap();var d=s.children("li").first(),u=d.find("ul, ol");if(0!==u.length)return t.preventDefault(),s.prepend(u),u.unwrap(),c.append(d),void d.unwrap()}else if(i&&!n.isList()&&!n.isTable()&&l&&!this.utils.isEmptyHtml(e.innerHTML)){t.preventDefault();var h=$R.dom(e);return s=$R.dom(r),h.append(s),void s.unwrap()}}},_traverseBackspace:function(t){var e,i,s,a,n=this.selection.getCurrent(),r=this.inspector.parse(n);if(r.isFigcaption()){if(e=r.getFigcaption(),i=this.caret.isStart(e))return void t.preventDefault()}else if(r.isComponentType("code")&&(e=r.getComponent(),i=this.caret.isStart(e),i&&e.previousElementSibling))return t.preventDefault(),this.caret.setEnd(e.previousElementSibling),!0;e=this._getBlock();var o=this.utils.findSiblings(e,"prev");if(o){i=this.caret.isStart(e);var l=this.inspector.parse(o),c="P"===o.tagName||"DIV"===o.tagName;if(i&&l.isComponentEditable())return t.preventDefault(),void this.component.remove(o,!1);if(i&&l.isComponent())return t.preventDefault(),this.caret.setStart(o),void(this.utils.isEmptyHtml(e.innerHTML)&&$R.dom(e).remove());if(i&&r.isList())if(t.preventDefault(),a=$R.dom(e),s=$R.dom(o),l.isList())a.children("li").first().prepend(this.marker.build("start")),s.append(a),a.unwrap(),this.selection.restoreMarkers();else{var d=a.children("li").first(),u=d.get(),h=d.find("ul, ol"),m=this.utils.replaceToTag(u,this.opts.markup);this.opts.breakline&&m.attr("data-redactor-tag","br"),a.before(m),this.caret.setStart(m),0!==h.length&&(a.prepend(h),h.unwrap())}else if(i&&c){t.preventDefault();var p=this.utils.createInvisibleChar(),f=$R.dom(e);return s=$R.dom(o),this.caret.setEnd(s),f.prepend(p),s.append(f.contents()),void f.remove()}}else setTimeout(this._replaceBlock.bind(this),1)},_replaceBlock:function(){var t=this.selection.getBlock(),e=$R.dom(t);if("p"===this.opts.markup&&t&&this._isNeedToReplaceBlock(t)){var i=document.createElement(this.opts.markup);e.replaceWith(i),this.caret.setStart(i)}this.opts.breakline&&t&&"DIV"===t.tagName&&e.attr("data-redactor-tag","br")},_isNeedToReplaceBlock:function(t){return"DIV"===t.tagName&&this.utils.isEmptyHtml(t.innerHTML)},_removeActiveComponent:function(t){var e=this.selection.getCurrent(),i=this.inspector.parse(e),s=i.getComponent();return i.isComponent()&&this.component.isActive(s)?(t.preventDefault(),this.component.remove(s),!0):void 0},_removeAllSelectedTable:function(t){var e=this.selection.getCurrent(),i=this.inspector.parse(e),s=i.getTable();return s&&this.selection.isAll(s)?(t.preventDefault(),this.component.remove(s),!0):void 0},_removeUnwantedStyles:function(){var t=this.editor.getElement();setTimeout(function(){var e=t.find("*[style]");e.not("img, figure, iframe, [data-redactor-style-cache], [data-redactor-span]").removeAttr("style")},0)},_removeEmptySpans:function(){var t=this.editor.getElement();setTimeout(function(){t.find("span").each(function(t){0===t.attributes.length&&$R.dom(t).replaceWith(t.childNodes)})},0)},_removeSpanTagsInHeadings:function(){var t=this.editor.getElement();setTimeout(function(){t.find("h1, h2, h3, h4, h5, h6").each(function(t){var e=$R.dom(t);0===e.closest("figure").length&&e.find("span").not(".redactor-component, .non-editable, .redactor-selection-marker, [data-redactor-style-cache], [data-redactor-span]").unwrap()})},1)},_removeInlineTagsInPre:function(){var t=this.editor.getElement(),e=this.opts.inlineTags;setTimeout(function(){t.find("pre").each(function(t){var i=$R.dom(t);0===i.closest("figure").length&&i.find(e.join(",")).not("code, .redactor-selection-marker").unwrap()})},1)}}),$R.add("class","input.enter",{init:function(t,e){this.app=t,this.opts=t.opts,this.utils=t.utils,this.caret=t.caret,this.editor=t.editor,this.insertion=t.insertion,this.selection=t.selection,this.inspector=t.inspector,this._init(e)},_init:function(t){if(!this.opts.enterKey)return this._disable(t);var e=this.app.broadcast("enter",t);return!1===e?t.preventDefault():this.selection.hasNonEditable()?void t.preventDefault():t.ctrlKey||t.shiftKey?this._insertBreak(t):void(this._isExit(t)||this._traverse(t))},_disable:function(t){t.preventDefault();var e=this.selection.getRange();e&&!e.collapsed&&e.deleteContents()},_insertBreak:function(t){t.preventDefault();var e=this.selection.getCurrent(),i=this.inspector.parse(e);i.isComponent()&&!i.isComponentEditable()||i.isCode()||(i.isPre()?this.insertion.insertNewline():this.insertion.insertBreakLine())},_isExit:function(t){var e=this.editor.getElement(),i=this.selection.getBlock(),s=this.inspector.parse(i),a=this.caret.isEnd(i),n=this.selection.getCurrent(),r=n.previousSibling;if(s.isBlockquote()){var o=a&&this._isExitableBlock(i,"P"),l=a&&this._isExitableDblBreak(r);if(o||l)return this._exitFromElement(t,l?r:i,s.getBlockquote())}else if(!s.isComponentType("code")&&s.isPre()){if(a){var c=i.innerHTML;if(c=this.utils.removeInvisibleChars(c),null!==c.match(/(\n\n\n)$/))return $R.dom(r.previousSibling.previousSibling).remove(),this._exitFromElement(t,r,i)}}else if(s.isDl()){if(a&&this._isExitableBlock(i,"DT"))return this._exitFromElement(t,i,s.getDl())}else if(s.isList()){var d=$R.dom(n).parents("ul, ol",e).last();if(a=this.caret.isEnd(d),a&&this._isExitableBlock(i,"LI"))return this._exitFromElement(t,i,d)}else if(s.isComponent()&&s.isComponentActive()&&!s.isFigcaption()&&!s.isComponentEditable())return this._exitFromElement(t,!1,s.getComponent())},_isExitableDblBreak:function(t){var e=!!t&&t.nextSibling;if(e){var i=this.utils.removeInvisibleChars(e.textContent);return 3===e.nodeType&&""===i.trim()}},_isExitableBlock:function(t,e){return t&&t.tagName===e&&this.utils.isEmptyHtml(t.innerHTML)},_exitFromElement:function(t,e,i){return t.preventDefault(),e&&$R.dom(e).remove(),this.utils.createMarkup(i),!0},_exitNextElement:function(t,e){return t.preventDefault(),e.nextSibling?this.caret.setStart(e.nextSibling):this.utils.createMarkup(e),!0},_traverse:function(t){var e=this.selection.getCurrent(),i=this.selection.isText(),s=this.selection.getBlock(),a=this.inspector.parse(e),n=!!s&&s.tagName.toLowerCase();if(a.isPre())return t.preventDefault(),this.insertion.insertNewline();if(!a.isBlockquote()){if(a.isFigcaption()){s=a.getFigcaption();var r=this.caret.isEnd(s),o=this.caret.isEnd();return r||o?this._exitNextElement(t,a.getComponent()):void t.preventDefault()}return a.isDl()?(t.preventDefault(),this._traverseDl(e)):i||this.opts.breakline&&"div"===n?(t.preventDefault(),this.insertion.insertBreakLine()):void setTimeout(this._replaceBlock.bind(this),1)}return s=this.selection.getBlock(e),s&&"BLOCKQUOTE"===s.tagName?(t.preventDefault(),this.insertion.insertBreakLine()):void 0},_traverseDl:function(t){var e=this.selection.getBlock(t),i=this.inspector.parse(e),s=i.getTag(),a=$R.dom(e),n=a.get().nextSibling||!1,r=$R.dom(n),o=n&&r.is("dd"),l=n&&r.is("dt"),c=this.caret.isEnd(e);if("dt"===s&&!o&&c){var d=document.createElement("dd");return a.after(d),void this.caret.setStart(d)}if("dd"===s&&!l&&c){var u=document.createElement("dt");return a.after(u),void this.caret.setStart(u)}return this.insertion.insertBreakLine()},_replaceBlock:function(){var t=this.selection.getBlock(),e=$R.dom(t);if("p"===this.opts.markup&&t&&this._isNeedToReplaceBlock(t)){var i=document.createElement(this.opts.markup);e.replaceWith(i),this.caret.setStart(i)}else if(t)if(this.utils.isEmptyHtml(t.innerHTML))this._clearBlock(e,t);else{var s=this.utils.getFirstNode(t);s&&"BR"===s.tagName&&($R.dom(s).remove(),this.caret.setStart(t))}t&&this._isNeedToCleanBlockStyle(t)&&this.opts.cleanOnEnter&&e.removeAttr("class style"),this.opts.breakline&&t&&"DIV"===t.tagName&&e.attr("data-redactor-tag","br")},_clearBlock:function(t,e){(this.opts.cleanInlineOnEnter||"<br>"===e.innerHTML)&&t.html(""),this.caret.setStart(e)},_isNeedToReplaceBlock:function(t){return"DIV"===t.tagName&&this.utils.isEmptyHtml(t.innerHTML)},_isNeedToCleanBlockStyle:function(t){return"P"===t.tagName&&this.utils.isEmptyHtml(t.innerHTML)}}),$R.add("class","input.paste",{init:function(t,e,i,s,a){this.app=t,this.opts=t.opts,this.editor=t.editor,this.cleaner=t.cleaner,this.container=t.container,this.inspector=t.inspector,this.insertion=t.insertion,this.selection=t.selection,this.autoparser=t.autoparser,this.pasteHtml=s,this.pointInserted=a,this.dataTransfer=i,this._init(e)},_init:function(t){var e,i=this.dataTransfer||t.clipboardData,s=this.selection.getCurrent(),a=this.inspector.parse(s);if(this.dropPasted=this.dataTransfer,this.isRawCode=a.isPre()||a.isCode(),this.editor.enablePasting(),this.editor.saveScroll(),this.dropPasted||this.selection.saveMarkers(),this.isRawCode||!i)return e=this.isRawCode||i||!window.clipboardData?i.getData("text/plain"):window.clipboardData.getData("text"),t.preventDefault(),void this._insert(t,e);if(this.pasteHtml)t.preventDefault(),this._insert(t,this.pasteHtml);else{var n=i.getData("URL"),r=this._isPlainText(i)?i.getData("text/plain"):i.getData("text/html");if(r=n&&""!==n?n:r,null!==i.files&&i.files.length>0&&""===r){for(var o=[],l=0;l<i.files.length;l++){var c=i.files[l]||i.items[l].getAsFile();c&&o.push(c)}if(o.length>0)return t.preventDefault(),void this._insertFiles(t,o)}t.preventDefault(),this._insert(t,r)}},_isPlainText:function(t){var e=t.getData("text/plain"),i=t.getData("text/html");if(!e||!i)return null!==e;var s=document.createElement("div");return s.innerHTML=i,s.textContent===e?!s.querySelector(":not(meta)"):void 0},_restoreSelection:function(){this.editor.restoreScroll(),this.editor.disablePasting(),this.dropPasted||this.selection.restoreMarkers()},_insert:function(t,e){var i=this.app.broadcast("pasteBefore",e);if(e=void 0===i?e:i,e=this.isRawCode?e:this.cleaner.paste(e),e=this.isRawCode?this.cleaner.encodePhpCode(e):e,i=this.app.broadcast("pasting",e),e=void 0===i?e:i,this._restoreSelection(),this.opts.input){this.opts.autoparse&&this.opts.autoparsePaste&&(e=this.autoparser.parse(e));var s=this.dropPasted?this.insertion.insertToPoint(t,e,this.pointInserted):this.insertion.insertHtml(e);this.app.broadcast("pasted",s),this.app.broadcast("autoparseobserve")}},_insertFiles:function(t,e){this._restoreSelection();var i=-1!==this.opts.imageTypes.indexOf(e[0].type),s="undefined"==typeof this.dropPasted;i?this.app.broadcast("dropimage",t,e,s):this.app.broadcast("dropfile",t,e,s)}}),$R.add("class","input.shortcode",{init:function(t,e,i){this.app=t,this.opts=t.opts,this.utils=t.utils,this.marker=t.marker,this.keycodes=t.keycodes,this.selection=t.selection,this.worked=!1,i===this.keycodes.SPACE&&this._init()},is:function(){return this.worked},_init:function(){var t=this.selection.getCurrent();if(t&&3===t.nodeType){var e=this.utils.removeInvisibleChars(t.textContent),i=this.opts.shortcodes;for(var s in i){var a=new RegExp("^"+this.utils.escapeRegExp(s)),n=e.match(a);if(null!==n&&"undefined"!=typeof i[s].format)return this._format(i[s].format,t,a)}}},_format:function(t,e,i){var s=this.marker.insert("start");e=s.previousSibling;var a=e.textContent;a=this.utils.trimSpaces(a),a=a.replace(i,""),e.textContent=a;var n="ul"===t||"ol"===t?"module.list.toggle":"module.block.format";this.app.api(n,t),this.selection.restoreMarkers(),this.worked=!0}}),$R.add("class","input.shortcut",{init:function(t,e){this.app=t,this.opts=t.opts,this.worked=!1,this.hotkeys={8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},this.hotkeysShiftNums={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"},this._init(e)},is:function(){return this.worked},_init:function(t){if(!1!==this.opts.shortcuts)for(var e in this.opts.shortcuts)this._build(t,e,this.opts.shortcuts[e]);else!t.ctrlKey&&!t.metaKey||66!==t.which&&73!==t.which||t.preventDefault()},_build:function(t,e,i){for(var s=e.split(","),a=s.length,n=0;a>n;n++)"string"==typeof s[n]&&this._handler(t,s[n].trim(),i)},_handler:function(t,e,i){e=e.toLowerCase().split(" ");for(var s=this.hotkeys[t.keyCode],a=String.fromCharCode(t.which).toLowerCase(),n="",r={},o=["meta","ctrl","alt","shift"],l=0;l<o.length;l++){var c=o[l];t[c+"Key"]&&s!==c&&(n+=c+"+")}s&&(r[n+s]=!0),a&&(r[n+a]=!0,r[n+this.hotkeysShiftNums[a]]=!0,"shift+"===n&&(r[this.hotkeysShiftNums[a]]=!0));var d=e.length;for(l=0;d>l;l++)if(r[e[l]])return t.preventDefault(),this.worked=!0,void(i.message?(this.app.broadcast(i.message,i.args),this.app.broadcast("buffer.trigger")):i.api&&(this.app.api(i.api,i.args),this.app.broadcast("buffer.trigger")))}}),$R.add("class","input.space",{init:function(t,e,i,s){this.app=t,this.keycodes=t.keycodes,this.insertion=t.insertion,this.selection=t.selection,this.key=i,this.lastShiftKey=s,this._init(e)},_init:function(t){return this.selection.hasNonEditable()?void t.preventDefault():this.lastShiftKey||this.key!==this.keycodes.SPACE||!t.ctrlKey&&!t.shiftKey||t.metaKey?void 0:(t.preventDefault(),void this.insertion.insertChar("&nbsp;"))}}),$R.add("class","input.tab",{init:function(t,e){this.app=t,this.opts=t.opts,this.inspector=t.inspector,this.insertion=t.insertion,this.selection=t.selection,this._init(e)},_init:function(t){if(this.opts.tabKey){var e=this.app.broadcast("tab",t);return!1===e?t.preventDefault():void this._traverse(t)}},_traverse:function(t){var e=this.selection.getCurrent(),i=this.inspector.parse(e);return!i.isComponent()&&t.shiftKey?this._insertHardTab(t,4):i.isList()?(t.preventDefault(),this.app.api("module.list.indent")):i.isPre()||i.isComponentType("code")&&!i.isFigcaption()?this._tabCode(t):!1!==this.opts.tabAsSpaces?this._insertHardTab(t,this.opts.tabAsSpaces):void 0},_insertHardTab:function(t,e){t.preventDefault();var i=document.createTextNode(Array(e+1).join(" "));return this.insertion.insertNode(i,"end")},_tabCode:function(t){t.preventDefault();var e=this.opts.preSpaces?document.createTextNode(Array(this.opts.preSpaces+1).join(" ")):document.createTextNode("\t");return this.insertion.insertNode(e,"end")}}),$R.add("module","upload",{init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.utils=t.utils,this.editor=t.editor,this.progress=t.progress,this.defaults={event:!1,element:!1,name:!1,files:!1,url:!1,data:!1,paramName:!1}},build:function(t){this.p=$R.extend(this.defaults,t),this.$el=$R.dom(this.p.element),"INPUT"===this.$el.get().tagName?this._buildInput():this._buildBox()},send:function(t){this.p=$R.extend(this.defaults,t),this.$uploadbox=this.editor.getElement(),this._send(this.p.event,this.p.files)},complete:function(t,e){this._complete(t,e)},_buildInput:function(){this.box=!1,this.prefix="",this.$uploadbox=$R.dom('<div class="upload-redactor-box" />'),this.$el.hide(),this.$el.after(this.$uploadbox),this.opts.multipleUpload?this.$el.attr("multiple","multiple"):this.$el.removeAttr("multiple"),this._buildPlaceholder(),this._buildEvents()},_buildBox:function(){this.box=!0,this.prefix="box-",this.$uploadbox=this.$el,this.$uploadbox.attr("ondragstart","return false;"),this.$uploadbox.on("drop.redactor.upload",this._onDropBox.bind(this)),this.$uploadbox.on("dragover.redactor.upload",this._onDragOver.bind(this)),this.$uploadbox.on("dragleave.redactor.upload",this._onDragLeave.bind(this))},_buildPlaceholder:function(){this.$placeholder=$R.dom('<div class="upload-redactor-placeholder" />'),this.$placeholder.html(this.lang.get("upload-label")),this.$uploadbox.append(this.$placeholder)},_buildEvents:function(){this.$el.on("change.redactor.upload",this._onChange.bind(this)),this.$uploadbox.on("click.redactor.upload",this._onClick.bind(this)),this.$uploadbox.on("drop.redactor.upload",this._onDrop.bind(this)),this.$uploadbox.on("dragover.redactor.upload",this._onDragOver.bind(this)),this.$uploadbox.on("dragleave.redactor.upload",this._onDragLeave.bind(this))},_onClick:function(t){t.preventDefault(),this.$el.click()},_onChange:function(t){this._send(t,this.$el.get().files)},_onDrop:function(t){t.preventDefault(),this._clear(),this._setStatusDrop(),this._send(t)},_onDragOver:function(t){return t.preventDefault(),this._setStatusHover(),!1},_onDragLeave:function(t){return t.preventDefault(),this._removeStatusHover(),!1},_onDropBox:function(t){t.preventDefault(),this._clear(),this._setStatusDrop(),this._send(t)},_removeStatusHover:function(){this.$uploadbox.removeClass("upload-redactor-"+this.prefix+"hover")},_setStatusDrop:function(){this.$uploadbox.addClass("upload-redactor-"+this.prefix+"drop")},_setStatusHover:function(){this.$uploadbox.addClass("upload-redactor-"+this.prefix+"hover")},_setStatusError:function(){this.$uploadbox.addClass("upload-redactor-"+this.prefix+"error")},_setStatusSuccess:function(){this.$uploadbox.addClass("upload-redactor-"+this.prefix+"success")},_clear:function(){for(var t=["drop","hover","error","success"],e=0;e<t.length;e++)this.$uploadbox.removeClass("upload-redactor-"+this.prefix+t[e]);this.$uploadbox.removeAttr("ondragstart")},_send:function(t,e){t=t.originalEvent||t,e=e||t.dataTransfer.files;var i=new FormData,s=this._getUploadParam();i=this._buildData(s,e,i),i=this.utils.extendData(i,this.p.data);var a=this.app.broadcast("upload.start",t,i,e);!1!==a&&this._sendData(i,e,t)},_sendData:function(t,e,i){if(this.progress.show(),"function"==typeof this.p.url){var s=this.p.url(t,e,i,this);s instanceof _Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_promise__WEBPACK_IMPORTED_MODULE_1___default.a||this._complete(s,i)}else $R.ajax.post({url:this.p.url,data:t,before:function(t){return this.app.broadcast("upload.beforeSend",t)}.bind(this),success:function(t){this._complete(t,i)}.bind(this)})},_getUploadParam:function(){return this.p.paramName?this.p.paramName:"file"},_buildData:function(t,e,i){if(1===e.length)i.append(t+"[]",e[0]);else if(e.length>1&&!1!==this.opts.multipleUpload)for(var s=0;s<e.length;s++)i.append(t+"[]",e[s]);return i},_complete:function(t,e){this._clear(),this.progress.hide(),t&&t.error?(this._setStatusError(),this.app.broadcast("upload."+this.p.name+".error",t,e),this.app.broadcast("upload.error",t)):(this._setStatusSuccess(),this.app.broadcast("upload."+this.p.name+".complete",t,e),this.app.broadcast("upload.complete",t),setTimeout(this._clear.bind(this),500))}}),$R.add("class","code.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,e&&void 0!==e.cmnt?e:this._init(e)},_init:function(t){var e;if("undefined"!=typeof t){var i=$R.dom(t),s=i.closest("figure");0!==s.length?this.parse(s):(this.parse("<figure>"),this.append(t)),e=this.find("pre code, pre").last()}else e=$R.dom("<pre>"),this.parse("<figure>"),this.append(e);this._initElement(e),this._initWrapper()},_initElement:function(t){t.attr({tabindex:"-1",contenteditable:!0})},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"code",tabindex:"-1",contenteditable:!1})}}),$R.add("module","form",{init:function(t){this.app=t,this.lang=t.lang,this.component=t.component,this.inspector=t.inspector},onform:{remove:function(t){this._remove(t)}},oncontextbar:function(t,e){var i=this.inspector.parse(t.target);if(i.isComponentType("form")){var s=i.getComponent(),a={remove:{title:this.lang.get("delete"),api:"module.form.remove",args:s}};e.set(t,s,a,"top")}},_remove:function(t){this.component.remove(t)}}),$R.add("class","form.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,this.utils=t.utils,e&&void 0!==e.cmnt?e:this._init(e)},_init:function(t){if("undefined"!=typeof t){var e=$R.dom(t),i=e.closest("form");if(0!==i.length){var s=this.utils.replaceToTag(t,"figure");this.parse(s)}else this.parse("<figure>"),this.append(t)}else this.parse("<figure>");this._initWrapper()},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"form",tabindex:"-1",contenteditable:!1})}}),$R.add("module","image",{modals:{image:'<div class="redactor-modal-tab" data-title="## upload ##"><form action="">                 <input type="file" name="file">             </form></div>',imageedit:'<div class="redactor-modal-group">                 <div id="redactor-modal-image-preview" class="redactor-modal-side"></div>                 <form action="" class="redactor-modal-area">                     <div class="form-item">                         <label for="modal-image-title"> ## title ##</label>                         <input type="text" id="modal-image-title" name="title" />                     </div>                     <div class="form-item form-item-caption">                         <label for="modal-image-caption">## caption ##</label>                         <input type="text" id="modal-image-caption" name="caption" aria-label="## caption ##" />                     </div>                     <div class="form-item form-item-align">                         <label>## image-position ##</label>                         <select name="align" aria-label="## image-position ##">                             <option value="none">## none ##</option>                             <option value="left">## left ##</option>                             <option value="center">## center ##</option>                             <option value="right">## right ##</option>                         </select>                     </div>                     <div class="form-item form-item-link">                         <label for="modal-image-url">## link ##</label>                         <input type="text" id="modal-image-url" name="url" aria-label="## link ##" />                     </div>                     <div class="form-item form-item-link">                         <label class="checkbox"><input type="checkbox" name="target" aria-label="## link-in-new-tab ##"> ## link-in-new-tab ##</label>                     </div>                 </form>             </div>'},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.caret=t.caret,this.utils=t.utils,this.editor=t.editor,this.storage=t.storage,this.component=t.component,this.inspector=t.inspector,this.insertion=t.insertion,this.selection=t.selection,this.justResized=!1},oninsert:function(){this._observeImages()},onstarted:function(){this.storage.observeImages(),this.opts.imageResizable&&(this.resizer=$R.create("image.resize",this.app)),this._observeImages()},ondropimage:function(t,e,i){if(this.opts.imageUpload){var s={url:this.opts.imageUpload,event:!i&&t,files:e,name:"imagedrop",data:this.opts.imageData,paramName:this.opts.imageUploadParam};this.app.api("module.upload.send",s)}},onstop:function(){this.resizer&&this.resizer.stop()},onbottomclick:function(){this.insertion.insertToEnd(this.editor.getLastNode(),"image")},onimageresizer:{stop:function(){this.resizer&&this.resizer.hide()}},onsource:{open:function(){this.resizer&&this.resizer.hide()},closed:function(){this._observeImages(),this.resizer&&this.resizer.rebuild()}},onupload:{complete:function(){this._observeImages()},image:{complete:function(t){this._insert(t)},error:function(t){this._uploadError(t)}},imageedit:{complete:function(t){this._change(t)},error:function(t){this._uploadError(t)}},imagedrop:{complete:function(t,e){this._insert(t,e)},error:function(t){this._uploadError(t)}},imagereplace:{complete:function(t){this._change(t,!1)},error:function(t){this._uploadError(t)}}},onmodal:{image:{open:function(t,e){this._setUpload(e)}},imageedit:{open:function(t,e){this._setFormData(t,e)},opened:function(t,e){this._setFormFocus(e)},remove:function(){this._remove(this.$image)},save:function(t,e){this._save(t,e)}}},onimage:{observe:function(){this._observeImages()},resized:function(){this.justResized=!0}},oncontextbar:function(t,e){if(this.justResized)this.justResized=!1;else{var i=this.selection.getCurrent(),s=this.inspector.parse(i);if(!s.isFigcaption()&&s.isComponentType("image")){var a=s.getComponent(),n={edit:{title:this.lang.get("edit"),api:"module.image.open"},remove:{title:this.lang.get("delete"),api:"module.image.remove",args:a}};e.set(t,a,n)}}},open:function(){this.$image=this._getCurrent(),this.app.api("module.modal.build",this._getModalData())},insert:function(t){this._insert(t)},remove:function(t){this._remove(t)},_getModalData:function(){return this._isImage()&&this.opts.imageEditable?{name:"imageedit",width:"800px",title:this.lang.get("edit"),handle:"save",commands:{save:{title:this.lang.get("save")},remove:{title:this.lang.get("delete"),type:"danger"},cancel:{title:this.lang.get("cancel")}}}:{name:"image",title:this.lang.get("image")}},_isImage:function(){return this.$image},_getCurrent:function(){var t=this.selection.getCurrent(),e=this.inspector.parse(t);return!(!e.isComponentType("image")||!e.isComponentActive())&&this.component.create("image",e.getComponent())},_insert:function(t,e){if(this.app.api("module.modal.close"),_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_array_is_array__WEBPACK_IMPORTED_MODULE_6___default()(t)){for(var i={},s=0;s<t.length;s++)i=$R.extend(i,t[s]);t=i}else"string"==typeof t&&(t={file:{url:t}});if("object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(t)){var a=0;for(var n in t)"object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(t[n])&&a++;a>1?this._insertMultiple(t,e):this._insertSingle(t,e)}},_insertSingle:function(t,e){for(var i in t)if("object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(t[i])){var s=this._createImageAndStore(t[i]),a=e?this.insertion.insertToPoint(e,s):this.insertion.insertHtml(s);this._removeSpaceBeforeFigure(a[0]),this.component.setActive(a[0]),this.app.broadcast("image.uploaded",a[0],t)}},_insertMultiple:function(t,e){var i,s=0,a=[];for(var n in t)if("object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(t[n])){s++;var r=this._createImageAndStore(t[n]);if(1===s)a=e?this.insertion.insertToPoint(e,r):this.insertion.insertHtml(r);else{var o=$R.dom(a[0]);o.after(r),a=[r.get()],this.app.broadcast("image.inserted",r)}i=a[0],this._removeSpaceBeforeFigure(a[0]),this.app.broadcast("image.uploaded",a[0],t)}this.component.setActive(i)},_createImageAndStore:function(t){var e=this.component.create("image");return e.addClass("redactor-uploaded-figure"),e.setData({src:t.url,id:t.id?t.id:this.utils.getRandomId()}),this.storage.add("image",e.getElement()),e},_removeSpaceBeforeFigure:function(t){if(t){var e=t.previousSibling;e&&(this._removeInvisibleSpace(e),this._removeInvisibleSpace(e.previousSibling))}},_removeInvisibleSpace:function(t){t&&3===t.nodeType&&-1!==this.utils.searchInvisibleChars(t.textContent)&&t.parentNode.removeChild(t)},_save:function(t,e){var i=e.getData(),s={title:i.title};this.opts.imageLink&&(s.link={url:i.url,target:i.target}),this.opts.imageCaption&&(s.caption=i.caption),this.opts.imagePosition&&(s.align=i.align),this.$image.setData(s),this.resizer&&this.resizer.rebuild(),this.app.broadcast("image.changed",this.$image),this.app.api("module.modal.close")},_change:function(t,e){if("string"==typeof t&&(t={file:{url:t}}),"object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(t)){var i;for(var s in t)if("object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(t[s])){i=$R.dom("<img>"),i.attr("src",t[s].url),this.$image.changeImage(t[s]),this.app.broadcast("image.changed",this.$image,t),this.app.broadcast("image.uploaded",this.$image,t),this.app.broadcast("hardsync");break}!1!==e&&i.on("load",function(){this.$previewBox.html(i)}.bind(this))}},_uploadError:function(t){this.app.broadcast("image.uploadError",t)},_remove:function(t){this.app.api("module.modal.close"),this.component.remove(t)},_observeImages:function(){var t=this.editor.getElement(),e=this;t.find("img").each(function(t){var i=$R.dom(t);i.off(".drop-to-replace"),i.on("dragover.drop-to-replace dragenter.drop-to-replace",function(t){t.preventDefault()}),i.on("drop.drop-to-replace",function(t){return e.app.isDragComponentInside()?void 0:e._setReplaceUpload(t,i)})})},_setFormData:function(t,e){this._buildPreview(),this._buildPreviewUpload();var i=this.$image.getData(),s={title:i.title};this.opts.imageCaption?s.caption=i.caption:t.find(".form-item-caption").hide(),this.opts.imagePosition?s.align=i.align:t.find(".form-item-align").hide(),this.opts.imageLink?i.link&&(s.url=i.link.url,i.link.target&&(s.target=!0)):t.find(".form-item-link").hide(),e.setData(s)},_setFormFocus:function(t){t.getField("title").focus()},_setReplaceUpload:function(t,e){if(t=t.originalEvent||t,t.stopPropagation(),t.preventDefault(),this.opts.imageUpload){this.$image=this.component.create("image",e);var i={url:this.opts.imageUpload,files:t.dataTransfer.files,name:"imagereplace",data:this.opts.imageData,paramName:this.opts.imageUploadParam};this.app.api("module.upload.send",i)}},_setUpload:function(t){var e={url:this.opts.imageUpload,element:t.getField("file"),name:"image",data:this.opts.imageData,paramName:this.opts.imageUploadParam};this.app.api("module.upload.build",e)},_buildPreview:function(){this.$preview=$R.dom("#redactor-modal-image-preview");var t=this.$image.getData(),e=$R.dom("<img>");e.attr("src",t.src),this.$previewBox=$R.dom("<div>"),this.$previewBox.append(e),this.$preview.html(""),this.$preview.append(this.$previewBox)},_buildPreviewUpload:function(){if(this.opts.imageUpload){var t=$R.dom('<div class="desc">');t.html(this.lang.get("upload-change-label")),this.$preview.append(t);var e={url:this.opts.imageUpload,element:this.$previewBox,name:"imageedit",paramName:this.opts.imageUploadParam};this.app.api("module.upload.build",e)}}}),$R.add("class","image.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,this.opts=t.opts,this.selection=t.selection,e&&void 0!==e.cmnt?e:this._init(e)},setData:function(t){for(var e in t)this._set(e,t[e])},getData:function(){for(var t=["src","title","caption","align","link","id"],e={},i=0;i<t.length;i++)e[t[i]]=this._get(t[i]);return e},getElement:function(){return this.$element},changeImage:function(t){this.$element.attr("src",t.url)},_init:function(t){var e=$R.dom(t),i=e.closest("figure");void 0===t?(this.$element=$R.dom("<img>"),this.parse("<figure>"),this.append(this.$element)):0===i.length?(this.parse("<figure>"),this.$element=e,this.$element.wrap(this)):(this.parse(i),this.$element=this.find("img")),this._initWrapper()},_set:function(t,e){this["_set_"+t](e)},_get:function(t){return this["_get_"+t]()},_set_src:function(t){this.$element.attr("src",t)},_set_id:function(t){this.$element.attr("data-image",t)},_set_title:function(t){t=t.trim().replace(/(<([^>]+)>)/gi,""),""===t?(this.$element.removeAttr("alt"),this.$element.removeAttr("title")):(this.$element.attr("alt",t),this.$element.attr("title",t))},_set_caption:function(t){var e=this.find("figcaption");return 0===e.length&&(e=$R.dom("<figcaption>"),e.attr("contenteditable","true"),this.append(e)),""===t?e.remove():e.html(t),e},_set_align:function(t){var e="",i="",s="",a=this;if("object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(this.opts.imagePosition)){var n=this.opts.imagePosition;for(var r in n)a.removeClass(n[r]);var o="undefined"!=typeof n[t]&&n[t];o&&a.addClass(o)}else{switch(t){case"left":e="left",i="0 "+this.opts.imageFloatMargin+" "+this.opts.imageFloatMargin+" 0";break;case"right":e="right",i="0 0 "+this.opts.imageFloatMargin+" "+this.opts.imageFloatMargin;break;case"center":s="center"}a.css({float:e,margin:i,"text-align":s}),a.attr("rel",a.attr("style"))}},_set_link:function(t){var e=this._findLink();return""===t.url?void(e&&e.unwrap()):(e||(e=$R.dom("<a>"),this.$element.wrap(e)),e.attr("href",t.url),t.target?e.attr("target",!0===t.target?"_blank":t.target):e.removeAttr("target"),e)},_get_src:function(){return this.$element.attr("src")},_get_id:function(){return this.$element.attr("data-image")},_get_title:function(){var t=this.$element.attr("alt"),e=this.$element.attr("title");return t||(e||"")},_get_caption:function(){var t=this.find("figcaption");return 0===t.length?"":t.html()},_get_align:function(){var t="";if("object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(this.opts.imagePosition)){t="none";var e=this.opts.imagePosition;for(var i in e)if(this.hasClass(e[i])){t=i;break}}else t="center"===this.css("text-align")?"center":this.css("float");return t},_get_link:function(){var t=this._findLink();if(t){var e=!!t.attr("target");return{url:t.attr("href"),target:e}}},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"image",tabindex:"-1",contenteditable:!1})},_findLink:function(){var t=this.find("a").filter(function(t){return 0===$R.dom(t).closest("figcaption").length});return 0!==t.length&&t}}),$R.add("class","image.resize",{init:function(t){this.app=t,this.$doc=t.$doc,this.$win=t.$win,this.$body=t.$body,this.editor=t.editor,this.toolbar=t.toolbar,this.inspector=t.inspector,this.$target=this.toolbar.isTarget()?this.toolbar.getTargetElement():this.$body,this._init()},rebuild:function(){this._setResizerPosition()},hide:function(){this.$target.find("#redactor-image-resizer").remove()},stop:function(){var t=this.editor.getElement();t.off(".redactor.image-resize"),this.$doc.off(".redactor.image-resize"),this.$win.off("resize.redactor.image-resize"),this.hide()},_init:function(){var t=this.editor.getElement();t.on("click.redactor.image-resize",this._build.bind(this)),this.$win.on("resize.redactor.image-resize",this._setResizerPosition.bind(this))},_build:function(t){this.$target.find("#redactor-image-resizer").remove();var e=this.inspector.parse(t.target),i=this.editor.getElement();e.isComponentType("image")&&(this.$resizableBox=i,this.$resizableImage=$R.dom(e.getImageElement()),this.$resizer=$R.dom("<span>"),this.$resizer.attr("id","redactor-image-resizer"),this.$target.append(this.$resizer),this._setResizerPosition(),this.$resizer.on("mousedown touchstart",this._set.bind(this)))},_setResizerPosition:function(){if(this.$resizer){var t=this.toolbar.isTarget(),e=this.$target.offset(),i=7,s=t?i-e.top+this.$target.scrollTop():i,a=t?i-e.left:i,n=this.$resizableImage.offset(),r=this.$resizableImage.width(),o=this.$resizableImage.height(),l=this.$resizer.width(),c=this.$resizer.height();this.$resizer.css({top:n.top+o-c+s+"px",left:n.left+r-l+a+"px"})}},_set:function(t){t.preventDefault(),this.resizeHandle={x:t.pageX,y:t.pageY,el:this.$resizableImage,ratio:this.$resizableImage.width()/this.$resizableImage.height(),h:this.$resizableImage.height()},t=t.originalEvent||t,t.targetTouches&&(this.resizeHandle.x=t.targetTouches[0].pageX,this.resizeHandle.y=t.targetTouches[0].pageY),this.app.broadcast("contextbar.close"),this.app.broadcast("image.resize",this.$resizableImage),this._start()},_start:function(){this.$doc.on("mousemove.redactor.image-resize touchmove.redactor.image-resize",this._move.bind(this)),this.$doc.on("mouseup.redactor.image-resize touchend.redactor.image-resize",this._stop.bind(this))},_stop:function(){this.$doc.off(".redactor.image-resize"),this.app.broadcast("image.resized",this.$resizableImage)},_move:function(t){t.preventDefault(),t=t.originalEvent||t;var e=this.resizeHandle.h;e+=t.targetTouches?t.targetTouches[0].pageY-this.resizeHandle.y:t.pageY-this.resizeHandle.y;var i=e*this.resizeHandle.ratio;20>e||100>i||this._getResizableBoxWidth()<=i||(this.resizeHandle.el.attr({width:i,height:e}),this.resizeHandle.el.width(i),this.resizeHandle.el.height(e),this._setResizerPosition())},_getResizableBoxWidth:function(){var t=this.$resizableBox.width();return t-_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_2___default()(this.$resizableBox.css("padding-left"))-_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_2___default()(this.$resizableBox.css("padding-right"))}}),$R.add("module","file",{modals:{file:'<div class="redactor-modal-tab" data-title="## upload ##"><form action="">                 <div class="form-item form-item-title">                     <label for="modal-file-title"> ## filename ## <span class="desc">(## optional ##)</span></label>                     <input type="text" id="modal-file-title" name="title" />                 </div>                 <input type="file" name="file">             </form></div>'},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.caret=t.caret,this.utils=t.utils,this.storage=t.storage,this.component=t.component,this.inspector=t.inspector,this.insertion=t.insertion,this.selection=t.selection},onstarted:function(){this.storage.observeFiles()},ondropfile:function(t,e,i){if(this.opts.fileUpload){var s={url:this.opts.fileUpload,event:!i&&t,files:e,name:"filedrop",data:this.opts.fileData};this.app.api("module.upload.send",s)}},onmodal:{file:{open:function(t,e){this._setFormData(t,e),this._setUpload(e)},opened:function(t,e){this._setFormFocus(e),this.$form=e}}},onupload:{file:{complete:function(t){this._insert(t)},error:function(t){this._uploadError(t)}},filedrop:{complete:function(t,e){this._insert(t,e)},error:function(t){this._uploadError(t)}}},oncontextbar:function(t,e){var i=this.selection.getCurrent(),s=this.inspector.parse(i);if(s.isFile()){var a=s.getFile(),n={remove:{title:this.lang.get("delete"),api:"module.file.remove",args:a}};e.set(t,a,n,"bottom")}},open:function(){this._open()},insert:function(t){this._insert(t)},remove:function(t){this._remove(t)},_open:function(){this.app.api("module.modal.build",this._getModalData())},_getModalData:function(){var t={name:"file",title:this.lang.get("file")};return t},_insert:function(t,e){if(this.app.api("module.modal.close"),"object"==Object(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_17__["a"])(t)){if(_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_array_is_array__WEBPACK_IMPORTED_MODULE_6___default()(t)){for(var i={},s=0;s<t.length;s++)i=$R.extend(i,t[s]);t=i}var a=_Applications_files_insites_modular_insites_core_vue_node_modules_babel_runtime_corejs2_core_js_object_keys__WEBPACK_IMPORTED_MODULE_16___default()(t).length>1;a?this._insertMultiple(t,e):this._insertSingle(t,e),this.$form=!1}},_insertSingle:function(t,e){var i=[];for(var s in t){var a=this._createFileAndStore(t[s]);i=this.opts.fileAttachment?this._insertAsAttachment(a):e?this.insertion.insertToPoint(e,a):this.insertion.insertRaw(a),this.app.broadcast("file.uploaded",i[0],t)}},_insertMultiple:function(t,e){var i,s=0,a=[];for(var n in t){s++;var r=this._createFileAndStore(t[n]);if(this.opts.fileAttachment)a=this._insertAsAttachment(r,t);else if(1===s)a=e?this.insertion.insertToPoint(e,r):this.insertion.insertRaw(r);else{var o=$R.dom(a[0]);o.after(r).after(" "),a=[r.get()],this.app.broadcast("file.inserted",r)}i=r,this.app.broadcast("file.uploaded",a[0],t)}this.opts.fileAttachment||this.caret.setAfter(i)},_insertAsAttachment:function(t,e){var i=$R.dom(this.opts.fileAttachment),s=t.wrapAttachment();i.append(s);var a=[s.get()];return this.app.broadcast("file.appended",a[0],e),a},_createFileAndStore:function(t){var e=!!this.$form&&this.$form.getData(),i=t.name?t.name:t.url,s=!this.opts.fileAttachment&&e&&""!==e.title?e.title:this._truncateUrl(i),a=this.component.create("file");return a.attr("href",t.url),a.attr("data-file",t.id?t.id:this.utils.getRandomId()),a.attr("data-name",t.name),a.html(s),this.storage.add("file",a),a},_remove:function(t){this.selection.save();var e=this.component.create("file",t),i=this.app.broadcast("file.delete",e);!1!==i?(e.unwrap(),this.selection.restore(),this.app.broadcast("file.deleted",e)):this.selection.restore()},_truncateUrl:function(t){return-1!==t.search(/^http/)&&t.length>20?t.substring(0,20)+"...":t},_setUpload:function(t){var e={url:this.opts.fileUpload,element:t.getField("file"),name:"file",data:this.opts.fileData,paramName:this.opts.fileUploadParam};this.app.api("module.upload.build",e)},_setFormData:function(t,e){this.opts.fileAttachment?t.find(".form-item-title").hide():e.setData({title:this.selection.getText()})},_setFormFocus:function(t){t.getField("title").focus()},_uploadError:function(t){this.app.broadcast("file.uploadError",t)}}),$R.add("class","file.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,this.opts=t.opts,e&&void 0!==e.cmnt?e:this._init(e)},wrapAttachment:function(){return this.$wrapper=$R.dom('<span class="redactor-file-item">'),this.$remover=$R.dom('<span class="redactor-file-remover">'),this.$remover.html("&times;"),this.$remover.on("click",this.removeAttachment.bind(this)),this.$wrapper.append(this),this.$wrapper.append(this.$remover),this.$wrapper},removeAttachment:function(t){t.preventDefault();var e=this.app.broadcast("file.delete",this,this.$wrapper);!1!==e&&(this.$wrapper.remove(),this.app.broadcast("file.deleted",this),this.app.broadcast("file.removeAttachment",this))},_init:function(t){if(void 0===t)this.parse("<a>");else{var e=$R.dom(t).closest("a");this.parse(e)}}}),$R.add("module","buffer",{init:function(t){this.app=t,this.opts=t.opts,this.editor=t.editor,this.offset=t.offset,this.keycodes=t.keycodes,this.selection=t.selection,this.state=!1,this.passed=!1,this.keyPressed=!1,this.savedHtml=!1,this.savedOffset=!1,this.undoStorage=[],this.redoStorage=[]},onkeydown:function(t){this._listen(t)},onsyncing:function(){this.keyPressed||this.trigger(),this.keyPressed=!1},onbuffer:{trigger:function(){this.trigger()}},onstate:function(t,e,i){t&&(t.ctrlKey||t.metaKey)||t&&(this._isUndo(t)||this._isRedo(t))||(this.passed=!1,this._saveState(e,i))},onenable:function(){this.clear()},clear:function(){this.state=!1,this.undoStorage=[],this.redoStorage=[]},undo:function(){this._getUndo()},redo:function(){this._getRedo()},trigger:function(){this.state&&!1===this.passed&&this._setUndo()},_saveState:function(t,e){var i=this.editor.getElement();this.state={html:t||i.html(),offset:e||this.offset.get()}},_listen:function(t){var e=t.which,i=t.ctrlKey||t.metaKey,s=i||t.shiftKey||t.altKey,a=[this.keycodes.SPACE,this.keycodes.ENTER,this.keycodes.BACKSPACE,this.keycodes.DELETE,this.keycodes.TAB,this.keycodes.LEFT,this.keycodes.RIGHT,this.keycodes.UP,this.keycodes.DOWN];return this._isUndo(t)?(t.preventDefault(),void this.undo()):this._isRedo(t)?(t.preventDefault(),void this.redo()):((i||-1===a.indexOf(e))&&(!i||88!==e&&67!==e)||(s=!0,this.trigger()),s||this._hasUndo()||this.trigger(),void(this.keyPressed=!0))},_isUndo:function(t){var e=t.which,i=t.ctrlKey||t.metaKey;return i&&90===e&&!t.shiftKey&&!t.altKey},_isRedo:function(t){var e=t.which,i=t.ctrlKey||t.metaKey;return i&&(90===e&&t.shiftKey||89===e&&!t.shiftKey)&&!t.altKey},_setUndo:function(){var t=this.undoStorage[this.undoStorage.length-1];"undefined"!=typeof t&&t[0]===this.state.html||(this.undoStorage.push([this.state.html,this.state.offset]),this._removeOverStorage())},_setRedo:function(){var t=this.editor.getElement(),e=this.offset.get(),i=t.html();this.redoStorage.push([i,e]),this.redoStorage=this.redoStorage.slice(0,this.opts.bufferLimit)},_getUndo:function(){if(this._hasUndo()){this.passed=!0;var t=this.editor.getElement(),e=this.undoStorage.pop();this._setRedo(),t.html(e[0]),this.offset.set(e[1]),this.selection.restore(),this.app.broadcast("undo",e[0],e[1])}},_getRedo:function(){if(this._hasRedo()){this.passed=!0;var t=this.editor.getElement(),e=this.redoStorage.pop();this._setUndo(),t.html(e[0]),this.offset.set(e[1]),this.app.broadcast("redo",e[0],e[1])}},_removeOverStorage:function(){this.undoStorage.length>this.opts.bufferLimit&&(this.undoStorage=this.undoStorage.slice(0,this.undoStorage.length-this.opts.bufferLimit))},_hasUndo:function(){return 0!==this.undoStorage.length},_hasRedo:function(){return 0!==this.redoStorage.length}}),$R.add("module","list",{init:function(t){this.app=t,this.opts=t.opts,this.utils=t.utils,this.block=t.block,this.toolbar=t.toolbar,this.inspector=t.inspector,this.selection=t.selection},onbutton:{list:{observe:function(t){this._observeButton(t)}}},ondropdown:{list:{observe:function(t){this._observeDropdown(t)}}},toggle:function(t){var e=this._getBlocks(),i=this.selection.getBlock(),s=$R.dom(i).parents("ul, ol",".redactor-in").last();return 0===e.length&&0!==s.length&&(e=[s.get()]),!i||"TD"!==i.tagName&&"TH"!==i.tagName||(e=this.block.format("div")),this.selection.saveMarkers(),e=0!==e.length&&this._isUnformat(t,e)?this._unformat(t,e):this._format(t,e),this.selection.restoreMarkers(),e},indent:function(){var t=this.selection.isCollapsed(),e=this.selection.getCurrent(),i=this.inspector.parse(e),s=!!i.isList()&&i.getListItem(),a=$R.dom(s),n=a.prevElement(),r=n.get(),o=t&&s&&r&&"LI"===r.tagName;if(o){this.selection.saveMarkers(),n=$R.dom(r);var l=n.children("ul, ol"),c=a.closest("ul, ol");if(0!==l.length)l.append(a);else{var d=c.get().tagName.toLowerCase(),u=$R.dom("<"+d+">");u.append(a),n.append(u)}this.selection.restoreMarkers()}},outdent:function(){var t=this.selection.isCollapsed(),e=this.selection.getCurrent(),i=this.inspector.parse(e),s=!!i.isList()&&i.getListItem(),a=$R.dom(s);if(t&&s){var n,r,o,l,c=a.parent(),d=c.closest("li",".redactor-in"),u=a.prevElement(),h=a.nextElement(),m=u.get(),p=h.get(),f=!1===m,_=!1!==m&&!1!==p,g=!f&&!1===p;if(this.selection.saveMarkers(),0!==d.length)if(_){n=this._getAllNext(a.get()),o=$R.dom("<"+c.get().tagName.toLowerCase()+">");for(var b=0;b<n.length;b++)o.append(n[b]);d.after(a),a.append(o)}else d.after(a),0===c.children().length?c.remove():f&&a.append(c);else{var v=this._createUnformatContainer(a),y=v.find("ul, ol").first();if(f)c.before(v);else if(g)c.after(v);else if(_){o=$R.dom("<"+c.get().tagName.toLowerCase()+">"),n=this._getAllNext(a.get());for(b=0;b<n.length;b++)o.append(n[b]);c.after(v),v.after(o)}0!==y.length&&(l=v.nextElement(),r=l.get(),r&&r.tagName===c.get().tagName?($R.dom(r).prepend(y),y.unwrap()):v.after(y)),a.remove()}this.selection.restoreMarkers()}},_getAllNext:function(t){for(var e=[];t;){var i=$R.dom(t).nextElement();if(t=i.get(),!t)return e;e.push(t)}return e},_isUnformat:function(t,e){for(var i=0,s=0;s<e.length;s++)if(3!==e[s].nodeType){var a=e[s].tagName.toLowerCase();a!==t&&"figure"!==a||i++}return i===e.length},_format:function(t,e){var i=["p","div","blockquote","pre","h1","h2","h3","h4","h5","h6","ul","ol"],s=this._uniteBlocks(e,i),a=[];for(var n in s){for(var r=s[n],o=this._createList(t,s[n]),l=0;l<r.length;l++){var c;if(3===r[l].nodeType||"UL"!==r[l].tagName&&"OL"!==r[l].tagName)c=this._createListItem(r[l]),this.utils.normalizeTextNodes(c),o.append(c);else{var d=$R.dom(r[l]);c=d.contents(),o.append(c),this.utils.isEmpty(d)&&d.remove()}}a.push(o.get())}return a},_uniteBlocks:function(t,e){for(var i=0,s={0:[]},a=!1,n=0;n<t.length;n++){var r=$R.dom(t[n]),o=r.closest("th, td");0!==o.length?(o.get()!==a&&(i++,s[i]=[]),this._isUniteBlock(t[n],e)&&s[i].push(t[n])):this._isUniteBlock(t[n],e)?s[i].push(t[n]):(i++,s[i]=[]),a=o.get()}return s},_isUniteBlock:function(t,e){return 3===t.nodeType||-1!==e.indexOf(t.tagName.toLowerCase())},_createList:function(t,e){var i=e[e.length-1],s=$R.dom(i),a=$R.dom("<"+t+">");return s.after(a),a},_createListItem:function(t){var e=$R.dom("<li>");if(3===t.nodeType)e.append(t);else{var i=$R.dom(t);e.append(i.contents()),i.remove()}return e},_unformat:function(t,e){if(1===e.length){var i=$R.dom(e[0]),s=i.find("li"),a=this.selection.getNodes({tags:["li"]}),n=this.selection.getBlock(),r=$R.dom(n).closest("li");if(0===a.length&&0!==r.length&&(a=[r.get()]),a.length===s.length)return this._unformatEntire(e[0]);var o=this._getItemsPosition(s,a);if("Top"===o)return this._unformatAtSide("before",a,i);if("Bottom"===o)return a.reverse(),this._unformatAtSide("after",a,i);if("Middle"===o){var l=$R.dom(a[a.length-1]),c=!1,d=!1,u=$R.dom("<"+i.get().tagName.toLowerCase()+">");s.each(function(t){if(c){var e=$R.dom(t);0!==e.closest(".redactor-split-item").length||!1!==d&&0!==e.closest(d).length||e.addClass("redactor-split-item"),d=e}t===l.get()&&(c=!0)}),s.filter(".redactor-split-item").each(function(t){var e=$R.dom(t);e.removeClass("redactor-split-item"),u.append(t)}),i.after(u),a.reverse();for(var h=0;h<a.length;h++){var m=$R.dom(a[h]),p=this._createUnformatContainer(m);i.after(p),p.find("ul, ol").remove(),m.remove()}return}}else for(h=0;h<e.length;h++)3!==e[h].nodeType&&e[h].tagName.toLowerCase()===t&&this._unformatEntire(e[h])},_unformatEntire:function(t){var e=$R.dom(t),i=e.find("li");i.each(function(t){var i=$R.dom(t),s=this._createUnformatContainer(i);i.remove(),e.before(s)}.bind(this)),e.remove()},_unformatAtSide:function(t,e,i){for(var s=0;s<e.length;s++){var a=$R.dom(e[s]),n=this._createUnformatContainer(a);i[t](n);var r=n.find("ul, ol").first();a.append(r),r.each(function(t){var i=$R.dom(t),a=i.closest("li");a.get()===e[s]&&(i.unwrap(),a.addClass("r-unwrapped"))}),this.utils.isEmptyHtml(a.html())&&a.remove()}i.find(".r-unwrapped").each(function(t){var e=$R.dom(t);""===e.html().trim()?e.remove():e.removeClass("r-unwrapped")})},_getItemsPosition:function(t,e){var i="Middle",s=e[0],a=e[e.length-1],n=t.first().get(),r=t.last().get();return n===s&&r!==a?i="Top":n!==s&&r===a&&(i="Bottom"),i},_createUnformatContainer:function(t){var e=$R.dom("<"+this.opts.markup+">");return this.opts.breakline&&e.attr("data-redactor-tag","br"),e.append(t.contents()),e},_getBlocks:function(){return this.selection.getBlocks({first:!0})},_observeButton:function(){var t=this.selection.getCurrent(),e=this.inspector.parse(t),i=e.isPre()||e.isCode()||e.isFigcaption();this._observeButtonsList(i,["lists","ul","ol","outdent","indent"]);var s=this.toolbar.getButton("outdent"),a=this.toolbar.getButton("indent");this._observeIndent(a,s)},_observeDropdown:function(t){var e=t.getItem("outdent"),i=t.getItem("indent");this._observeIndent(i,e)},_observeIndent:function(t,e){var i=this.selection.isCollapsed(),s=this.selection.getCurrent(),a=this.inspector.parse(s),n=!!a.isList()&&a.getListItem(),r=$R.dom(n),o=r.prevElement(),l=o.get(),c=i&&n&&l&&"LI"===l.tagName;e&&(n&&i?e.enable():e.disable()),t&&(n&&c?t.enable():t.disable())},_observeButtonsList:function(t,e){for(var i=0;i<e.length;i++){var s=this.toolbar.getButton(e[i]);s&&(t?s.disable():s.enable())}}}),$R.add("class","video.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,e&&void 0!==e.cmnt?e:this._init(e)},_init:function(t){if("undefined"!=typeof t){var e=$R.dom(t),i=e.closest("figure");0!==i.length?this.parse(i):(this.parse("<figure>"),this.append(t))}else this.parse("<figure>");this._initWrapper()},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"video",tabindex:"-1",contenteditable:!1})}}),window.Redactor=window.$R=$R,window.addEventListener("load",function(){$R("[data-redactor]")})}()},"9f94":function(t,e,i){"use strict";i.r(e);i("7514");!function(t){t.add("plugin","table",{translations:{en:{table:"Table","insert-table":"Insert table","insert-row-above":"Insert row above","insert-row-below":"Insert row below","insert-column-left":"Insert column left","insert-column-right":"Insert column right","add-head":"Add head","delete-head":"Delete head","delete-column":"Delete column","delete-row":"Delete row","delete-table":"Delete table"}},init:function(t){this.app=t,this.lang=t.lang,this.opts=t.opts,this.caret=t.caret,this.editor=t.editor,this.toolbar=t.toolbar,this.component=t.component,this.inspector=t.inspector,this.insertion=t.insertion,this.selection=t.selection},ondropdown:{table:{observe:function(t){this._observeDropdown(t)}}},onbottomclick:function(){this.insertion.insertToEnd(this.editor.getLastNode(),"table")},start:function(){var t={observe:"table","insert-table":{title:this.lang.get("insert-table"),api:"plugin.table.insert"},"insert-row-above":{title:this.lang.get("insert-row-above"),classname:"redactor-table-item-observable",api:"plugin.table.addRowAbove"},"insert-row-below":{title:this.lang.get("insert-row-below"),classname:"redactor-table-item-observable",api:"plugin.table.addRowBelow"},"insert-column-left":{title:this.lang.get("insert-column-left"),classname:"redactor-table-item-observable",api:"plugin.table.addColumnLeft"},"insert-column-right":{title:this.lang.get("insert-column-right"),classname:"redactor-table-item-observable",api:"plugin.table.addColumnRight"},"add-head":{title:this.lang.get("add-head"),classname:"redactor-table-item-observable",api:"plugin.table.addHead"},"delete-head":{title:this.lang.get("delete-head"),classname:"redactor-table-item-observable",api:"plugin.table.deleteHead"},"delete-column":{title:this.lang.get("delete-column"),classname:"redactor-table-item-observable",api:"plugin.table.deleteColumn"},"delete-row":{title:this.lang.get("delete-row"),classname:"redactor-table-item-observable",api:"plugin.table.deleteRow"},"delete-table":{title:this.lang.get("delete-table"),classname:"redactor-table-item-observable",api:"plugin.table.deleteTable"}},e={title:this.lang.get("table")},i=this.toolbar.addButtonBefore("link","table",e);i.setIcon('<i class="re-icon-table"></i>'),i.setDropdown(t)},insert:function(){for(var t=this.component.create("table"),e=0;e<2;e++)t.addRow(3);t=this.insertion.insertHtml(t),this.caret.setStart(t)},addRowAbove:function(){var t=this._getComponent();if(t){var e=this.selection.getCurrent(),i=t.addRowTo(e,"before");this.caret.setStart(i)}},addRowBelow:function(){var t=this._getComponent();if(t){var e=this.selection.getCurrent(),i=t.addRowTo(e,"after");this.caret.setStart(i)}},addColumnLeft:function(){var t=this._getComponent();if(t){var e=this.selection.getCurrent();this.selection.save(),t.addColumnTo(e,"left"),this.selection.restore()}},addColumnRight:function(){var t=this._getComponent();if(t){var e=this.selection.getCurrent();this.selection.save(),t.addColumnTo(e,"right"),this.selection.restore()}},addHead:function(){var t=this._getComponent();t&&(this.selection.save(),t.addHead(),this.selection.restore())},deleteHead:function(){var e=this._getComponent();if(e){var i=this.selection.getCurrent();0!==t.dom(i).closest("thead").length?(e.removeHead(),this.caret.setStart(e)):(this.selection.save(),e.removeHead(),this.selection.restore())}},deleteColumn:function(){var e=this._getComponent();if(e){var i=this.selection.getCurrent(),s=t.dom(i).closest("td, th"),a=s.nextElement().get(),n=s.prevElement().get();e.removeColumn(i),a?this.caret.setStart(a):n?this.caret.setEnd(n):this.deleteTable()}},deleteRow:function(){var e=this._getComponent();if(e){var i=this.selection.getCurrent(),s=t.dom(i).closest("tr"),a=s.nextElement().get(),n=s.prevElement().get();e.removeRow(i),a?this.caret.setStart(a):n?this.caret.setEnd(n):this.deleteTable()}},deleteTable:function(){var t=this._getTable();t&&this.component.remove(t)},_getTable:function(){var t=this.selection.getCurrent(),e=this.inspector.parse(t);if(e.isTable())return e.getTable()},_getComponent:function(){var t=this.selection.getCurrent(),e=this.inspector.parse(t);if(e.isTable()){var i=e.getTable();return this.component.create("table",i)}},_observeDropdown:function(t){var e=this._getTable(),i=t.getItemsByClass("redactor-table-item-observable"),s=t.getItem("insert-table");e?(this._observeItems(i,"enable"),s.disable()):(this._observeItems(i,"disable"),s.enable())},_observeItems:function(t,e){for(var i=0;i<t.length;i++)t[i][e]()}})}(Redactor),function(t){t.add("class","table.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,e&&void 0!==e.cmnt?e:this._init(e)},addHead:function(){this.removeHead();var e=this.$element.find("tr").first().children("td, th").length,i=t.dom("<thead>"),s=this._buildRow(e,"<th>");i.append(s),this.$element.prepend(i)},addRow:function(t){var e=this._buildRow(t);return this.$element.append(e),e},addRowTo:function(t,e){return this._addRowTo(t,e)},addColumnTo:function(e,i){var s=t.dom(e),a=s.closest("tr"),n=s.closest("td, th"),r=0;a.find("td, th").each(function(t,e){t===n.get()&&(r=e)}),this.$element.find("tr").each(function(e){var s=t.dom(e).find("td, th").get(r),a=t.dom(s),n=a.clone();n.html(""),"right"===i?a.after(n):a.before(n)})},removeHead:function(){var t=this.$element.find("thead");0!==t.length&&t.remove()},removeRow:function(e){t.dom(e).closest("tr").remove()},removeColumn:function(e){var i=t.dom(e),s=i.closest("tr"),a=i.closest("td, th"),n=0;s.find("td, th").each(function(t,e){t===a.get()&&(n=e)}),this.$element.find("tr").each(function(e){var i=t.dom(e).find("td, th").get(n);t.dom(i).remove()})},_init:function(e){var i,s;if(void 0!==e){var a=t.dom(e),n=a.get(),r=a.closest("figure");0!==r.length?(i=r,s=r.find("table").get()):"TABLE"===n.tagName&&(s=n)}this._buildWrapper(i),this._buildElement(s),this._initWrapper()},_addRowTo:function(e,i){var s=t.dom(e).closest("tr");if(0!==s.length){var a=s.children("td, th").length,n=this._buildRow(a);return s[i](n),n}},_buildRow:function(e,i){i=i||"<td>";for(var s=t.dom("<tr>"),a=0;a<e;a++){var n=t.dom(i);n.attr("contenteditable",!0),s.append(n)}return s},_buildElement:function(e){e?this.$element=t.dom(e):(this.$element=t.dom("<table>"),this.append(this.$element))},_buildWrapper:function(t){t=t||"<figure>",this.parse(t)},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"table",tabindex:"-1",contenteditable:!1})}})}(Redactor)},a2bf:function(t,e,i){},b6c2:function(t,e,i){"use strict";var s=i("5019"),a=i.n(s);a.a},bb4e:function(t,e,i){},ce8e:function(t,e,i){"use strict";var s=i("3a4e"),a=i.n(s);a.a},d650:function(t,e){Redactor.add("plugin","alignment",{translations:{en:{align:"Align","align-left":"Align Left","align-center":"Align Center","align-right":"Align Right","align-justify":"Align Justify"}},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.block=t.block,this.toolbar=t.toolbar},start:function(){var t={};t.left={title:this.lang.get("align-left"),api:"plugin.alignment.set",args:"left"},t.center={title:this.lang.get("align-center"),api:"plugin.alignment.set",args:"center"},t.right={title:this.lang.get("align-right"),api:"plugin.alignment.set",args:"right"},t.justify={title:this.lang.get("align-justify"),api:"plugin.alignment.set",args:"justify"};var e=this.toolbar.addButton("alignment",{title:this.lang.get("align")});e.setIcon('<i class="re-icon-alignment"></i>'),e.setDropdown(t)},set:function(t){if("left"===t&&"ltr"===this.opts.direction)return this._remove();var e={style:{"text-align":t}};this.block.toggle(e)},_remove:function(){this.block.remove({style:"text-align"})}})},dd4b:function(t,e,i){"use strict";var s=i("1d7a"),a=i.n(s);a.a},dea6:function(t,e,i){"use strict";var s=i("7767"),a=i.n(s);a.a},e14f:function(t,e,i){"use strict";i.r(e);var s=i("f499"),a=i.n(s),n=i("7618");!function(t){t.add("plugin","imagemanager",{translations:{en:{choose:"Choose"}},init:function(t){this.app=t,this.lang=t.lang,this.opts=t.opts},onmodal:{image:{open:function(t,e){this.opts.imageManagerJson&&this._load(t)}}},_load:function(e){var i=e.getBody();this.$box=t.dom("<div>"),this.$box.attr("data-title",this.lang.get("choose")),this.$box.addClass("redactor-modal-tab"),this.$box.hide(),this.$box.css({overflow:"auto",height:"300px","line-height":1}),i.append(this.$box),t.ajax.get({url:this.opts.imageManagerJson,success:this._parse.bind(this)})},_parse:function(e){for(var i in e){var s=e[i];if("object"==Object(n["a"])(s)){var r=t.dom("<img>"),o=s.thumb?s.thumb:s.url;r.attr("src",o),r.attr("data-params",encodeURI(a()(s))),r.css({width:"96px",height:"72px",margin:"0 4px 2px 0",cursor:"pointer"}),r.on("click",this._insert.bind(this)),this.$box.append(r)}}},_insert:function(e){e.preventDefault();var i=t.dom(e.target),s=JSON.parse(decodeURI(i.attr("data-params")));this.app.api("module.image.insert",{image:s})}})}(Redactor)},f4b2:function(t,e,i){"use strict";var s=i("2dc1"),a=i.n(s);a.a}});